(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{52837:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return t(87736)}])},87736:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Ae}});var s=t(47568),a=t(26042),i=t(34051),o=t.n(i),r=t(85893),c=t(44431),l=t.n(c),d=t(214),u=t.n(d),h=t(44423),f=t(11163),m=[{id:"index",title:"Home",link:"index"},{id:"settings",title:"Settings",link:"settings",adminOnly:!0}],x=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,f.useRouter)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("nav",{className:"".concat(u().mainNav," headerNavMenu"),children:m.map((function(t){return t.adminOnly&&!n?null:(0,r.jsx)("a",{className:e===t.id?"".concat(u().active," headerNavActive"):"",href:(0,h.R)(t.link),children:t.title},t.id)}))}),(0,r.jsx)("div",{className:u().mainNavSeperator})]})},v=t(14924),b=t(69396),j=t(67294),g=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.notEmpty,s=!1;t&&""===e&&(s=!0);var a=(0,j.useState)(e),i=a[0],o=a[1],r=(0,j.useState)(s),c=r[0],l=r[1],d=function(e){var n=e;(null===e||void 0===e?void 0:e.target)&&(n=e.target.value),l(!(!t||""!==n)),o(n)};return[i,d,c,l]},p=t(25364),y=t(73848),w=t(99603),k=t(59417);function N(e){var n=e.icon,t="fa-".concat(n).replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,n){return 0===n?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"").replaceAll("-","");return(0,r.jsx)(w.G,{icon:k[t]})}function S(e){var n=(0,a.Z)({onToggle:function(){}},e),t=n.title,s=n.isOpened,i=n.content,o=n.onToggle,c=n.key;return(0,r.jsxs)("div",{className:"".concat(u().adminToggleGroup," ").concat(s?u().adminToggleGroupOpened:""),children:[(0,r.jsxs)("div",{className:u().adminToggleGroupHeader,onClick:function(){o(!s)},children:[(0,r.jsx)("h3",{children:t}),(0,r.jsx)("a",{children:(0,r.jsx)(N,{icon:s?"arrow-up":"arrow-down"})})]}),s&&(0,r.jsx)("div",{className:u().adminToggleGroupContent,children:i})]},c)}function C(e){var n=(0,a.Z)({href:"",title:"",icon:"up-right-from-square",onClick:function(){}},e),t=n.href,s=n.title,i=n.icon,o=n.onClick,c=n.target,l=n.disabled,d={className:"".concat(u().iconButton," ").concat(l?u().iconButtonDisabled:""),alt:s,title:s};return t&&(d.href=t),c&&(d.target=c),(0,r.jsx)("a",(0,b.Z)((0,a.Z)({},d),{onClick:function(){l||o()},children:(0,r.jsx)(N,{icon:i})}))}var T=t(52484),F=t(82670),I=t(66089),A=t.n(I),B=t(78967),R=t(64262),D=t(34617);function O(e){var n=(0,a.Z)({hasClose:!1,onClose:function(){}},e),t=n.title,s=n.isOpened,i=n.hasClose,o=n.onClose,c=n.children;return s?(0,r.jsx)("div",{className:u().adminPopupWindow,children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{children:[t,i&&(0,r.jsx)("a",{onClick:o,children:(0,r.jsx)(N,{icon:"close"})})]}),c]})}):null}function E(e){var n=(0,a.Z)({disabled:!1,chainId:1,className:"",action:"Save",onClick:function(){}},e),t=n.children,s=n.disabled,i=n.onClick,o=n.chainId,c=n.action,l=n.className,d=n.icon,h=(0,j.useState)(!1),f=h[0],m=h[1],x=(0,D.n)().storageChainId,v="STORAGE"==o?x:o,b=(0,j.useState)(!1),g=b[0],p=b[1],y=(0,B.BV)(),w=(0,F.Z)(v,Array),k=!w&&(0,R.T_)(v),S=!1;S=w?-1!==v.indexOf(Number("".concat(y))):"".concat(v)=="".concat(y);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{disabled:s||g,onClick:function(){S?i():w?m(!0):(p(!0),(0,B.M5)(v).then((function(e){p(!1),e&&i()})).catch((function(e){p(!1)})))},className:l,children:[d&&(0,r.jsx)(N,{icon:d}),S?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)(r.Fragment,{children:g?(0,r.jsx)(r.Fragment,{children:w?"Switching...":"Switching to ".concat(k.chainName," (").concat(v,")...")}):(0,r.jsx)(r.Fragment,{children:w?"Switch network for ".concat(c):"Switch to ".concat(k.chainName," (").concat(v,") for ").concat(c)})})]}),w&&(0,r.jsxs)(O,{hasClose:!0,isOpened:f,onClose:function(){m(!1)},title:"Switch network for ".concat(c),children:[(0,r.jsx)(A(),{id:"4d48721f3162f416",children:".switchNetworkList.jsx-4d48721f3162f416{padding:10px;padding-bottom:0px}.switchNetworkList.jsx-4d48721f3162f416 BUTTON.jsx-4d48721f3162f416{margin-left:0px;width:100%;margin-bottom:10px}"}),(0,r.jsx)("div",{className:"jsx-4d48721f3162f416 switchNetworkList",children:v.map((function(e){var n=(0,R.T_)(e);return(0,r.jsx)("button",{disabled:g,onClick:function(){!function(e){p(!0),(0,B.M5)(e).then((function(e){p(!1),e&&(m(!1),i())})).catch((function(e){p(!1)}))}(e)},className:"jsx-4d48721f3162f416 "+(u().adminButton||""),children:g?"Switching...":"Switch to ".concat(n.chainName," (").concat(e,")")},e)}))})]})]})}function L(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,s=e.addNotify,i=(e.getActiveChain,e.storageDesign),o=localStorage.getItem("-lotery-preview-mode"),c=localStorage.getItem("-lotery-preview-design");try{c=JSON.parse(c),c=(0,a.Z)({},p.$,c)}catch(P){c=p.$}var l=(0,j.useState)(null!==o),d=l[0],h=l[1],f=(0,a.Z)({},p.$,i);console.log("initialDesign",f);var m=(0,j.useState)(o?c:f),x=m[0],g=m[1],w=(0,j.useState)(!1),k=w[0],F=w[1];console.log(">>> designValues",x);var I=function(e){var n=e.title,t=e.target,s=e.defValue;return(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[n,":"]}),(0,r.jsx)("span",{children:(0,r.jsx)("div",{children:(0,r.jsx)(T.ZP,{initialValue:x[t]?x[t]:s,onChange:function(e){g((function(n){return(0,b.Z)((0,a.Z)({},n),(0,v.Z)({},"".concat(t),e.hex))}))},placement:"right"})})})]})},A=function(e){var n=e.title,t=e.target,s=e.placeholder;return(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[n,":"]}),(0,r.jsx)("span",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{placeholder:s,type:"text",value:x[t],onChange:function(e){var n;n=e.target.value,g((function(e){return(0,b.Z)((0,a.Z)({},e),(0,v.Z)({},"".concat(t),n))}))}}),C({title:"Open in new tab",href:x[t],target:"_blank"})]})})]})},B=function(){t({title:"Switch to preview mode",message:"Switch to preview mode? You can look changes before save",onConfirm:function(){s("Preview mode on. Go to site for check it","success"),localStorage.setItem("-nft-stake-preview-mode",!0),localStorage.setItem("-nft-stake-preview-design",JSON.stringify(x)),h(!0)}})},R=function(){s("Preview mode turn off","success"),localStorage.removeItem("-nft-stake-preview-mode"),localStorage.removeItem("-nft-stake-preview-design"),h(!1)};(0,j.useEffect)((function(){d&&(localStorage.setItem("-nft-stake-preview-design",JSON.stringify(x)),localStorage.setItem("-nft-stake-preview-utx",(0,y.K)()))}),[x]);var D=function(){n({onBegin:function(){F(!0),R(),s("Confirm transaction for save changed design")},onReady:function(){F(!1),s("Design successfull saved","success")},onError:function(e){F(!1),s("Fail save design","error")},newData:{design:x}})},O=(0,j.useState)({}),L=O[0],Z=O[1],_=function(e){Z((function(n){return(0,b.Z)((0,a.Z)({},n),(0,v.Z)({},"".concat(e),!n[e]||!n[e]))}))};return{render:function(){return(0,r.jsxs)("div",{className:u().adminForm,children:[(0,r.jsx)("div",{className:u().adminSectionDescription,children:"This section is where you edit the appearance of your site."}),S({title:"Logo",isOpened:null===L||void 0===L?void 0:L.logoTab,onToggle:function(){_("logoTab")},content:(0,r.jsx)("div",{className:u().subFormInfo,children:(0,r.jsx)("div",{className:u().subForm,children:A({title:"URL",target:"logoUri"})})})}),S({title:"Base color",isOpened:null===L||void 0===L?void 0:L.baseColors,onToggle:function(){_("baseColors")},content:(0,r.jsx)("div",{className:u().subFormInfo,children:(0,r.jsxs)("div",{className:u().subForm,children:[I({title:"Background color",target:"backgroundColor"}),I({title:"Text color",target:"baseTextColor"}),I({title:"Secondary",target:"baseSecondaryColor",defValue:"#7645D9"}),I({title:"Subtitle color",target:"baseSubTitleColor",defValue:"#452A7A"})]})})}),S({title:"Header settings",isOpened:null===L||void 0===L?void 0:L.headerSection,onToggle:function(){_("headerSection")},content:(0,r.jsx)("div",{className:u().subFormInfo,children:(0,r.jsxs)("div",{className:u().subForm,children:[I({title:"Section title color",target:"headerTitleColor"}),I({title:"Background color 1",target:"headerBgColor1",defValue:"#7645D9"}),I({title:"Background color 2",target:"headerBgColor2",defValue:"#452A7A"})]})})}),S({title:"Buy tickets section",isOpened:null===L||void 0===L?void 0:L.buyTicketsSection,onToggle:function(){_("buyTicketsSection")},content:(0,r.jsx)("div",{className:u().subFormInfo,children:(0,r.jsxs)("div",{className:u().subForm,children:[I({title:"Section title color",target:"buyTicketTitleColor"}),I({title:"Background color 1",target:"buyTicketBgColor1",defValue:"#7645D9"}),I({title:"Background color 2",target:"buyTicketBgColor2",defValue:"#5121B1"})]})})}),S({title:"Price section",isOpened:null===L||void 0===L?void 0:L.priceSection,onToggle:function(){_("priceSection")},content:(0,r.jsx)("div",{className:u().subFormInfo,children:(0,r.jsxs)("div",{className:u().subForm,children:[I({title:"Section title color",target:"priceSectionTitleColor"}),I({title:"Background color 1",target:"priceSectionBgColor1",defValue:"#313D5C"}),I({title:"Background color 2",target:"priceSectionBgColor2",defValue:"#3D2A54"})]})})}),S({title:"Rounds history section",isOpened:null===L||void 0===L?void 0:L.roundsHistory,onToggle:function(){_("roundsHistory")},content:(0,r.jsx)("div",{className:u().subFormInfo,children:(0,r.jsxs)("div",{className:u().subForm,children:[I({title:"Section title color",target:"roundsHistoryTitleColor"}),I({title:"Background color 1",target:"roundsHistoryBgColor1",defValue:"#CBD7EF"}),I({title:"Background color 2",target:"roundsHistoryBgColor2",defValue:"#9A9FD0"})]})})}),S({title:"How to play settings",isOpened:null===L||void 0===L?void 0:L.howToPlay,onToggle:function(){_("howToPlay")},content:(0,r.jsx)("div",{className:u().subFormInfo,children:(0,r.jsxs)("div",{className:u().subForm,children:[I({title:"Section title",target:"howToPlayTitleColor"}),I({title:"Background color",target:"howToPlayBgColor",defValue:"#ffffff"})]})})}),(0,r.jsx)("div",{className:u().adminSectionDescription,children:"You can turn on the preview mode and look at the changes before saving them to the storage contract"}),(0,r.jsxs)("div",{className:u().actionsRowMain,children:[d?(0,r.jsxs)("button",{onClick:R,className:u().adminSubButton,children:[(0,r.jsx)(N,{icon:"eye-slash"}),"Turn off preview mode"]}):(0,r.jsxs)("button",{onClick:B,className:u().adminSubButton,children:[(0,r.jsx)(N,{icon:"eye"}),"Turn on preview mode"]}),(0,r.jsx)(E,{chainId:"STORAGE",disabled:k,onClick:D,action:"Save changes",icon:"save",className:u().adminSubButton,children:k?"Saving...":"Save changes"})]})]})}}}var Z=t(64914),_=t.n(Z),P=t(3283),W=t.n(P),M=function(e,n){return new Promise((function(t,s){var a=(0,R.T_)(n);if(a)try{var i=new(new(W())(a.rpcUrls[0]).eth.Contract)(_(),e);i.methods.decimals().call().then((function(a){i.methods.symbol().call().then((function(o){i.methods.name().call().then((function(s){t({address:e,chainId:n,decimals:a,symbol:o,name:s})})).catch((function(e){s(e)}))})).catch((function(e){s(e)}))})).catch((function(e){s(e)}))}catch(o){s(o)}else s("NOT_SUPPORTED_CHAIN")}))},H=t(56767),K=function(e){return new Promise((function(n,t){var a=e.activeWeb3,i=e.tokenAddress,r=e.feeOn;console.log(">>> options",e);var l=e.onTrx||function(){},d=e.onSuccess||function(){},u=e.onError||function(){},h=e.onFinally||function(){};a.eth.getAccounts().then(function(){var e=(0,s.Z)(o().mark((function e(n){var s,f,m,x,v,b,j;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>0)){e.next=17;break}return s=n[0],f=new a.eth.Contract(H.Mt),m={from:s,gas:"0"},x=[i,!!r],e.next=7,f.deploy({arguments:x,data:H.aT.eF.Ry}).estimateGas(m);case 7:return v=e.sent,b=new c.BigNumber(new c.BigNumber(v).multipliedBy(1.05).toFixed(0)).toString(16),m.gas="0x"+b,e.next=12,a.eth.getGasPrice();case 12:j=e.sent,m.gasPrice="0x"+new c.BigNumber(j).toString(16),f.deploy({data:"0x"+H.aT.eF.Ry,arguments:x}).send(m).on("transactionHash",(function(e){console.log("transaction hash:",e),l(e)})).on("error",(function(e){console.log("transaction error:",e),u(e)})).on("receipt",(function(e){console.log("transaction receipt:",e),d(e.contractAddress)})).then((function(){h()})),e.next=18;break;case 17:t("NO_ACTIVE_ACCOUNT");case 18:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log(">>> deployLottery",e),t(e)}))}))};function V(e){var n=e.type,t=e.label,s=e.value,a=e.onChange,i=e.buttons,o=e.values,c=e.placeholder,l=e.hasError,d=e.errorText,h=e.desc,f=n;if("address"===n)f="text";return(0,r.jsxs)("div",{className:"".concat(u().adminFormInputHolder," ").concat(l?u().hasError:""),children:["list"===n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("label",{children:[t,": (",s,")"]}),h&&(0,r.jsx)("span",{className:u().adminFieldDesc,children:h}),(0,r.jsxs)("div",{children:[l&&d&&(0,r.jsx)("span",{className:u().hasError,children:d}),(0,r.jsx)("select",{value:s,onChange:function(e){return a(e.target.value)},children:o.map((function(e){return(0,r.jsx)("option",{value:e.id,children:e.title},e.id)}))})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("label",{children:[t,":"]}),h&&(0,r.jsx)("span",{className:u().adminFieldDesc,children:h}),l&&d&&(0,r.jsx)("span",{className:u().hasError,children:d}),(0,r.jsx)("div",{children:"number"===f?(0,r.jsx)("input",{min:(null===e||void 0===e?void 0:e.minValue)||void 0,max:(null===e||void 0===e?void 0:e.maxValue)||void 0,type:"number",placeholder:c||"",value:s,onChange:function(e){a(e.target.value)}}):(0,r.jsx)("input",{type:f,placeholder:c||"",value:s,onChange:function(e){return a(e.target.value)}})})]}),i&&(0,r.jsx)("div",{className:u().adminFormButtonsHolder,children:i})]})}var G=t(88240),U=function(){var e=Object.keys(R.w5).map((function(e){return{id:R.w5[e].networkVersion,title:R.w5[e].chainName}}));return e.unshift({id:0,title:"Select Blockchain"}),e}();function Y(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,s=e.addNotify,a=e.getActiveChain,i=e.storageData,o=(0,j.useState)(null===i||void 0===i?void 0:i.chainId),c=o[0],l=o[1],d=(0,j.useState)(null===i||void 0===i?void 0:i.lotteryAddress),h=d[0],f=d[1],m=(0,j.useState)(null===i||void 0===i?void 0:i.tokenAddress),x=m[0],v=m[1],b=(0,j.useState)(!1),g=b[0],p=(b[1],(0,j.useState)(!1)),y=(p[0],p[1],(0,j.useState)(!1)),w=y[0],k=y[1],N=(0,j.useState)(!1),S=N[0],C=N[1],T=(0,j.useState)(null===i||void 0===i?void 0:i.tokenInfo),F=T[0],I=T[1],A=(0,j.useState)(!1),B=A[0],D=A[1],O=(0,j.useState)(void 0!==i.tokenInfo.address),L=O[0],Z=O[1],_=(0,j.useState)(!1),P=_[0],W=_[1],H=function(){t({title:"Save to storage",message:"Save changes to storage config?",onConfirm:function(){W(!0),n({onBegin:function(){s("Confirm transaction")},onReady:function(){W(!1),s("Changed saved","success")},onError:function(e){W(!1),s("Fail save changes. ".concat(e.message?e.message:""),"error")},newData:{chainId:c,tokenAddress:x,lotteryAddress:h,tokenInfo:F}})}})},Y=function(){c?(Z(!1),D(!1),I({}),s("Fetching token info"),M(x,c).then((function(e){D(!1),I(e),Z(!0),s("Token info fetched","success")})).catch((function(e){s("Fail fetch token info. ".concat(e.message?e.message:""),"error"),D(!1)}))):s("Fail fetch. Select work chain first","error")},q=function(){},z=function(){C(!1)},J=function(){C(!0)},X=(0,j.useState)(!1),$=(X[0],X[1],function(){if(!c)return s("Fail. Select work chain first","error");if(!L)return s("Fail. Fetch token info first","error");var e=a(),n=e.activeChainId,o=e.activeWeb3,r=(0,R.T_)(n);c&&L&&x&&t({title:"Deploying Lottery contract",message:"Deploy Lottery contract at ".concat(r.chainName," (").concat(n,")?"),onConfirm:function(){k(!0),s("Deploying lottery. Confrirm transaction"),K({activeWeb3:o,tokenAddress:x,feeOn:!(0,G.Z)("LOTTERY_FULL_VERSION",i),onTrx:function(e){s("Lottery contract deploy TX ".concat(e,"..."),"success")},onSuccess:function(e){try{s("Lottery contract deployed. Now save settings","success"),f(e),k(!1),C(!1)}catch(n){console.log(">>> onSuccess error",n)}},onError:function(e){s("Fail deploy Lottery contract. ".concat(e.message?e.message:""),"error"),k(!1),console.log(e)}}).catch((function(e){k(!1),s("Fail deploy Lottery contract. ".concat(e.message?e.message:""),"error")}))}})});return{render:function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:u().adminForm,children:[(0,r.jsx)("div",{className:u().adminSectionDescription,children:"Main settings. The blockchain in which the lottery will work is indicated here, the token for buying tickets is indicated and the lottery contract is deployed"}),V({label:"Work blockchain ID",type:"list",desc:"Your lottery will run on this blockchain",values:U,value:c,onChange:l}),S?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"Deploy new Lottery contract options"}),(0,r.jsxs)("div",{className:u().subForm,children:[V({label:"Lottery token",type:"address",desc:"This token will be used to purchase tickets and as a reward in your lottery",value:x,onChange:v,placeholder:"Ender address of lottery ERC20 token",buttons:(0,r.jsx)(E,{chainId:c,className:u().adminSubButton,disabled:B,onClick:Y,action:"Fetch token info",children:B?"Fetching":"Fetch token info"})}),L&&F&&F.address&&(0,r.jsxs)("div",{className:u().infoTable,children:[(0,r.jsx)("h3",{children:"Token info"}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Symbol:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.symbol})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Name:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.name})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Decimals:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.decimals})})]})]})]}),(0,r.jsxs)("div",{className:u().actionsRow,children:[(0,r.jsx)(E,{chainId:c,className:u().adminSubButton,disabled:w,onClick:$,action:"Deploy lottery contract",children:w?"Deploying":"Deploy Lottery contract"}),(0,r.jsx)("button",{className:"".concat(u().adminSubButton," ").concat(u().isCancel),disabled:w,onClick:z,children:"Cancel"})]})]})}):(0,r.jsxs)(r.Fragment,{children:[V({label:"Lottery contract",type:"address",value:h,desc:"Set up the lottery contract by clicking the 'Deploy new' button, if this is your first time setting it up",onChange:f,placeholder:"Enter address of lottery contract",buttons:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"".concat(u().adminSubButton),disabled:g||w,onClick:q,children:g?"Fetching info":"Fetch Lottery contract info"}),(0,r.jsx)("button",{className:"".concat(u().adminSubButton),disabled:g||w,onClick:J,children:"Deploy new Lottery contract"})]})}),L&&F&&F.address&&(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"Token for which users buy tickets"}),(0,r.jsxs)("div",{className:u().subForm,children:[(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Address:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.address})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Symbol:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.symbol})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Name:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.name})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Decimals:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.decimals})})]})]})]})]}),(0,r.jsx)("div",{className:u().actionsRowMain,children:(0,r.jsx)(E,{chainId:"STORAGE",icon:"save",className:u().adminMainButton,disabled:P,onClick:H,action:"Save changes",children:P?"Saving...":"Save to storage config"})})]})})}}}var q=t(88765);function z(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,s=e.addNotify,i=e.getActiveChain,o=e.storageData,c=(e.getStorageData,(0,j.useState)(0)),l=c[0],d=c[1],h=(0,j.useState)(0),f=h[0],m=h[1],x=(0,j.useState)(0),g=x[0],p=x[1],y=(0,j.useState)(!1),w=y[0],k=y[1],S=(0,j.useState)(o.ticketPrice),C=S[0],T=S[1],F=(0,j.useState)(!1),I=F[0],A=F[1],B=(0,j.useState)(!1),R=(B[0],B[1]),D=(0,j.useState)(o.buyTokenLink),O=D[0],L=D[1];(0,j.useEffect)((function(){o.lotteryAddress&&o.chainId&&(0,q.Z)({isCall:!0,chainId:o.chainId,contractAddress:o.lotteryAddress,method:"numbersCount",args:[]}).then((function(e){Q(e)}))}),[o]);var Z=(0,j.useState)(o.matchRules||{match_1:39.2,match_2:58.8,match_3:6.125,match_4:12.25,match_5:24.5,match_6:49}),_=Z[0],P=Z[1],W=(0,j.useState)([1,2,3,4,5,6]),M=W[0],H=W[1],K=(0,j.useState)(!1),V=K[0],G=K[1],U=(0,j.useState)(!1),Y=U[0],z=U[1],J=(0,j.useState)(o.burn),X=J[0],$=J[1],Q=function(e){e<2&&(e=2),e>6&&(e=6),p(e),k("".concat(o.balls)!=="".concat(e)),H((function(n){return[1,2,3,4,5,6].filter((function(n){return n<=parseInt(e)}))}))};(0,j.useEffect)((function(){!function(){for(var e=0,n=1;n<=6;n++)n<=g&&(e+=_["match_".concat(n)]);d(e),m(100-e)}()}),[g,_]);var ee=function(){t({title:"Save changes to Lottery",message:"Save new count of balls?",onConfirm:function(){G(!0);var e=i().activeWeb3;s("Confirm transaction"),(0,q.Z)({activeWeb3:e,contractAddress:o.lotteryAddress,method:"setNumbersCount",args:[g]}).then((function(e){G(!1),k(!1),s("Changes saved","success")})).catch((function(e){G(!1),s("Fail save balls count. ".concat(e.message?e.message:""),"error")}))}})},ne=function(){t({title:"Save match rules",message:"Save winning balls match rules, burn amount and ticket price to storage config?",onConfirm:function(){z(!0),s("Saving winning rules..."),n({onBegin:function(){s("Confirm transaction")},onReady:function(){z(!1),s("Changed saved","success")},onError:function(e){z(!1),s("Fail save changes. ".concat(e.message?e.message:""),"error")},newData:{matchRules:_,burn:X,balls:g,ticketPrice:C,buyTokenLink:O}})}})};return{render:function(){var e;return o.lotteryAddress?(0,r.jsx)("div",{className:u().adminForm,children:(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"Lottery rules"}),(0,r.jsx)("div",{className:u().subForm,children:(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"The number of balls that will be drawn in your lottery. Number two to six"})]}),"Balls count:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",min:"2",max:"6",step:"1",value:g,onChange:function(e){Q(e.target.value)}}),(0,r.jsx)(E,{chainId:o.chainId,onClick:ee,disabled:V,icon:"save",action:"Save balls count",className:u().adminButton,children:V?"Saving the number of balls in the lottery contract":"Save the number of balls in the lottery contract"})]})})]})}),(0,r.jsx)("h3",{children:"Distribution of prizes %"}),(0,r.jsxs)("div",{className:u().subForm,children:[(0,r.jsx)("h4",{children:"Distribute the winning percentage based on the number of matched balls"}),(0,r.jsx)("div",{className:u().adminFieldDesc,children:'You can also use the "Equalize the remainder" button to distribute the remaining percentage in the desired field'}),M.map((function(e){return(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:["The percentage of winnings from the bank when ",e," number matches"]})]}),"Match ",e," ball:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",min:"0",max:"100",step:"0.01",value:_["match_".concat(e)],onChange:function(n){var t=0;try{t=parseFloat(n.target.value)}catch(s){t=0}t<0&&(t=0),t>100&&(t=100),P((function(n){return(0,b.Z)((0,a.Z)({},n),(0,v.Z)({},"match_".concat(e),t))}))}}),(0,r.jsx)("strong",{children:"%"}),(0,r.jsxs)("button",{className:u().adminButton,onClick:function(){var n;n=e,P((function(e){return(0,b.Z)((0,a.Z)({},e),(0,v.Z)({},"match_".concat(n),e["match_".concat(n)]+f))}))},children:[(0,r.jsx)(N,{icon:"arrow-left"}),"Equalize the remainder"]})]})})]},e)})),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"The sum of all winning combinations is on top. This number must be equal to 100%"})]}),"Sum:"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("b",{children:l}),(0,r.jsx)("strong",{children:"%"})]})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"The amount of undistributed winnings from the field above. This number must be 0%"})]}),"Undistributed:"]}),(0,r.jsx)("div",{children:0!==f?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("b",{className:u().hasError,children:[f," %"]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("b",{children:f}),(0,r.jsx)("strong",{children:"%"})]})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"As an administrator, you have the option to set a service fee for each round of the lottery."}),(0,r.jsx)("span",{children:'The service fee is transferred to your wallet address, and a portion of this fee, equal to 1/5 of the service fee, is deducted as the "onout.org" fee.'}),(0,r.jsx)("span",{children:'The "onout.org" fee can be removed by purchasing the premium version of the lottery service.'})]})]}),"Service fee (From 2 to 30):"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",min:"2",max:"30",value:X,onChange:function(e){$(e.target.value)}}),(0,r.jsx)("strong",{children:"%"})]})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Ticket price:"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",step:"0.1",min:"0",value:C,onChange:function(e){!function(n){A(!1);try{(n=parseFloat(n))<0&&A(!0),n>5e5&&A(!0)}catch(e){A(!0)}T(n),R(o.ticketPrice!==n)}(e.target.value)}}),(0,r.jsx)("strong",{children:null===o||void 0===o||null===(e=o.tokenInfo)||void 0===e?void 0:e.symbol})]}),I&&(0,r.jsx)("div",{className:u().hasError,children:(0,r.jsx)("strong",{children:"Price must be between 0.00000000001 and 500000"})})]})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{children:"Link to the service where users can buy your token to pay for tickets"})})]}),"Buy Token link:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"text",value:O,onChange:function(e){L(e.target.value)}})})})]}),(0,r.jsxs)("div",{className:u().actionsRow,children:[w&&(0,r.jsx)("strong",{className:u().hasError,children:"Save balls count first!"}),(0,r.jsx)(E,{chainId:"STORAGE",onClick:ne,disabled:Y||w,icon:"save",action:"Save changes",className:u().adminSubButton,children:Y?"Saving...":"Save match rules, burn amount and ticket price"})]})]})]})}):(0,r.jsxs)("div",{className:u().errorBlock,children:[(0,r.jsx)("span",{children:"Section not accessible"}),(0,r.jsx)("span",{children:"Deploy and save the lottery contract first"})]})}}}var J=function(e){return new Promise(function(){var n=(0,s.Z)(o().mark((function n(t,s){var a,i,r,c,l,d,u,h,f,m;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.chainId,i=e.contractAddress,!(r=(0,R.T_)(a))){n.next=27;break}return n.prev=3,c=new(W())(r.rpcUrls[0]),l=new c.eth.Contract(H.Mt,i),n.next=8,l.methods.owner().call();case 8:return d=n.sent,n.next=11,l.methods.operatorAddress().call();case 11:return u=n.sent,n.next=14,l.methods.treasuryAddress().call();case 14:return h=n.sent,n.next=17,l.methods.viewCurrentLotteryId().call();case 17:return f=n.sent,n.next=20,l.methods.viewLottery(f).call();case 20:m=n.sent,t({chainId:a,contractAddress:i,owner:d,operator:u,treasury:h,currentLotteryInfo:m,currentLotteryNumber:f}),n.next=27;break;case 24:n.prev=24,n.t0=n.catch(3),s(n.t0);case 27:case"end":return n.stop()}}),n,null,[[3,24]])})));return function(e,t){return n.apply(this,arguments)}}())},X=function(e,n){var t=Number(n-e),s=Math.floor(t/3600),a=Math.floor(t%3600/60),i=Math.floor(t%3600%60);return(s>0?s+(1==s?" hour, ":" hours, "):"")+(a>0?a+(1==a?" minute, ":" minutes, "):"")+(i>0?i+(1==i?" second":" seconds"):"")},$=function(e){var n=e.ownerAddress,t=e.tokenAddress,s=e.chainId,a=e.approveFor;return new Promise((function(e,i){var o=(0,R.T_)(s);if(o)try{new(new(W())(o.rpcUrls[0]).eth.Contract)(_(),t).methods.allowance(n,a).call().then((function(n){e(n)})).catch((function(e){i(e)}))}catch(r){i(r)}else i("NOT_SUPPORTED_CHAIN")}))},Q=t(29815),ee=t(53419),ne=function(e){return new Promise((function(n,t){var a=e.activeWeb3,i=(e.chainId,e.tokenAddress),r=e.approveFor,l=e.weiAmount,d=e.onTrx||function(){},u=e.onSuccess||function(){},h=e.onError||function(){},f=e.onFinally||function(){};a.eth.getAccounts().then(function(){var e=(0,s.Z)(o().mark((function e(s){var m,x,v,b,j;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s.length>0)){e.next=14;break}return x=s[0],v=new a.eth.Contract(_(),i),e.next=6,(0,ee.A)(x,v,"approve",[r,l]);case 6:return b=e.sent,e.next=9,a.eth.getGasPrice();case 9:j=e.sent,b.gasPrice="0x"+new c.BigNumber(j).toString(16),(m=v.methods).approve.apply(m,(0,Q.Z)([r,l])).send(b).on("transactionHash",(function(e){console.log("transaction hash:",e),d(e)})).on("error",(function(e){console.log("transaction error:",e),h(e),t(e)})).on("receipt",(function(e){console.log("transaction receipt:",e),u(e)})).then((function(e){n(e),f(e)})),e.next=15;break;case 14:t("NO_ACTIVE_ACCOUNT");case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log(">>> approveToken",e),t(e)}))}))},te=t(35553),se=t(72023),ae=t.n(se),ie=function(){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=n.length,s=0;s<128;s++)e+=n.charAt(Math.floor(Math.random()*t));return e};function oe(e){e.setDoReloadStorage,e.saveStorageConfig;var n=e.openConfirmWindow,t=e.addNotify,s=e.getActiveChain,a=e.storageData,i=(e.getStorageData,(0,j.useState)(!1)),o=i[0],c=i[1],d=(0,j.useState)(!1),h=d[0],f=d[1],m=(0,j.useState)(!1),x=m[0],v=m[1],b=(0,j.useState)(!1),g=b[0],p=b[1],w=(0,j.useState)(!1),k=w[0],S=w[1],C=(0,j.useState)(""),T=C[0],F=C[1],I=(0,j.useState)(0),A=I[0],B=I[1],R=(0,j.useState)(!1),D=R[0],O=R[1],L=(0,j.useState)(!1),Z=L[0],_=L[1],P=(0,j.useState)(!1),W=P[0],M=P[1],H=(0,j.useState)(!1),K=H[0],V=H[1];(0,j.useEffect)((function(){if(o&&h){var e=new Date("".concat(o," ").concat(h)).getTime()/1e3,n=X((0,y.K)(),e);v(n)}}),[o,h]);var G=function(){a.chainId&&a.lotteryAddress&&(t("Fetching lottery status"),J({chainId:a.chainId,contractAddress:a.lotteryAddress}).then((function(e){t("Lottery status fetched","success"),p(e),S(e.currentLotteryInfo)})))};(0,j.useEffect)((function(){V(!1);var e=new(l())(k.amountCollectedInCake).div(new(l())(10).pow(a.tokenInfo.decimals)).toNumber();B(e),O(new Date(1e3*parseInt(k.startTime,10)).toString()),_(new Date(1e3*parseInt(k.endTime,10)).toString()),M(X((0,y.K)(),parseInt(k.endTime,10)+60)),"1"===k.status&&parseInt(k.endTime,10)-(0,y.K)()<0?(F("lottery_round"),V(!0)):"1"!==g.currentLotteryNumber&&"1"===k.status?F("lottery_round"):"2"===k.status?F("lottery_draw"):"3"===k.status&&F("lottery_start")}),[k]),(0,j.useEffect)((function(){G()}),[a]);var U=(0,j.useState)(!1),Y=U[0],z=U[1],Q=function(){var e;return void 0===(null===a||void 0===a||null===(e=a.tokenInfo)||void 0===e?void 0:e.decimals)?t("Fail. No information about token. Fetch them first and return","error"):(null===a||void 0===a?void 0:a.ticketPrice)?(null===a||void 0===a?void 0:a.burn)?o&&h?void n({title:"New round",message:"Start new lottery round?",onConfirm:function(){var e=new(l())(a.ticketPrice).multipliedBy(Math.pow(10,a.tokenInfo.decimals)).toFixed(),n=parseInt(100*a.burn,10),i=[1,2,3,4,5,6].map((function(e){return e<=a.balls?parseInt(100*parseFloat(a.matchRules["match_".concat(e)]),10):0})),r=new Date("".concat(o," ").concat(h)).getTime()/1e3;t("Starting new lottery round..."),z(!0);var c=s().activeWeb3;(0,q.Z)({activeWeb3:c,contractAddress:a.lotteryAddress,method:"startLottery",args:[r,e,2e3,i,n]}).then((function(e){z(!1),G(),t("New lottery round started","success")})).catch((function(e){z(!1),t("Fail start new lottery round. ".concat(e.message?e.message:""),"error")}))}}):t("Fail. Enter date of lottery round end","error"):t("Fail. Burn amount not setted","error"):t("Fail. Ticket price not setted.","error")},ee=(0,j.useState)(0),se=ee[0],oe=ee[1],re=(0,j.useState)(!1),ce=(re[0],re[1]),le=function(){n({title:"Inject lotery bank amount",message:"Add ".concat(se," ").concat(null===a||void 0===a?void 0:a.tokenInfo.symbol," to the pot of the lottery round?"),onConfirm:function(){ce(!0);var e,n,i=(e=se,te.vz("".concat(e),n)),o=s();t("Inject bank. Check allovance"),$({ownerAddress:o.activeAccount,tokenAddress:null===a||void 0===a?void 0:a.tokenAddress,chainId:null===a||void 0===a?void 0:a.chainId,approveFor:null===a||void 0===a?void 0:a.lotteryAddress}).then((function(e){var n=function(){t("Injecting round bank. Confirm transaction"),(0,q.Z)({activeWeb3:o.activeWeb3,contractAddress:a.lotteryAddress,method:"injectFunds",args:[g.currentLotteryNumber,i]}).then((function(e){ce(!1),G(),t("The bank or round was replenished","success")})).catch((function(e){ce(!1),t("Fail inject funds. ".concat(e.message?e.message:""),"error")}))};new(l())("".concat(i)).isGreaterThan(e)?(t("Inject bank. Need approve"),ne({activeWeb3:o.activeWeb3,chainId:null===a||void 0===a?void 0:a.chainId,tokenAddress:null===a||void 0===a?void 0:a.tokenAddress,approveFor:null===a||void 0===a?void 0:a.lotteryAddress,weiAmount:i}).then((function(e){n()})).catch((function(e){ce(!1),t("Fail approve for inject round bank. ".concat(e.message?e.message:""),"error")}))):n()})).catch((function(e){ce(!1),t("Fail inject round bank. ".concat(e.message?e.message:""),"error")}))}})},de=(0,j.useState)(!1),ue=de[0],he=de[1],fe=function(){var e=s();he(!0),t("Closing lottery round. Confirm transaction"),(0,q.Z)({activeWeb3:e.activeWeb3,contractAddress:a.lotteryAddress,method:"closeLottery",args:[g.currentLotteryNumber]}).then((function(e){he(!1),G(),t("Lottery round was closed","success")})).catch((function(e){he(!1),t("Fail close lottery round. ".concat(e.message?e.message:""),"error")}))},me=(0,j.useState)(ie()),xe=me[0],ve=me[1],be=function(){ve(ie())},je=(0,j.useState)(!1),ge=je[0],pe=je[1],ye=function(){var e=ie(),n=ae()("".concat(e).concat(xe));pe(!0),t("Drawing winning numbers. Confirm transaction");var i=s();(0,q.Z)({activeWeb3:i.activeWeb3,contractAddress:a.lotteryAddress,method:"drawFinalNumberAndMakeLotteryClaimable",args:[g.currentLotteryNumber,"0x".concat(n),!0]}).then((function(e){pe(!1),G(),t("Winning numbers drawed!","success")})).catch((function(e){pe(!1),t("Fail draw winning numbers. ".concat(e.message?e.message:""),"error")}))};return{render:function(){var e,n;return a.lotteryAddress?(0,r.jsxs)("div",{className:u().adminForm,children:[(0,r.jsx)("div",{className:u().adminSectionDescription,children:"This section is where the lottery rounds are managed. Start of a new round, end of the round and calculation of winning balls"}),"lottery_start"===T&&(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"Start new lottery round"}),(0,r.jsx)("div",{className:u().adminSubFormDesc,children:"There are currently no rounds running. Start a new lottery round"}),(0,r.jsxs)("div",{className:u().subForm,children:[(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"The date and time when the sale of tickets will be stopped and the lottery will enter the winning balls calculation mode."}),(0,r.jsx)("span",{children:"The minimum round time is 5 minutes."}),(0,r.jsx)("span",{children:"The maximum round time is 31 days."})]})]}),"Round end in:"]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"date",value:o,onChange:function(e){c(e.target.value)}}),(0,r.jsx)("input",{type:"time",value:h,onChange:function(e){f(e.target.value)}}),(0,r.jsx)("strong",{children:"(min 5 minutes, max 31 days)"})]}),x&&(0,r.jsx)("div",{children:(0,r.jsxs)("strong",{children:["Round length is ",x]})})]})]}),(0,r.jsx)("div",{className:u().actionsRow,children:(0,r.jsx)(E,{className:u().adminSubButton,onClick:Q,disabled:Y,chainId:null===a||void 0===a?void 0:a.chainId,action:"Start new round",children:Y?"Starting new lottery round...":"Start new lottery round"})})]})]}),"lottery_round"===T&&(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"Lottery round is running now"}),(0,r.jsxs)("div",{className:u().subForm,children:[(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Round started:"}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)("strong",{children:D})})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{children:"Round ends:"}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)("strong",{children:Z})})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"How much time is left until the end of the current round."}),(0,r.jsx)("span",{children:"After this time, the sale of tickets will be terminated and the lottery will switch to the mode of calculating winning balls."})]})]}),"Time left:"]}),(0,r.jsx)("div",{children:K?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"The time for the round has passed."}),(0,r.jsx)("span",{children:"You need to close the lottery and move on to generating winning balls"})]})]}),(0,r.jsx)("strong",{children:"Time is over. Close Lottery round."})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:W}),(0,r.jsxs)("button",{className:u().adminButton,onClick:G,children:[(0,r.jsx)(N,{icon:"refresh"}),"Fetch status"]})]})})]}),K&&(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:["The time for the round has passed. You need to close the lottery and move on to generating winning balls",(0,r.jsx)("span",{children:'Click "Close round" to proceed to the calculation of winning balls'})]})]}),"Close Lottery round:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)(E,{chainId:null===a||void 0===a?void 0:a.chainId,action:"Close round",onClick:fe,disabled:ue,className:u().adminButton,children:ue?"Closing...":"Close Lottery round"})})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"How many tokens are raffled off in the current round."}),(0,r.jsx)("span",{children:"If you wish, you can increase the amount of tokens in the bank."}),(0,r.jsx)("span",{children:'To do this, use the "Inject lotery bank funds" section below.'})]})]}),"Round bank:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsxs)("strong",{children:[A," ",null===a||void 0===a||null===(e=a.tokenInfo)||void 0===e?void 0:e.symbol]})})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"In this section, you can add tokens to the bank of the current lottery round."}),(0,r.jsx)("span",{children:"The added tokens will be distributed among the winning tickets."}),(0,r.jsx)("span",{children:"Unallocated tokens will be transferred to the general lottery bank and raffled off in the next rounds"})]})]}),"Inject lotery bank funds:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",min:"0",step:"0.01",value:se,onChange:function(e){oe(e.target.value)}}),(0,r.jsx)("strong",{children:null===a||void 0===a||null===(n=a.tokenInfo)||void 0===n?void 0:n.symbol})]})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsx)("label",{}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)(E,{className:u().adminButton,onClick:le,chainId:null===a||void 0===a?void 0:a.chainId,action:"Add tokens to lottery bank",icon:"add",children:"Approve and add to round bank"})})})]})]})]}),"lottery_draw"===T&&(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"The lottery round is over. You need to calculate the winning combination"}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"A unique randomly generated string that will be used as a salt during the calculation of winning balls."}),(0,r.jsx)("span",{children:"The uniqueness of this string guarantees protection against fraud by users."})]})]}),"Uniq salt:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",value:xe,readOnly:!0}),(0,r.jsx)("button",{className:u().adminButton,onClick:be,children:"Generate"})]})})]}),(0,r.jsx)("div",{className:u().actionsRow,children:(0,r.jsx)(E,{className:u().adminButton,onClick:ye,disabled:ge,chainId:null===a||void 0===a?void 0:a.chainId,action:"Calculate winning number",children:"Calculate winning numbers"})})]})]}):(0,r.jsxs)("div",{className:u().errorBlock,children:[(0,r.jsx)("span",{children:"Section not accessible"}),(0,r.jsx)("span",{children:"Deploy and save the lottery contract first"})]})}}}var re=t(37826);function ce(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,s=e.addNotify,i=(e.getActiveChain,e.storageData),o=e.storageTexts,c=(0,j.useState)(i.texts),l=c[0],d=c[1],h=(0,j.useState)(!1),f=h[0],m=h[1],x=localStorage.getItem("-nft-stake-preview-text-mode"),g=localStorage.getItem("-nft-stake-preview-texts");try{g=JSON.parse(g),g=(0,a.Z)({},o,g)}catch(O){g=o}var p=(0,j.useState)(null!==x),w=p[0],k=p[1],C=function(){t({title:"Switch to preview mode",message:"Switch to preview mode? You can look changes before save",onConfirm:function(){s("Preview mode on. Go to site for check it","success"),localStorage.setItem("-nft-stake-preview-text-mode",!0),localStorage.setItem("-nft-stake-preview-texts",JSON.stringify(l)),k(!0)}})},T=function(){s("Preview mode turn off","success"),localStorage.removeItem("-nft-stake-preview-text-mode"),localStorage.removeItem("-nft-stake-preview-texts"),k(!1)};(0,j.useEffect)((function(){w&&(localStorage.setItem("-nft-stake-preview-texts",JSON.stringify(l)),localStorage.setItem("-nft-stake-preview-texts-utx",(0,y.K)()))}),[l]);var F=function(){t({title:"Save texts",message:"Save changes to storage config?",onConfirm:function(){m(!0),n({onBegin:function(){T(),s("Confirm transaction for save changed texts")},onReady:function(){s("Texts successfull saved","success"),m(!1)},onError:function(e){s("Fail save texts","error"),m(!1)},newData:{texts:l}})}})},I=function(e,n){d((function(t){return(0,b.Z)((0,a.Z)({},t),(0,v.Z)({},"".concat(e),n))}))},A=function(e){var n=e.code,t=e.desc,s=(e.value,e.defValue),a=e.multiline,i=e.multilineView,o=e.markdown;return(0,r.jsxs)("div",{className:u().adminStorageTextArea,children:[(0,r.jsxs)("label",{children:[t," (",n,") ",o&&(0,r.jsx)("b",{children:"(MarkDown)"})," ",a&&(0,r.jsx)("b",{children:"(Multiline)"})]}),a||i?(0,r.jsx)("textarea",{value:void 0!==l[n]?l[n]:s,onChange:function(e){I(n,e.target.value)}}):(0,r.jsx)("input",{type:"text",value:void 0!==l[n]?l[n]:s,onChange:function(e){I(n,e.target.value)}})]})},B=(0,j.useState)({}),R=B[0],D=B[1];return{render:function(){return(0,r.jsxs)("div",{className:u().adminForm,children:[(0,r.jsx)("div",{className:u().adminSectionDescription,children:"In this section, labels are edited."}),Object.keys(re.D).map((function(e){return S({title:re.D[e].title,isOpened:R[e],onToggle:function(){!function(e){D((function(n){return(0,b.Z)((0,a.Z)({},n),(0,v.Z)({},"".concat(e),void 0===R[e]||!R[e]))}))}(e)},key:e,content:(0,r.jsx)("div",{className:u().adminFormTextGroup,children:re.D[e].items.map((function(e,n){var t=e.code,s=e.desc,a=e.value,i=e.multiline,o=e.markdown,c=e.multilineView;return(0,r.jsx)("div",{children:A({code:t,desc:s,defValue:a,multiline:i,multilineView:c,markdown:o})},n)}))})})})),(0,r.jsx)("div",{className:u().adminSectionDescription,children:"You can turn on the preview mode and look at the changes before saving them to the storage contract"}),(0,r.jsxs)("div",{className:u().actionsRowMain,children:[w?(0,r.jsxs)("button",{onClick:T,className:u().adminSubButton,children:[(0,r.jsx)(N,{icon:"eye-slash"}),"Turn off preview mode"]}):(0,r.jsxs)("button",{onClick:C,className:u().adminSubButton,children:[(0,r.jsx)(N,{icon:"eye"}),"Turn on preview mode"]}),(0,r.jsx)(E,{chainId:"STORAGE",disabled:f,onClick:F,action:"Save changes",icon:"save",className:u().adminSubButton,children:f?"Saving...":"Save changes"})]})]})}}}var le=function(e,n,t){return new Promise((function(s,a){var i=(0,R.T_)(t);if(i)try{var o=new(new(W())(i.rpcUrls[0]).eth.Contract)(_(),n);o.methods.decimals().call().then((function(i){o.methods.balanceOf(e).call().then((function(a){var o=function(e,n){return te.bM(e,n)}(a,i);s({wallet:e,tokenAddress:n,chainId:t,decimals:i,wei:a,normalized:o})})).catch((function(e){a(e)}))})).catch((function(e){a(e)}))}catch(r){a(r)}else a("NOT_SUPPORTED_CHAIN")}))};function de(e){e.setDoReloadStorage,e.saveStorageConfig;var n=e.openConfirmWindow,t=e.addNotify,s=e.getActiveChain,a=e.storageData,i=(e.getStorageData,(0,j.useState)(!1)),o=i[0],c=i[1],l=(0,j.useState)(0),d=l[0],h=l[1],f=(0,j.useState)(0),m=f[0],x=f[1],v=(0,j.useState)(!1),b=v[0],g=v[1],p=(0,j.useState)(0),w=p[0],k=p[1],N=(0,j.useState)(!0),S=N[0],C=N[1],T=function(){n({title:"Withdraw Lottery bank",message:"Do you really want to withdraw the entire bank from the lottery contract?",onConfirm:function(){c(!0);var e=s().activeWeb3;(0,q.Z)({activeWeb3:e,contractAddress:a.lotteryAddress,method:"withdrawBank",args:[b.wei]}).then((function(e){c(!1),C(!0),t("Lottery bank withdrawed","success")})).catch((function(e){c(!1),t("Fail withdraw lottery bank. ".concat(e.message?e.message:""),"error")}))}})};return(0,j.useEffect)((function(){a.chainId&&a.lotteryAddress&&a.tokenAddress&&S&&(t("Fetching lottery status"),J({chainId:a.chainId,contractAddress:a.lotteryAddress}).then((function(e){var n=e.currentLotteryInfo;console.log(">>> lotteryStatus",e),h(n.endTime),x(n.status),k(Number(n.endTime)+2678400-(0,y.K)()),le(a.lotteryAddress,a.tokenAddress,a.chainId).then((function(e){g(e),C(!1)}))})))}),[a]),{render:function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:u().adminForm,children:[(0,r.jsx)("div",{className:u().adminSectionDescription,children:"As an administrator, you have the option to withdraw unclaimed funds from the bank after two months have passed since the last round of the lottery. However, please be aware that a portion of the withdrawal, equal to 1/5 of the total amount, will be deducted as the OnOut fee. If you wish to avoid this fee, you can purchase the premium version of the lottery service."}),(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"Lottery bank info"}),a.tokenInfo&&a.chainId&&a.lotteryAddress&&a.tokenInfo.symbol&&b?(0,r.jsxs)("div",{className:u().subForm,children:[(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"Date when the last round was closed"})]}),"Last round ends in:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("strong",{children:new Date(1e3*Number(d)).toString()})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"How much time has passed since the last round closed"})]}),"Time left:"]}),(0,r.jsx)("div",{children:w>0?(0,r.jsx)("strong",{children:X((0,y.K)(),Number(d)+2678400)}):(0,r.jsx)("strong",{children:"Freeze time is up. You can take the bank"})})]}),(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"How much is in the lottery bank now"})]}),"Lottery bank:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:b.normalized}),(0,r.jsx)("strong",{children:a.tokenInfo.symbol})]})})]}),(0,r.jsx)("div",{className:u().actionsRow,children:(0,r.jsx)(E,{chainId:a.chainId,onClick:T,disabled:o||w>0||"3"!=m,icon:"money-bill-transfer",action:"Withdraw bank",className:u().adminButton,children:o?"Withdrawing lottery bank":"Withdraw lottery bank"})})]}):(0,r.jsx)("div",{children:"Fetching info..."})]})]})})}}}var ue=t(828);function he(e,n){return(0,r.jsx)("a",{className:u().openInNewTab,href:e,target:"_blank",alt:n,title:n,children:(0,r.jsx)(w.G,{icon:k.faUpRightFromSquare})})}var fe={},me=[];function xe(e){var n=e.addNotify,t=e.openConfirmWindow,s=e.storageMenu,a=e.saveStorageConfig,i=(0,j.useState)(s&&s.length?s:me),o=i[0],c=i[1],l=(0,j.useState)(!1),d=l[0],h=l[1],f=(0,j.useState)(0),m=f[0],x=f[1],v=(0,ue.Z)(g("",{notEmpty:!0}),4),b=v[0],p=v[1],y=v[2],w=(v[3],(0,j.useState)("")),k=w[0],S=w[1],T=(0,ue.Z)(g("",{notEmpty:!0}),4),F=T[0],I=T[1],B=T[2],R=(T[3],(0,j.useState)(!1)),D=R[0],L=R[1],Z=(0,j.useState)(!1),_=Z[0],P=Z[1],W=function(){P(!1)},M=function(){p(""),S(""),I(""),L(!1),h(!1),P(!0)},H=function(){if(y)return n("Title is required","error");if(""==k&&B)return n("Href is required","error");var e={title:b,target:k,link:F,blank:D};d?(P(!1),n("Menu item changed","success"),c((function(n){return n[m]=e,(0,Q.Z)(n)}))):(P(!1),n("New menu item added","success"),c((function(n){return(0,Q.Z)(n).concat([e])})))},K=(0,j.useState)(!1),V=K[0],G=K[1],U=function(){t({title:"Save menu items",message:"Save changes to storage config?",onConfirm:function(){G(!0),a({onBegin:function(){n("Confirm transaction for save changed menu items")},onReady:function(){n("Menu items successfull saved","success"),G(!1)},onError:function(e){n("Fail save menu items","error"),G(!1)},newData:{menu:o}})}})};return{render:function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b tab-menu-items",children:[(0,r.jsx)(A(),{id:"b83f427d8620324b",children:'.tab-menu-items.jsx-b83f427d8620324b{width:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.tab-menu-items.jsx-b83f427d8620324b TABLE.jsx-b83f427d8620324b{width:100%;border:1px solid#fff;margin-bottom:10px;border-spacing:0px;border-right:0px;border-bottom:0px}.tab-menu-items.jsx-b83f427d8620324b TABLE.jsx-b83f427d8620324b THEAD.jsx-b83f427d8620324b TR.jsx-b83f427d8620324b{background:#0b469f}.tab-menu-items.jsx-b83f427d8620324b TABLE.jsx-b83f427d8620324b TD.jsx-b83f427d8620324b{padding:4px;border-bottom:1px solid#fff;border-right:1px solid#fff}.tab-menu-items.jsx-b83f427d8620324b TABLE.jsx-b83f427d8620324b TBODY.jsx-b83f427d8620324b TD.jsx-b83f427d8620324b{text-align:left}.tab-menu-items.jsx-b83f427d8620324b TABLE.jsx-b83f427d8620324b TBODY.jsx-b83f427d8620324b TR.jsx-b83f427d8620324b{border-bottom:1px solid red}.tab-menu-items.jsx-b83f427d8620324b TABLE.jsx-b83f427d8620324b TBODY.jsx-b83f427d8620324b TR.is-edit.jsx-b83f427d8620324b{vertical-align:top}.tab-menu-items.jsx-b83f427d8620324b TR.is-edit.jsx-b83f427d8620324b SELECT.jsx-b83f427d8620324b,.tab-menu-items.jsx-b83f427d8620324b TR.is-edit.jsx-b83f427d8620324b INPUT[type="text"].jsx-b83f427d8620324b{display:block;width:100%}.tab-menu-items.jsx-b83f427d8620324b TR.is-edit.jsx-b83f427d8620324b LABEL.jsx-b83f427d8620324b{display:block}.tab-menu-items.jsx-b83f427d8620324b TD.options.jsx-b83f427d8620324b{white-space:nowrap}.tab-menu-items.jsx-b83f427d8620324b TD.jsx-b83f427d8620324b{width:100%}.tab-menu-items.jsx-b83f427d8620324b TD.jsx-b83f427d8620324b:first-child{width:30%}.tab-menu-items.jsx-b83f427d8620324b TABLE.jsx-b83f427d8620324b TBODY.jsx-b83f427d8620324b TD.empty.jsx-b83f427d8620324b{text-align:center;font-weight:bold}'}),(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b "+(u().adminForm||""),children:[(0,r.jsxs)("table",{className:"jsx-b83f427d8620324b",children:[(0,r.jsx)("thead",{className:"jsx-b83f427d8620324b",children:(0,r.jsxs)("tr",{className:"jsx-b83f427d8620324b",children:[(0,r.jsx)("td",{className:"jsx-b83f427d8620324b",children:"Title"}),(0,r.jsx)("td",{className:"jsx-b83f427d8620324b",children:"Link"}),(0,r.jsx)("td",{className:"jsx-b83f427d8620324b",children:"Options"})]})}),(0,r.jsx)("tbody",{className:"jsx-b83f427d8620324b",children:o.length>0?o.map((function(e,s){var a=e.title,i=e.target,l=e.link,d=e.blank;return(0,r.jsxs)("tr",{className:"jsx-b83f427d8620324b",children:[(0,r.jsx)("td",{className:"jsx-b83f427d8620324b",children:(0,r.jsx)("b",{className:"jsx-b83f427d8620324b",children:a})}),(0,r.jsx)("td",{className:"jsx-b83f427d8620324b",children:(0,r.jsx)("b",{className:"jsx-b83f427d8620324b",children:""==i?(0,r.jsxs)(r.Fragment,{children:[d&&(0,r.jsx)(r.Fragment,{children:"[NEW TAB]\xa0"}),l,he(l,l)]}):(0,r.jsx)(r.Fragment,{children:"[".concat(i," PAGE]")})})}),(0,r.jsxs)("td",{className:"jsx-b83f427d8620324b options",children:[C({title:"Move item up",icon:"arrow-up",onClick:function(){var e;(e=s)>0&&c((function(n){var t=n[e-1];return n[e-1]=n[e],n[e]=t,(0,Q.Z)(n)}))}}),C({title:"Move item down",icon:"arrow-down",onClick:function(){var e;(e=s)<o.length-1&&c((function(n){var t=n[e+1];return n[e+1]=n[e],n[e]=t,(0,Q.Z)(n)}))}}),C({title:"Edit menu item",icon:"edit",onClick:function(){!function(e){var n=o[e],t=n.title,s=n.target,a=n.link,i=n.blank;x(e),p(t),S(s),I(a),L(i),h(!0),P(!0)}(s)}}),C({title:"Remove menu item",icon:"trash",onClick:function(){var e;e=s,t({title:"Removing menu item",message:"Remove this menu item?",onConfirm:function(){n("Menu item removed","success"),c((function(n){return n.splice(e,1),(0,Q.Z)(n)}))}})}})]})]},s)})):(0,r.jsx)("tr",{className:"jsx-b83f427d8620324b",children:(0,r.jsx)("td",{colSpan:"3",className:"jsx-b83f427d8620324b empty",children:"No menu items"})})})]}),(0,r.jsx)("div",{className:"jsx-b83f427d8620324b "+(u().actionsRow||""),children:(0,r.jsxs)("button",{onClick:M,className:"jsx-b83f427d8620324b "+(u().adminButton||""),children:[(0,r.jsx)(N,{icon:"add"}),"Add new menu item"]})})]}),(0,r.jsx)(O,{title:d?"Edit menu item":"Add new menu item",isOpened:_,children:(0,r.jsx)("div",{className:"jsx-b83f427d8620324b "+(u().adminForm||""),children:(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b "+(u().subFormInfo||""),children:[(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b "+(u().infoRow||""),children:[(0,r.jsx)("label",{className:"jsx-b83f427d8620324b",children:"Title:"}),(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b",children:[y&&(0,r.jsx)("div",{className:"jsx-b83f427d8620324b",children:(0,r.jsx)("b",{className:"jsx-b83f427d8620324b "+(u().hasError||""),children:"The field is required"})}),(0,r.jsx)("div",{className:"jsx-b83f427d8620324b",children:(0,r.jsx)("input",{value:b,onChange:function(e){p(e)},type:"text",className:"jsx-b83f427d8620324b"})})]})]}),(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b "+(u().infoRow||""),children:[(0,r.jsx)("label",{className:"jsx-b83f427d8620324b",children:"Target:"}),(0,r.jsx)("div",{className:"jsx-b83f427d8620324b",children:(0,r.jsxs)("select",{value:k,onChange:function(e){S(e.target.value)},className:"jsx-b83f427d8620324b",children:[Object.keys(fe).map((function(e){return(0,r.jsx)("option",{value:e,className:"jsx-b83f427d8620324b",children:"[".concat(e," PAGE]")},e)})),(0,r.jsx)("option",{value:"",className:"jsx-b83f427d8620324b",children:"Custom link"})]})})]}),""==k&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b "+(u().infoRow||""),children:[(0,r.jsx)("label",{className:"jsx-b83f427d8620324b",children:"Href (URL):"}),(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b",children:[B&&(0,r.jsx)("div",{className:"jsx-b83f427d8620324b",children:(0,r.jsx)("b",{className:"jsx-b83f427d8620324b "+(u().hasError||""),children:"The field is required"})}),(0,r.jsx)("div",{className:"jsx-b83f427d8620324b",children:(0,r.jsx)("input",{type:"text",value:F,onChange:function(e){I(e)},className:"jsx-b83f427d8620324b"})})]})]}),(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b "+(u().infoRow||""),children:[(0,r.jsx)("label",{className:"jsx-b83f427d8620324b"}),(0,r.jsx)("div",{className:"jsx-b83f427d8620324b",children:(0,r.jsxs)("label",{className:"jsx-b83f427d8620324b",children:[(0,r.jsx)("input",{type:"checkbox",checked:D,onChange:function(e){L(!D)},className:"jsx-b83f427d8620324b"}),(0,r.jsx)("span",{className:"jsx-b83f427d8620324b",children:"Open in new tab"})]})})]})]}),(0,r.jsxs)("div",{className:"jsx-b83f427d8620324b "+(u().actionsRow||""),children:[(0,r.jsx)("button",{onClick:H,className:"jsx-b83f427d8620324b "+(u().adminButton||""),children:d?"Edit":"Add"}),(0,r.jsx)("button",{onClick:W,className:"jsx-b83f427d8620324b "+(u().adminButton||""),children:"Cancel"})]})]})})})]}),(0,r.jsx)("div",{className:u().actionsRowMain,children:(0,r.jsx)(E,{chainId:"STORAGE",icon:"save",className:u().adminMainButton,disabled:V,onClick:U,action:"Save changes",children:V?"Saving...":"Save to storage config"})})]})}}}var ve,be,je=function(){var e=(0,s.Z)(o().mark((function e(n){var t,s,a,i,r,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.symbol,s=n.vsCurrency,e.prev=1,e.next=5,fetch("".concat("https://noxon.wpmix.net/cursAll.php","?fiat=").concat(s,"&tokens=").concat(t)).then((function(e){return e.json()}));case 5:return r=e.sent,c=null===r||void 0===r||null===(a=r.data)||void 0===a||null===(i=a.find)||void 0===i?void 0:i.call(a,(function(e){return(null===e||void 0===e?void 0:e.symbol)===t})),e.abrupt("return",c.quote[s].price);case 10:return e.prev=10,e.t0=e.catch(1),console.group("%c getPrice","color: red;"),console.error(e.t0),console.groupEnd(),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n){return e.apply(this,arguments)}}(),ge=function(){var e=(0,s.Z)(o().mark((function e(n){var t,s,a,i,r,c,l,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.provider,s=n.from,a=n.to,i=n.amount,r=n.onHash,c=void 0===r?function(){}:r,l=n.data,d={from:s,to:a,value:te.vz(String(i),"ether").toHexString(),data:l},e.prev=2,e.next=5,t.eth.sendTransaction(d).on("transactionHash",(function(e){return c(e)}));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),console.group("%c send","color: red;"),console.error(e.t0),console.groupEnd(),e.t0;case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(n){return e.apply(this,arguments)}}(),pe={LOTTERY_OFF_COPYRIGTH:{title:"LotteryFactory - Disable copyright",desc:"LotteryFactory - Disables copyright of OnOut",price:.1,chainId:56,product:"LotteryFactory",include_packs:[]},LOTTERY_FULL_VERSION:{title:"LotteryFactory - Full version",desc:"LotteryFactory - Full version. Disabled copyright of OnOut. Onout commission disabled",price:1500,isUSDT:!0,chainId:[1,56],product:"LotteryFactory",include_packs:["LOTTERY_OFF_COPYRIGTH"]}},ye=t(34360),we=t(8433);!function(e){e[e.danger=1]="danger",e[e.success=2]="success",e[e.warning=3]="warning",e[e.attention=4]="attention",e[e.unimportant=5]="unimportant",e[e.voteIdea=6]="voteIdea",e[e.bonusFuel=7]="bonusFuel"}(ve||(ve={}));var ke=(be={},(0,v.Z)(be,ve.danger,"\u2b55"),(0,v.Z)(be,ve.success,"\ud83d\udfe2"),(0,v.Z)(be,ve.warning,"\ud83d\udd25"),(0,v.Z)(be,ve.attention,"\ud83d\udca5"),(0,v.Z)(be,ve.unimportant,"\ud83d\udca4"),(0,v.Z)(be,ve.voteIdea,"\ud83d\udc24"),(0,v.Z)(be,ve.bonusFuel,"\u26fd"),be),Ne=function(e){var n=e.msg,t=e.status,s=window.location.hostname||document.location.host;if("localhost"!==s){var a=["localhost"===s?"".concat(ke[ve.unimportant]," "):t&&ke[t]?"".concat(ke[t]," "):"","[".concat(s,"] "),n].join("");try{(0,we.Z)({url:"".concat("https://noxon.wpmix.net/counter.php","?msg=").concat(encodeURI(a),"&toonoutdev=1&version=2"),method:"post"}).catch((function(e){return console.error(e)}))}catch(i){console.error(i)}}};function Se(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,a=e.addNotify,i=e.getActiveChain,c=e.storageData,l=(e.getStorageData,i().activeChainId),d=(0,R.T_)(l),h=(0,j.useState)(""),f=h[0],m=h[1],x=(0,j.useState)(!1),v=x[0],b=x[1],g=(0,j.useState)(0),p=g[0],y=g[1],w=(0,j.useState)(0),k=w[0],S=w[1],C=(0,j.useState)(!1),T=C[0],F=C[1],I=(0,j.useState)(""),B=I[0],D=I[1],L=(0,j.useState)(!1),Z=L[0],_=L[1],P=(0,j.useState)(!1),W=P[0],M=P[1],H=function(){var e=(0,s.Z)(o().mark((function e(){var n,t,s,r,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i(),t=n.activeWeb3,s=n.activeAccount,a("Begin purchase... Confirm transaction"),_(!0),e.prev=3,Ne({msg:"Begin buy activate key ".concat(B," from ").concat(s),status:ve.attention}),e.next=7,ge({provider:t,from:s,to:"0x873351e707257C28eC6fAB1ADbc850480f6e0633",amount:k,onHash:function(e){a("Pay TX ".concat(e),"success")}});case 7:(null===(r=e.sent)||void 0===r?void 0:r.status)&&(Ne({msg:"Activation key bought ".concat(B," from ").concat(s),status:ve.success}),a("Successfull purchesed","success"),_(!1),b(!1),c=(0,ye.Z)(B,s),m(c),Y(!0),a("Your key ".concat(c,". Save it"),"success")),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(3),a("Fail purchase. ".concat(e.t0.message?e.t0.message:""),"error"),_(!1),M(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=(0,s.Z)(o().mark((function e(n){var t,s,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(n),t=pe[n],s=d.nativeCurrency.symbol,e.next=5,je({symbol:s,vsCurrency:"USD"});case 5:a=e.sent,t.isUSDT?(y(t.price),S(t.price/a),F(!1)):(S(t.price),y(t.price*a),F(!0)),Ne({msg:"Open buy key ".concat(n),status:ve.attention}),b(!0);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),V=(0,j.useState)(!1),U=V[0],Y=V[1],q=(0,j.useState)(!1),z=q[0],J=q[1],X=function(){$(f)?(Ne({msg:"Activate key ".concat(f),status:ve.attention}),t({title:"Activating license key",message:"Activate license key?",onConfirm:function(){J(!0),n({onBegin:function(){a("Confirm transaction")},onReady:function(){J(!1),a("Key activated","success"),Y(!1),m("")},onError:function(e){J(!1),a("Fail activate key. ".concat(e.message?e.message:""),"error")},newData:{licenseKeys:(0,Q.Z)(null===c||void 0===c?void 0:c.licenseKeys).concat([f])}})}})):a("You entered an invalid activation key","error")},$=function(e){var n=i().activeAccount,t=Object.keys(pe).filter((function(e){return(0,ye.Z)(e,n)==f}));return t.length>0};return{render:function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:u().adminForm,children:[(0,r.jsx)("div",{className:u().adminSectionDescription,children:"Attention. The activation key will be linked to your active wallet. If you lose access to your wallet, we will not be able to restore your purchase."}),(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"Activating an existing purchase key"}),(0,r.jsxs)("div",{className:u().subForm,children:[(0,r.jsxs)("div",{className:u().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:u().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:'If you already have an activation key. Specify it in this field and click "Activate"'})]}),"Purchase key:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"text",value:f,onChange:function(e){m(e.target.value)}})})})]}),(0,r.jsx)("div",{className:u().actionsRow,children:(0,r.jsx)(E,{chainId:"STORAGE",onClick:X,disabled:z,icon:"receipt",action:"Active key",className:u().adminButton,children:z?"Key activation...":"Activate key"})})]})]}),(0,r.jsxs)("div",{className:u().subFormInfo,children:[(0,r.jsx)("h3",{children:"Purchasing a product activation key"}),(0,r.jsxs)("div",{className:"jsx-a34ffd9bc7fe9e6a PurchaseKeys",children:[(0,r.jsx)(A(),{id:"a34ffd9bc7fe9e6a",children:".PurchaseKeys.jsx-a34ffd9bc7fe9e6a{}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a{margin:10px;padding:4px;border:1px solid#fff;-webkit-box-shadow:0 0 2px 2px#4f5760;-moz-box-shadow:0 0 2px 2px#4f5760;box-shadow:0 0 2px 2px#4f5760;background:#403f3f}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a .title.jsx-a34ffd9bc7fe9e6a{font-size:12pt;font-weight:bold;border-bottom:1px solid#fff;padding:4px;text-shadow:1px 1px black,-1px 1px black,1px -1px black,-1px -1px black}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a .desc.jsx-a34ffd9bc7fe9e6a{padding:15px;font-size:10pt}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a .buyHolder.jsx-a34ffd9bc7fe9e6a{padding:4px;border-top:1px solid#fff;text-align:right}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a .buyHolder.jsx-a34ffd9bc7fe9e6a STRONG.jsx-a34ffd9bc7fe9e6a{color:#64d31f}"}),Object.keys(pe).map((function(e){var n=(0,G.Z)(e,c);return(0,r.jsxs)("div",{className:"jsx-a34ffd9bc7fe9e6a card",children:[(0,r.jsx)("div",{className:"jsx-a34ffd9bc7fe9e6a title",children:pe[e].title}),(0,r.jsx)("div",{className:"jsx-a34ffd9bc7fe9e6a desc",children:pe[e].desc}),(0,r.jsx)("div",{className:"jsx-a34ffd9bc7fe9e6a buyHolder",children:n?(0,r.jsxs)("strong",{className:"jsx-a34ffd9bc7fe9e6a",children:[(0,r.jsx)(N,{icon:"circle-check"})," ","You already got it"]}):(0,r.jsx)(E,{chainId:pe[e].chainId,onClick:function(){K(e)},disabled:!1,icon:"money-check-dollar",action:"Buy",className:u().adminButton,children:"Buy an activation key"})})]},e)}))]})]})]}),(0,r.jsx)(O,{isOpened:v,hasClose:!0,onClose:function(){b(!1)},title:"Payment for an activation key",children:(0,r.jsxs)("div",{className:"jsx-8b00dd331cd61514 buyKeyModal",children:[(0,r.jsx)(A(),{id:"8b00dd331cd61514",children:".buyKeyModal.jsx-8b00dd331cd61514{padding:10px}.buyKeyModal.jsx-8b00dd331cd61514 A.jsx-8b00dd331cd61514{display:block;padding:5px;color:#abd4ff;font-weight:bold}.buyKeyModal.jsx-8b00dd331cd61514 A.jsx-8b00dd331cd61514:hover{color:#fff}"}),(0,r.jsx)("p",{className:"jsx-8b00dd331cd61514",children:"You can use this links to buy crypto with a bank card:"}),(0,r.jsxs)("a",{href:"https://changelly.com/buy/".concat(d.nativeCurrency.symbol),target:"_blank",rel:"noreferrer",className:"jsx-8b00dd331cd61514 link paymentLink",children:["Buy ",d.nativeCurrency.symbol," on Changelly"]}),(0,r.jsxs)("a",{href:"https://www.binance.com/en/buy-".concat(d.nativeCurrency.binancePurchaseKey||d.nativeCurrency.symbol),target:"_blank",rel:"noreferrer",className:"jsx-8b00dd331cd61514 link paymentLink",children:["Buy ",d.nativeCurrency.symbol," on Binance"]}),(0,r.jsx)("p",{className:"jsx-8b00dd331cd61514 notice",children:"The price may vary slightly"}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("p",{className:"jsx-8b00dd331cd61514 warning",children:"Do not leave this page until successful payment. If you have any problems with the payment, please contact us."})}),W&&(0,r.jsxs)("p",{className:"jsx-8b00dd331cd61514 error",children:["Error: ",W]}),(0,r.jsxs)("button",{disabled:Z,onClick:H,className:"jsx-8b00dd331cd61514 "+(u().adminButton||""),children:[(0,r.jsx)(N,{icon:"money-check-dollar"}),T?(0,r.jsx)(r.Fragment,{children:"Buy for ".concat(k," ").concat(d.nativeCurrency.symbol," (~$").concat(Number(p).toFixed(2),") ")}):(0,r.jsx)(r.Fragment,{children:"Buy for $".concat(p," (~").concat(k," ").concat(d.nativeCurrency.symbol,") ")})]})]})}),(0,r.jsx)(O,{isOpened:U,title:"Key activation",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"jsx-e9ded62631f7a3b0 activateKeyBox",children:[(0,r.jsx)(A(),{id:"e9ded62631f7a3b0",children:".activateKeyBox.jsx-e9ded62631f7a3b0{text-align:center;padding:10px}.activateKeyBox.jsx-e9ded62631f7a3b0 STRONG.jsx-e9ded62631f7a3b0{display:block;padding:10px;margin:10px;border:1px solid#262936;-webkit-box-shadow:inset 0 0 7px 1px black;-moz-box-shadow:inset 0 0 7px 1px black;box-shadow:inset 0 0 7px 1px black;color:#000;background:#fff}"}),(0,r.jsx)("span",{className:"jsx-e9ded62631f7a3b0",children:"You have successfully made a payment. Now you need to save your activation key"}),(0,r.jsx)("strong",{className:"jsx-e9ded62631f7a3b0",children:f}),(0,r.jsx)(E,{chainId:"STORAGE",onClick:X,disabled:z,icon:"receipt",action:"Active key",className:u().adminButton,children:z?"Key activation...":"Activate key"})]})})})]})}}}var Ce=t(94360),Te=t(84575),Fe=function(e){return new Promise((function(n){window.setTimeout((function(){n()}),e)}))},Ie={main:"Main settings",gamerules:"Rules",lotterybank:"Lottery Bank",rounds:"Rounds",texts:"Edit texts",menu:"Menu",design:"Design",license:"License"},Ae=(function(){var e=Object.keys(R.w5).map((function(e){return{id:R.w5[e].networkVersion,title:R.w5[e].chainName}}));e.unshift({id:0,title:"Select Blockchain"})}(),function(e){var n=(0,D.n)(),t=n.storageChainId,i=n.storageAddress,l=e.storageData,d=(e.storageIsLoading,e.isOwner),h=e.openConfirmWindow,f=e.addNotify,m=e.setDoReloadStorage,v=e.setDoReloadStorageFast,b=e.storageTexts,g=e.storageDesign,p=e.iframeHideMenu,y=e.storageMenu,w=(0,j.useState)(!1),k=w[0],N=w[1],S=(0,j.useState)(!1),C=S[0],T=S[1],F=(0,j.useState)(!1),I=F[0],A=F[1],O=(0,j.useState)(!1),E=O[0],Z=O[1],_=function(e,n){var t=!1;try{t=e.message.replace("Internal JSON-RPC error.",""),t=JSON.parse(t)}catch(s){}switch(t&&t.message?t.message:e.message){case"execution reverted: You don't own this token!":console.log("You dont own this token");break;case"MetaMask Tx Signature: User denied transaction signature.":console.log("Transaction denied");break;case"execution reverted: ERC721: invalid token ID":console.log("Invalid token ID");break;default:console.log("Unkrnown error",e.message)}};window.activeWeb3=C;var P=function(e){N(e)},W=function(){var e=(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!C||"".concat(k)!="".concat(t)){e.next=4;break}C.eth.getAccounts().then((function(e){A(e[0]);var n=new C.eth.Contract(Ce.Mt,i);V(n)})).catch((function(e){console.log(">>> initOnWeb3Ready",e),_(e)})),e.next=8;break;case 4:return e.next=6,(0,B.IC)();case 6:e.sent&&M();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,j.useEffect)((function(){var e;e="on useEffect activeWeb3 initOnWeb3Ready",console.log(e),W()}),[C]);var M=function(){var e=(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,B.pE)({onBeforeConnect:function(){Z(!0)},onSetActiveChain:N,onConnected:function(e,n){T(n),(0,B.uK)(P),Z(!1)},onError:function(e){console.log(">>>> connectWithMetamask",e),_(e),Z(!1)},needChainId:t});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=(0,j.useState)(!1),K=H[0],V=H[1],G=(0,j.useState)(!1),U=G[0],q=G[1],J=function(){var e=(0,s.Z)(o().mark((function e(n){var i,r,d,u,m,x,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.onBegin,r=n.onReady,d=n.onError,u=n.newData,!U){e.next=4;break}return f("Storage already saving...","error"),e.abrupt("return");case 4:m=(0,a.Z)({},l,u),x=function(){var e=(0,s.Z)(o().mark((function e(){var n,t,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!I||!K){e.next=23;break}return f("Saving config to storage. Confirm transaction"),q(!0),i&&i(),n=m,e.prev=5,e.next=8,(0,ee.A)(I,K,"setKeyData",[(0,Te.Z)(),{owner:I,info:JSON.stringify(n)}]);case 8:return t=e.sent,e.next=11,C.eth.getGasPrice();case 11:s=e.sent,t.gasPrice="0x"+new c.BigNumber(s).toString(16),K.methods.setKeyData((0,Te.Z)(),{owner:I,info:JSON.stringify(n)}).send(t).then((function(){q(!1),v(!0),r&&r()})).catch((function(e){console.log(">>> error",e),q(!1),d&&d(e)})),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(5),console.log(">>> error",e.t0),q(!1),d&&d(e.t0);case 21:e.next=24;break;case 23:f("Fail save storage. No active wallet or contract not ready yet","error");case 24:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(){return e.apply(this,arguments)}}(),console.log(">> do save",(0,B.BV)()!==t,(0,B.BV)(),t),(0,B.BV)(t)?x():(b=(0,R.T_)(t),h({title:"Need change active chain for save main config",message:"Please change network Storage chain (".concat(b.chainName,")"),onConfirm:(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f("Switching to Storage chain"),e.next=3,(0,B.M5)(t);case 3:return e.next=5,Fe(2e3);case 5:x();case 6:case"end":return e.stop()}}),e)}))),okLabel:"Switch"}));case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),X=l&&!l.isInstalled,$=(0,j.useState)(!X),Q=$[0],ne=$[1],te=(0,j.useState)(!1),se=te[0],ae=te[1],ie=(0,j.useState)("main"),re=ie[0],le=ie[1],ue=(0,j.useState)((null===l||void 0===l?void 0:l.chainId)||0),he=(ue[0],ue[1]);(0,j.useEffect)((function(){l&&he(l.chainId)}),[l]);var fe=function(){var e=(0,R.T_)(k),n=(0,R.T_)(t);return(0,r.jsxs)("div",{className:u().adminActiveChainInfo,children:[(0,r.jsxs)("span",{children:["Current active network is ",(0,r.jsxs)("b",{children:[(null===e||void 0===e?void 0:e.chainName)||"Unknown"," (",k,")"]})]}),(0,r.jsxs)("span",{children:["Main config storage network is ",(0,r.jsxs)("b",{children:[(null===n||void 0===n?void 0:n.chainName)||"Unknown"," (",t,")"]})]})]})},me={setDoReloadStorage:m,setDoReloadStorageFast:v,saveStorageConfig:J,openConfirmWindow:h,addNotify:f,getActiveChain:function(){return{activeAccount:I,activeChainId:k,activeWeb3:C}},storageChainId:t,storageData:l,getStorageData:function(){return l},storageDesign:g,storageTexts:b,storageMenu:y},be=new Y(me),je=new z(me),ge=new oe(me),pe=new ce(me),ye=new L(me),we=new de(me),ke=new Se(me),Ae=new xe(me);return Q&&(X=!1),(0,r.jsxs)("div",{className:u().container,children:[!p&&x("settings",!0),(0,r.jsx)("h1",{className:u().h1,children:"Settings"}),null!==l&&(0,r.jsx)(r.Fragment,{children:X?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:"App needs to be installed on this domain"}),I?(0,r.jsxs)(r.Fragment,{children:[fe(),(0,r.jsx)("button",{disabled:se,className:"".concat(u().mainButton," ").concat(u().autoWidth," primaryButton"),onClick:function(){Ne({msg:"Installing lottery from ".concat(I),status:ve.attention}),J({onBegin:function(){ae(!0),f("Confirm transaction for setup Lottery on this domain")},onReady:(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ae(!1),ne(!0),f("Lottery successfull installed on this domain. Now you can configure farm","success"),m(!0),Ne({msg:"Lottery installed at domain (".concat(I,")"),status:ve.attention});case 5:case"end":return e.stop()}}),e)}))),onError:function(e){ae(!1),f("Fail setup Lottery on domain","error")},newData:{isInstalled:!0}})},children:se?"Setup on domain...":"Setup Lottery on this domain"})]}):(0,r.jsx)("button",{disabled:E,className:"".concat(u().mainButton," primaryButton"),onClick:M,children:E?"Connecting":"Connect Wallet"})]}):(0,r.jsx)(r.Fragment,{children:I?(0,r.jsx)(r.Fragment,{children:d?(0,r.jsxs)(r.Fragment,{children:[fe(),(0,r.jsx)("ul",{className:u().settingsTabsNav,children:Object.keys(Ie).map((function(e){return(0,r.jsx)("li",{onClick:function(){le(e)},className:e===re?u().activeTab:"",children:Ie[e]},e)}))}),(0,r.jsx)("hr",{className:"".concat(u().divider," ").concat(u().spacerTop)}),"main"===re&&be.render(),"gamerules"===re&&je.render(),"lotterybank"===re&&we.render(),"rounds"===re&&ge.render(),"texts"===re&&pe.render(),"design"===re&&ye.render(),"license"===re&&ke.render(),"menu"===re&&Ae.render()]}):(0,r.jsx)("h2",{children:"Access denied"})}):(0,r.jsx)("button",{disabled:E,className:"".concat(u().mainButton," primaryButton"),onClick:M,children:E?"Connecting":"Connect Wallet"})})})]})})}},function(e){e.O(0,[976,94,774,888,179],(function(){return n=52837,e(e.s=n);var n}));var n=e.O();_N_E=n}]);