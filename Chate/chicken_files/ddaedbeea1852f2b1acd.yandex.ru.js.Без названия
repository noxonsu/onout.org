(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([["map-widget-app","map-widget-panorama-player-banner"],{8696:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(7462),o=n(4578),i=n(7363),a=n(1091),s=n(834),c=n(348),l=n(8285),u={angle:"dropdown-16",triangle:"arrow-down-8"},d=(0,s.Z)("button"),p=function(e){function t(t){var n;return(n=e.call(this,t)||this)._ref=i.createRef(),n._onMouseEnter=function(e){n.props.title&&!n.state.hideTitle&&n.setState({hideTitle:!0}),n.props.onMouseEnter&&n.props.onMouseEnter(e)},n._onMouseDown=function(e){n.props.disabled||(n.setState({pressed:Boolean(n.props.onClick)}),n.props.onMouseDown&&n.props.onMouseDown(e))},n._onMouseUp=function(){n.setState({pressed:!1})},n._onMouseOut=function(){n.setState({pressed:!1})},n._onFocus=function(){var e=n.props.forwardedRef,t=void 0===e?n._ref:e;if(n.state.pressed){var r=t.current;r&&r.blur()}},n._renderLink=function(e,t){var o=n.props,a=o.disabled,s=o.url,c=o.rel,l=o.target,u=o.forwardedRef,d=void 0===u?n._ref:u;return i.createElement("a",(0,r.Z)({href:a?void 0:s,role:"button",target:l||"_parent","aria-disabled":!!a||void 0,ref:d,rel:c},e),t)},n._renderButton=function(e,t){var o=n.props,a=o.disabled,s=o.type,c=void 0===s?"button":s,l=o.forwardedRef,u=void 0===l?n._ref:l;return i.createElement("button",(0,r.Z)({disabled:a,type:c,ref:u},e),t)},n._renderIcon=function(e){var t=n.props;return i.createElement("span",{key:"icon",className:e("icon"),style:{width:t.iconWidth},"aria-hidden":!0},t.icon)},n._renderTick=function(e){var t=u[n.props.tick];return i.createElement(c.Z,{name:t,key:"tick",className:e("tick"),inline:!0})},n.state={pressed:!1,hideTitle:!1},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e,t=this.props,n=[t.icon?this._renderIcon(d):null,t.children?i.createElement("span",{key:"text",className:d("text")},t.children):null,t.tick?this._renderTick(d):null],o=t.ariaHidden?l.x:{"aria-haspopup":void 0!==t.ariaExpanded,"aria-expanded":t.ariaExpanded,"aria-label":t.children?void 0:t.ariaLabel},a=(0,r.Z)({className:d({view:t.view,ui:(e=t.view,!["air","air-alt","air-round","search"].includes(e)),size:t.size,link:Boolean(t.url),disabled:t.disabled,checked:t.checked,static:t.static,"pin-left":t.pinLeft,"pin-right":t.pinRight,"pin-top":t.pinTop,"pin-bottom":t.pinBottom,pressed:this.state.pressed||t.pressed,tick:t.tick,stretched:t.isStretched,"text-align-left":t.isTextAlignLeft,"flipped-tick":t.flippedTick,hovered:t.hovered,focused:t.focused,"no-shadow":t.noShadow,truncated:t.truncated,"dark-theme-only":t.darkThemeOnly}),title:this.state.hideTitle?void 0:t.title,"aria-pressed":this.state.pressed||t.pressed,itemProp:t.itemProp,onMouseEnter:this._onMouseEnter,onMouseLeave:t.onMouseLeave,onClick:t.disabled?void 0:t.onClick,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onMouseOut:this._onMouseOut,onFocus:this._onFocus},o);return t.url?this._renderLink(a,n):this._renderButton(a,n)},t}(i.Component);const m=(0,a.Z)(p)},724:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(4578),o=n(7462),i=n(7363),a=n(1533),s=[],c=function(e,t){var n=e.target,r=t.node,o=t.callback,i=t.stopPropagation,a=t.getExcludedNodes;if(d(r,n))return!i;var s=a&&a();if(s){var c=(s=Array.isArray(s)?s:[s]).some((function(e){return d(e,n)}));if(c)return!i}return o(e),!i},l=function(e){for(var t=s.length-1;t>=0;t--){if(!c(e,s[t]))break}},u=function(e,t){0===s.length&&(window.document.addEventListener("mousedown",l,!0),window.document.addEventListener("touchstart",l,{capture:!0,passive:!1}));var n=(0,o.Z)({node:e},t);return s.push(n),function(){return e=n,void(0===(s=s.filter((function(t){return e!==t}))).length&&(window.document.removeEventListener("mousedown",l,!0),window.document.removeEventListener("touchstart",l,!0)));var e}};function d(e,t){return e===t||e.contains(t)}const p=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._unsubscribe=void 0,t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.callback,n=e.stopPropagation,r=e.getExcludedNodes,o=a.findDOMNode(this);o instanceof Element&&(this._unsubscribe=u(o,{callback:t,stopPropagation:n,getExcludedNodes:r}))},n.componentWillUnmount=function(){this._unsubscribe()},n.render=function(){return i.Children.only(this.props.children)},t}(i.Component)},3812:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(7462),o=n(7363),i=n(834),a=n(348),s=n(9845),c=n(4467),l=n(4837),u=n(6204),d=(0,i.Z)("close-button"),p={close:{small:"close-16",medium:"close-24"},cross:{small:"cross-16",medium:"cross-16"}};const m=function(e){var t=e.color,n=void 0===t?"black":t,i=e.offset,m=void 0===i?"small":i,f=e.size,v=void 0===f?"medium":f,h=e.onClick,g=e.circle,y=e.relative,_=e.usePortal,b=(0,c.ZR)(),E=o.createRef(),w=(0,l.p)({ref:E}),S="string"!=typeof m?{top:m.top,right:m.right}:{},C=o.createElement("button",(0,r.Z)({type:"button","aria-label":"Закрыть",className:d({color:n,circle:g,relative:y,size:"string"==typeof v?v:void 0,offset:"string"==typeof m?m:void 0}),onClick:h,style:(0,u.cq)(b,S),ref:E},w),o.createElement(a.Z,{inline:!0,name:p[g?"close":"cross"][v]}));return _?o.createElement(s.Z,{selector:".body"},C):C}},3907:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>u,v6:()=>s,KE:()=>l});var r=n(7363);function o(){}var i=(0,n(5369).Z)("flyover",{isFlyoverActive:!1,isLayerInitialized:!1,setLayerInitialized:o,setFlyoverActive:o}),a=i.connect,s=i.Provider,c=i.Context;function l(){return r.useContext(c)}const u=a},1745:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(4578),o=n(7363),i=n(1533),a=n(834);const s=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){return this.props.children},t}(o.PureComponent);var c=n(2151),l=n(4467),u=(0,a.Z)("hover-hint"),d=function(e){function t(t){var n;return(n=e.call(this,t)||this)._target=null,n._showTimerId=0,n._hide=function(){window.clearTimeout(n._showTimerId),n._showTimerId=0,n.setState({isShown:!1})},n._onPopupClose=function(){n._hide()},n._onMouseEnter=function(){n._showTimerId||n.props.isDisabled||(n._showTimerId=window.setTimeout((function(){return n.setState({isShown:!0})}),n.props.delay||200))},n._onMouseLeave=function(){n._hide()},n._onClick=function(){void 0===n.props.hideOnClick||n.props.hideOnClick?n._hide():n.props.config.uatraits.isMobile&&n._onMouseEnter()},n._renderPopup=function(){var e=n.props,t=e.isAir?"air":"help",r=Boolean(!e.isDisabled&&(n.state.isShown||e.force));return o.createElement(c.Z,{isShown:r,position:e.position,offset:e.offset,type:t,onScroll:e.onScroll||"reposition",getTarget:function(){return n._target||null},onClose:n._onPopupClose,className:e.className,showArrow:e.showArrow,arrowOffset:e.arrowOffset},o.createElement("div",{className:u({type:t,size:e.size||"m"})},e.text))},n.state={isShown:Boolean(t.isInitialShown)},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._target&&(this._target.addEventListener("mouseenter",this._onMouseEnter),this._target.addEventListener("mouseleave",this._onMouseLeave),this._target.addEventListener("click",this._onClick))},n.componentWillUnmount=function(){this._target&&(this._target.removeEventListener("mouseenter",this._onMouseEnter),this._target.removeEventListener("mouseleave",this._onMouseLeave),this._target.removeEventListener("click",this._onClick)),window.clearTimeout(this._showTimerId),this._showTimerId=0},n.componentDidUpdate=function(e){!e.isDisabled&&this.props.isDisabled&&this.state.isShown&&(window.clearTimeout(this._showTimerId),this._showTimerId=0,this.setState({isShown:!1}))},n.render=function(){var e=this,t=this.props;return t.config.uatraits.isMobile&&!t.isNeededOnMobile?t.children:o.createElement(o.Fragment,null,o.createElement(s,{ref:function(t){return e._target=t?i.findDOMNode(t):null}},t.children),this._renderPopup())},t}(o.Component);const p=(0,l.ZP)(d)},348:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(7462),o=n(7363),i=n(4467),a=n(2713),s=["pin-alerts-closed-future","pin-alerts-cross-road-control","pin-alerts-drawbridge-future","pin-alerts-lane-control","pin-alerts-mobile-control","pin-alerts-no-stopping-control","pin-alerts-reconstruction","pin-alerts-speed-bump","pin-alerts-speed-camera","poi-alerts-closed-future-24","poi-alerts-closed-future-32","poi-alerts-closed-future-40","poi-alerts-cross-road-control-26","poi-alerts-cross-road-control-32","poi-alerts-cross-road-control-40","poi-alerts-drawbridge-future-24","poi-alerts-drawbridge-future-32","poi-alerts-drawbridge-future-40","poi-alerts-lane-control-26","poi-alerts-lane-control-32","poi-alerts-lane-control-40","poi-alerts-mobile-control-26","poi-alerts-mobile-control-32","poi-alerts-mobile-control-40","poi-alerts-no-stopping-control-24","poi-alerts-no-stopping-control-32","poi-alerts-no-stopping-control-40","poi-alerts-road-reconstruction-24","poi-alerts-road-reconstruction-32","poi-alerts-road-reconstruction-40","poi-alerts-speed-bump-24","poi-alerts-speed-bump-32","poi-alerts-speed-bump-40","poi-alerts-speed-camera-24","poi-alerts-speed-camera-32","poi-alerts-speed-camera-40","rubrics-medical-48","settings-speed-limit-highways-64x52","settings-speed-limit-single-carriageway-64x52","settings-speed-limit-within-towns-64x52","settings-speedlimit-city-in","settings-speedlimit-city-out","settings-speedlimit-highway","sound-off-24"],c=["camera2d-on-40","camera3d-on-40","carplay-aa-lockscreen-glyph","carplay-dash-continue-40","carplay-dash-phone-40","carplay-home-40","carplay-search-my-places-40","carplay-start-route-40","carplay-work-40","checkbox-on-24","child-seat-selected-day-24","child-seat-selected-night-24","cp-dashboard-location-32","cp-dashboard-not-working-32","cp-dashboard-phone-32","done-36","envelope-36","filters-select-24-flip","gas-48","layers-on-24","layers-on-40","loader-progress-100","loader-progress-25","loader-progress-50","loader-progress-75","location-center-40","location-navigate-center-40","map-placemark-compass-64","map-placemark-dot-32","mark-actual-24","mark-actual-superscript-12","navimark-48","overview-route-ferry","panorama-on-40-flip","parking-32","parking-on-40","radio-on-24","search-category-24","tab-navigator","tab-taxi-flip","tab-transport-flip","thanks-32-flip","transit-marker-region-24","transit-on-40","warning-36"];var l=n(2441);const u=function(e){var t=(0,i.ZR)(),n=function(e,t){var n="dark"===e.theme?"_night":"",r=e.name.split("."),o=r[0],i=r[1],a=void 0===i?"svg":i,l=(t.isYango&&c.includes(o)?"yangomaps-":"")+o+(t.isRtl&&s.includes(o)?"_rtl":"")+n+"."+a;return t.staticHost+"static/v39/icons/core/"+l}({name:e.name,theme:e.theme},t),u=new RegExp("^.*?(?:-(\\d+))?(?:x(\\d+))?(?:-no-gradient)?(?:-flip)?$").exec(e.name),d=e.name.split("."),p=d[0],m=d[1],f=void 0===m?"svg":m,v=null!=u&&u[1]?Number(u[1]):void 0,h=null!=u&&u[2]?Number(u[2]):v,g=(0,l.h)({callback:e.onClick}),y=(0,r.Z)({},e.style,{transform:t.isRtl&&p.endsWith("-flip")?"scaleX(-1)":void 0});return e.inline&&"svg"===f?o.createElement(a.Z,{url:n,ariaLabel:e.onClick?e.ariaLabel:void 0,className:e.className,onClick:e.onClick,style:y,"aria-hidden":e.ariaHidden||!e.onClick},"function"==typeof e.inline?e.inline:void 0):o.createElement("img",(0,r.Z)({},g,{"aria-hidden":e.ariaHidden||!e.onClick,alt:e.onClick?e.ariaLabel:void 0,src:n,className:e.className,onClick:e.onClick,style:(0,r.Z)({},y,{width:v,height:h})}))}},2151:(e,t,n)=>{"use strict";n.d(t,{Z:()=>T});var r=n(7462),o=n(7326),i=n(4578),a=n(7363),s=n(834),c=n(9845),l=n(724),u=n(6021),d=n(2327),p=["INPUT","SELECT","TEXTAREA"],m=[],f=function(e,t){var n=e.keyCode,r=e.target.tagName,o=t.handlers,i=t.stopPropagation,a=o.find((function(e){return e.key===n})),s=p.includes(r);return!a||!a.allowInEditable&&s?!(a||i):(a.callback(e),e.preventDefault(),!1)},v=function(e){for(var t=m.length-1;t>=0;t--){if(!f(e,m[t]))break}},h=function(e){e.keyCode!==d.n.PRINT_SCREEN&&v(e)},g=function(e){e.keyCode===d.n.PRINT_SCREEN&&v(e)},y=function(e,t){0===m.length&&(window.document.addEventListener("keydown",h),window.document.addEventListener("keyup",g));var n={handlers:e,stopPropagation:t};return m.push(n),function(){return e=n,void(0===(m=m.filter((function(t){return e!==t}))).length&&(window.document.removeEventListener("keydown",h),window.document.removeEventListener("keyup",g)));var e}};const _=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._unsubscribe=void 0,t}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.stopPropagation,n=e.handlers,r=Array.isArray(n)?n.slice():[n];this._unsubscribe=y(r,Boolean(t))},n.componentWillUnmount=function(){this._unsubscribe()},n.render=function(){return null},t}(a.Component);var b=n(4787),E=n(3454),w=n(3471),S=n(111),C=n(348),Z=(0,s.Z)("popup"),R={bottom:{vertical:!0,bottom:!0,center:!0},"bottom-right":{vertical:!0,bottom:!0,right:!0},"bottom-left":{vertical:!0,bottom:!0,left:!0},"right-bottom":{horizontal:!0,right:!0,bottom:!0},right:{horizontal:!0,right:!0,middle:!0},"right-top":{horizontal:!0,right:!0,top:!0},top:{vertical:!0,top:!0,center:!0},"top-right":{vertical:!0,top:!0,right:!0},"top-left":{vertical:!0,top:!0,left:!0},left:{horizontal:!0,left:!0,middle:!0},"left-bottom":{horizontal:!0,left:!0,bottom:!0},"left-top":{horizontal:!0,left:!0,top:!0}},P=[],k=function(e){function t(t){var n;return(n=e.call(this,t)||this)._arrow=void 0,n._popup=a.createRef(),n._popupSize=void 0,n._observer=void 0,n._repositionThrottled=void 0,n._getArrowDimensions=function(){if("tooltip"===n.props.type)return{diagonal:24,height:12};var e=n._arrow?10:0,t=Math.round(e*Math.sqrt(2));return{diagonal:t,height:t/2}},n._getPopupSize=function(){var e=n._popup.current.getBoundingClientRect(),t=n.props.getTarget(),r=n.props.isDropdown&&t?t.getBoundingClientRect().width:e.width;return{width:Math.round(r),height:Math.round(e.height)}},n._getTargetSize=function(){var e=n.props.getTarget();if(e instanceof HTMLElement)return{width:e.offsetWidth,height:e.offsetHeight};if(e&&"getBBox"in e){var t=e.getBBox();return{width:t.width,height:t.height}}return{width:0,height:0}},n._getTargetRect=function(){var e=n.props.getTarget();if(!e)return{top:0,right:0,bottom:0,left:0};var t=n._getTargetSize(),r=e.getBoundingClientRect(),o={top:r.top+I(),left:r.left+M()};return{top:o.top,right:o.left+t.width,bottom:o.top+t.height,left:o.left}},n._isTargetVisible=function(e,t){var r=t.top,o=t.right,i=t.bottom,a=t.left;if(!n.props.checkTargetVisibility)return!0;var s=a+(o-a)/2,c=r+(i-r)/2,l=window.document.elementFromPoint(s,c);return e.contains(l)},n._getPositions=function(){var e=Array.isArray(n.props.position)?n.props.position:[n.props.position||"bottom"];return"rtl"!==window.document.dir?e:e.map((function(e){return e.includes("left")?e.replace("left","right"):e.includes("right")?e.replace("right","left"):e}))},n._reposition=function(){var e=n.props,t=e.getTarget();if(e.isShown&&n._popup.current&&t){var r=n._getTargetRect();if(n._isTargetVisible(t,r)){var o=(e.offset?e.offset.main:0)+3,i=e.offset?e.offset.side:0,a=function(){var e=window.document.documentElement,t=M(),n=I(),r=e.clientWidth,o=e.clientHeight,i=Math.max(e.scrollHeight,o)-o;n>i&&(n=i);return{top:n,right:t+r,bottom:n+o,left:t}}(),s=n._getPopupSize(),c=n._getArrowDimensions(),l=!n._popupSize||n._popupSize.width!==s.width||n._popupSize.height!==s.height;n.props.onSizeChange&&l&&n.props.onSizeChange(s),n._popupSize=s;var u,d,p,m=-c.height,f=c.height/2,v=s.width*s.height,h=null,g=[];g=g.concat(n._getPositions()),e.restrictPosition||(g=g.concat(Object.keys(R)));for(var y=0;y<g.length;y++){var _=g[y],b=R[_],E={top:0,right:0,bottom:0,left:0},w={top:"auto",right:"auto",bottom:"auto",left:"auto"},S=void 0,C=e.arrowOffset||0,Z=(e.positionOffsets||{})[_]||{main:0,side:0};if(b.horizontal){b.left?(E.left=r.left-s.width-c.height-o+Z.main,w.right=m,S="left"):b.right&&(E.left=r.right+c.height+o+Z.main,w.left=m,S="right"),b.middle?E.top=(r.top+r.bottom-s.height)/2+i+Z.side:b.top?E.top=Math.max(r.bottom,(r.top+r.bottom+c.height)/2)+f-s.height-i+Z.side:b.bottom&&(E.top=Math.min(r.top,(r.top+r.bottom-c.height)/2)-f+i+Z.side);var P=(r.top+r.bottom-c.diagonal)/2-E.top+i+Z.side+C;w.top=Math.min(Math.max(0,P),s.height-c.diagonal)}else if(b.vertical){b.top?(E.top=r.top-s.height-c.height-o+Z.main,w.bottom=m,S="top"):b.bottom&&(E.top=r.bottom+c.height+o+Z.main,w.top=m,S="bottom"),b.center?E.left=(r.left+r.right-s.width)/2+i+Z.side:b.left?E.left=Math.max(r.right-s.width,(r.left+r.right+c.height)/2)+f-s.width-i+Z.side:b.right&&(E.left=Math.min(r.left,(r.left+r.right-c.height)/2)-f+i+Z.side);var k=(r.left+r.right-c.diagonal)/2-E.left+i+C+Z.side;w.left=Math.min(Math.max(0,k),s.width-c.diagonal)}E.bottom=E.top+s.height,E.right=E.left+s.width;var T=(u=E,d=a,p=void 0,p=Math.max(0,Math.min(u.right,d.right)-Math.max(u.left,d.left))*Math.max(0,Math.min(u.bottom,d.bottom)-Math.max(u.top,d.top)),Math.round(p));if(e.isMinLeftZero&&E.left<0&&b.vertical&&("number"==typeof w.left&&(w.left+=E.left),E.left=0),(!h||T>h.square)&&(h={popupPos:{left:E.left,top:E.top},arrowPos:w,square:T,mainPos:S}),T===v)break}var x=h.popupPos,L={left:Math.floor(x.left),top:Math.floor(x.top)};n.props.isDropdown&&(L.width=n._getTargetSize().width);var D=x.top>0?a.bottom-x.top:void 0;n.setState({style:L,arrowStyle:h.arrowPos,position:h.mainPos,maxContentHeight:e.skipMaxHeight?void 0:D,isShown:!0,isTargetVisible:!0})}else n.setState({isTargetVisible:!1})}},n._onClose=function(e,t){n.props.onClose&&n.props.onClose({reason:t,event:e})},n._onClickOutside=function(e){n.props.isShown&&n._onClose(e,"click-outside")},n._onWindowChange=function(e){n._applyScrollEvent(e)},n._onScroll=function(e,t){t&&n._applyScrollEvent(t)},n._applyScrollEvent=function(e){n.props.isShown&&(n.props.onScroll&&"reposition"!==n.props.onScroll?n._onClose(e,"scroll"):n._repositionThrottled())},n._onEsc=function(e){n.props.isShown&&n._onClose(e,"esc")},n._onShow=function(){P.includes((0,o.Z)(n))||n.props.ninjaMode||P.push((0,o.Z)(n));var e=n._getPopupSize();n.state.isShown&&n._popupSize.width===e.width&&n._popupSize.height===e.height||n._reposition()},n._onHide=function(){P=P.filter((function(e){return e!==(0,o.Z)(n)})),n.setState({style:{top:0,left:0},isShown:!1})},n._onHideEnd=function(){n._onHide(),n.props.onHideEnd&&n.props.onHideEnd()},n._getExcludedNodes=function(){var e=n.props,t=e.getExcludedNodes,r=e.hideOnTargetClick,o=e.getTarget,i=[],a=t&&t();a&&(i=i.concat(a));var s=r?null:o();return s&&(i=i.concat(s)),i},n._renderPopup=function(){var e=n.props,t=n.state,o=t.isTargetVisible&&t.isShown?"visible":"hidden",i=e.noPointerEvents?"none":"auto",s=(0,r.Z)({zIndex:e.zIndex,visibility:o,pointerEvents:i},t.style),c=e.type||"normal",l=Z({type:c,position:t.position,dropdown:e.isDropdown,"full-height":e.fullHeight})+(e.className?" "+e.className:""),u=t.maxContentHeight?{maxHeight:t.maxContentHeight}:{};return a.createElement("div",{className:l,style:s,ref:n._popup,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,role:"dialog"},void 0===e.showArrow||e.showArrow?a.createElement("div",{className:Z("arrow",{"arrow-type":e.arrowType}),style:t.arrowStyle,ref:function(e){return n._arrow=e||void 0}},"tooltip"!==c||e.arrowType?null:a.createElement(C.Z,{name:"tips-arrow-vertical-8",className:Z("arrow-icon"),inline:!0})):null,a.createElement("div",{className:Z("content",{"full-height":e.fullHeight}),style:u},e.children),e.repositionOnContentResize?a.createElement(b.Z,{onResize:n._repositionThrottled}):null,a.createElement(_,{handlers:{key:d.n.ESC,callback:n._onEsc,allowInEditable:!0}}))},n._repositionThrottled=(0,S.Z)(n._reposition,50),n.state={style:{top:0,left:0},arrowStyle:{top:"auto",right:"auto",bottom:"auto",left:"auto"},position:"bottom",isShown:!1,isTargetVisible:!t.checkTargetVisibility},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this._observer="IntersectionObserver"in window?new IntersectionObserver((function(){e._repositionThrottled()})):void 0,this.props.checkTargetVisibility&&this._repositionThrottled();var t=this.props.getTarget();t&&this._observer&&this._observer.observe(t)},n.componentDidUpdate=function(e){this.props!==e&&this.props.isShown&&this._repositionThrottled()},n.componentWillUnmount=function(){var e=this;P=P.filter((function(t){return t!==e})),this._repositionThrottled.cancel(),this._observer&&this._observer.disconnect()},n.render=function(){return a.createElement(c.Z,null,a.createElement(w.Z,{animationRef:this._popup,onShow:this._onShow,onHideEnd:this._onHideEnd},this.props.isShown?a.createElement(l.Z,{callback:this._onClickOutside,getExcludedNodes:this._getExcludedNodes},this._renderPopup()):null),a.createElement(u.Z,{type:"resize",listener:this._onWindowChange,options:!0}),a.createElement(E.Z,{eventHandler:this._onScroll,throttleWait:0}),a.createElement(u.Z,{type:"orientationchange",listener:this._onWindowChange,options:!0}),a.createElement(u.Z,{type:"layout-change",listener:this._onWindowChange}))},t}(a.Component);function I(){return window.document.documentElement.scrollTop||window.document.body.scrollTop}function M(){return window.document.documentElement.scrollLeft||window.document.body.scrollLeft}k.isShown=function(){return P.length>0};const T=k},9845:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(4578),o=n(7363),i=n(1533);const a=function(e){function t(t){var n;return(n=e.call(this,t)||this)._getContainer=function(){var e=n.props;return e.containerRef?e.containerRef.current||void 0:e.selector?window.document.querySelector(e.selector)||void 0:window.document.body},n._updateContainer=function(){var e=n._getContainer();e!==n.state.container&&n.setState({container:e})},n.state={},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._updateContainer()},n.componentDidUpdate=function(e){var t,n;(null===(t=e.containerRef)||void 0===t?void 0:t.current)===(null===(n=this.props.containerRef)||void 0===n?void 0:n.current)&&e.selector===this.props.selector&&e.children===this.props.children||this._updateContainer()},n.render=function(){var e=this.state;return e.container?i.createPortal(this.props.children,e.container):null},t}(o.Component)},4787:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7462),o=n(4578),i=n(7363),a=n(834),s=n(8285),c=(0,a.Z)("resize-listener");const l=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._measurer=null,t._onResize=function(e){t.props.onResize(e)},t._onIframeLoad=function(){t._measurer.contentWindow.addEventListener("resize",t._onResize)},t._iframeRef=function(e){t._measurer=e},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this._measurer;e.contentWindow?this._onIframeLoad():e.addEventListener("load",this._onIframeLoad)},n.componentWillUnmount=function(){var e=this._measurer;e&&(e.removeEventListener("load",this._onIframeLoad),e.contentWindow&&e.contentWindow.removeEventListener("resize",this._onResize))},n.render=function(){return i.createElement("iframe",(0,r.Z)({className:c()},s.x,{ref:this._iframeRef}))},t}(i.Component)},1277:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>s,ID:()=>a});n(7363);function r(){return r}var o=(0,n(5369).Z)("scroll",{addListener:r,getScrollableNode:function(){return null},getCacheScrollPosition:function(){return null},scrollId:"",registerStickyElement:r,unregisterStickyElement:r,updateStickyElement:r,getStickyElementsOffset:function(){return 0}}),i=o.connect,a=o.Provider;o.Context;const s=i},3454:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(4578),o=n(7363),i=n(111),a=n(1277),s=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._unsubscribe=void 0,t._listener=void 0,t._attachListener=function(){var e;t._listener=(0,i.Z)(t.props.eventHandler,null!==(e=t.props.throttleWait)&&void 0!==e?e:512),t._unsubscribe=t.props.addListener(t._listener)},t._unattachListener=function(){var e;t._unsubscribe(),null===(e=t._listener)||void 0===e||e.cancel()},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._attachListener()},n.componentDidUpdate=function(e){e.eventHandler!==this.props.eventHandler&&(this._unattachListener(),this._attachListener())},n.componentWillUnmount=function(){this._unattachListener()},n.render=function(){return null},t}(o.PureComponent);const c=(0,a.ZP)(s)},2362:(e,t,n)=>{"use strict";n.d(t,{Z:()=>I});var r=n(7462),o=n(4578),i=n(7363),a=n(7473),s=n.n(a),c=n(5877),l=n.n(c),u=n(834),d=n(9269),p=n(4787),m=n(6021),f=n(111),v=n(3454),h=n(1277);const g=function(e){var t=this;this._listeners=[],this._ref=void 0,this.addListener=function(e){return t._listeners.push(e),e(t._ref.current,null),function(){return t._removeListener(e)}},this._removeListener=function(e){t._listeners=t._listeners.filter((function(t){return t!==e}))},this.fire=function(e){t._listeners.forEach((function(n){return n(t._ref.current,e)}))},this._ref=e};var y=n(4467),_=(0,u.Z)("scroll"),b={},E={passive:!0},w=function(e){function t(t){var n;return(n=e.call(this,t)||this)._id=l().v4(),n._onResizeThrottled=void 0,n._onMouseMoveThrottled=void 0,n._container=i.createRef(),n._content=null,n._wrap=i.createRef(),n._scrollbar=null,n._scrollbarThumb=null,n._height=void 0,n._ratio=1,n._startPageY=0,n._startScrollTop=0,n._emitter=void 0,n._onSelectStart=null,n._getContainer=function(){return n.props.containerRef||n._container},n._onScroll=function(e){n._emitter.fire(e)},n._onResize=function(){n._wrap.current&&n._content&&(n._height=n._wrap.current.clientHeight,n._ratio=n._height/n._content.clientHeight,"dynamic"===n.props.width&&n._fixContentWidth(),n._scrollbarThumb&&(n._updateScrollbarThumbPosition(n._getContainer().current.scrollTop),n._scrollbarThumb.style.height=100*n._ratio+"%"),n._showHideScrollbar(n._ratio<1))},n._onScrollSelf=function(){var e=n._getContainer().current;if(e){var t=n.props;n._scrollbarThumb&&n._updateScrollbarThumbPosition(e.scrollTop),t.cacheKey&&(b[t.cacheKey]=e.scrollTop),t.onScroll&&t.onScroll(e.scrollTop),t.onScrollToEnd&&e.clientHeight+e.scrollTop>=e.scrollHeight&&t.onScrollToEnd()}},n._onWheel=function(e){n._getContainer().current.scrollTop=n._getContainer().current.scrollTop+e.deltaY},n._onScrollbarClick=function(e){var t=n._getContainer().current,r=n._scrollbarThumb;e.pageY<r.getBoundingClientRect().top?t.scrollTop-=n._height:t.scrollTop+=n._height},n._onMouseDown=function(e){var t=n._wrap.current,r=n._getContainer().current;t&&r&&(window.addEventListener("mouseup",n._onMouseUp,E),window.addEventListener("mousemove",n._onMouseMoveThrottled,E),t.classList.add("_pressed"),n._startPageY=e.pageY,n._startScrollTop=r.scrollTop,n._onSelectStart=r.onselectstart,r.onselectstart=function(e){e.preventDefault()})},n._onMouseUp=function(){var e=n._wrap.current,t=n._getContainer().current;e&&t&&(n._removeMouseListeners(),e.classList.remove("_pressed"),t.onselectstart=n._onSelectStart)},n._onMouseMove=function(e){var t=n._getContainer().current;n._scrollbar&&(t.scrollTop=n._startScrollTop+(e.pageY-n._startPageY)/n._ratio)},n._removeMouseListeners=function(){window.removeEventListener("mouseup",n._onMouseUp,E),window.removeEventListener("mousemove",n._onMouseMoveThrottled,E)},n._updateScrollbarThumbPosition=function(e){n._scrollbarThumb.style.setProperty((0,d.r1)().styles.transform,"translate3d(0, "+Math.ceil(e*n._ratio)+"px, 0)")},n._fixContentWidth=function(){var e=n._getContainer().current,t=n._content,r=e.offsetWidth-e.clientWidth;t.style.marginRight=-r+"px"},n._showHideScrollbar=function(e){var t=n._scrollbar;t&&(t.style.display=e?"flex":"none")},n._restoreScrollPosition=function(){var e=n.props,t=n._getContainer().current,r=e.cacheKey&&b[e.cacheKey]||0;t.scrollTop!==r&&(0===r?t.scrollTop=r:s()((function(){return t.scrollTop=r})))},n._onResizeThrottled=(0,f.Z)(n._onResize,64),n._onMouseMoveThrottled=(0,f.Z)(n._onMouseMove,64),n._emitter=new g(n._getContainer()),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._onResize(),setTimeout(this._onResize,0),this._restoreScrollPosition(),this.props.getScrollingNodeRef&&this.props.getScrollingNodeRef(this._getContainer().current),this._getContainer().current.addEventListener("scroll",this._onScroll,E),this._emitter.fire(null)},n.componentDidUpdate=function(e){var t=this.props;e.cacheKey!==t.cacheKey&&this._restoreScrollPosition()},n.componentWillUnmount=function(){this._removeMouseListeners(),this.props.getScrollingNodeRef&&this.props.getScrollingNodeRef(null),this._getContainer().current.removeEventListener("scroll",this._onScroll,E),this._emitter.fire(null),this._onResizeThrottled.cancel(),this._onMouseMoveThrottled.cancel()},n.render=function(){var e=this,t=this.props;return i.createElement("div",{className:_({width:t.width||"narrow",disabled:t.disabled,"full-height":t.fullHeight}),ref:this._wrap},i.createElement("div",{className:_("container",{firefox:"Firefox"===t.config.uatraits.BrowserName}),ref:this._getContainer()},i.createElement("div",{className:_("content"),ref:function(t){return e._content=t}},i.createElement(h.ID,{value:{addListener:this._emitter.addListener,getScrollableNode:function(){return e._getContainer().current},getCacheScrollPosition:function(){var t;return e.props.cacheKey&&null!==(t=b[e.props.cacheKey])&&void 0!==t?t:null},scrollId:this._id,registerStickyElement:this.props.registerStickyElement,unregisterStickyElement:this.props.unregisterStickyElement,updateStickyElement:this.props.updateStickyElement,getStickyElementsOffset:this.props.getStickyElementsOffset}},t.children,i.createElement(v.Z,{eventHandler:this._onScrollSelf,throttleWait:64})),i.createElement(p.Z,{onResize:this._onResizeThrottled})),i.createElement(p.Z,{onResize:this._onResizeThrottled}),i.createElement("div",{className:_("scrollbar",{noprint:!0}),ref:function(t){return e._scrollbar=t},onWheel:this._onWheel},i.createElement("div",{"aria-hidden":!0,className:_("scrollbar-track"),onClick:this._onScrollbarClick}),i.createElement("div",{"aria-hidden":!0,className:_("scrollbar-thumb"),ref:function(t){return e._scrollbarThumb=t},onMouseDown:this._onMouseDown}))),i.createElement(m.Z,{type:"resize",listener:this._onResizeThrottled,options:E}))},t}(i.Component);const S=(0,y.ZP)(w);var C=(0,u.Z)("scroll"),Z={},R={passive:!0};const P=function(e){function t(t){var n;return(n=e.call(this,t)||this)._id=l().v4(),n._container=i.createRef(),n._emitter=void 0,n._provider=void 0,n._getContainer=function(){return n.props.containerRef||n._container},n._onScroll=function(e){n._getContainer().current&&n._emitter.fire(e)},n._restoreScrollPosition=function(){var e=n.props,t=n._getContainer().current,r=e.cacheKey&&Z[e.cacheKey]||0;t.scrollTop!==r&&window.requestAnimationFrame((function(){return t.scrollTop=r}))},n._onScrollSelf=function(){var e=n._getContainer().current;if(e){var t=n.props;t.cacheKey&&(Z[t.cacheKey]=e.scrollTop),t.onScroll&&t.onScroll(e.scrollTop),t.onScrollToEnd&&e.clientHeight+e.scrollTop>=e.scrollHeight&&t.onScrollToEnd()}},n._emitter=new g(n._getContainer()),n._provider={addListener:n._emitter.addListener,getScrollableNode:function(){return n._getContainer().current},getCacheScrollPosition:function(){var e;return n.props.cacheKey&&null!==(e=Z[n.props.cacheKey])&&void 0!==e?e:null},registerStickyElement:n.props.registerStickyElement,unregisterStickyElement:n.props.unregisterStickyElement,updateStickyElement:n.props.updateStickyElement,getStickyElementsOffset:n.props.getStickyElementsOffset,scrollId:n._id,reachedBottom:function(){var e=n._getContainer().current;return!!e&&e.clientHeight+e.scrollTop>=e.scrollHeight-10}},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.getScrollingNodeRef&&this.props.getScrollingNodeRef(this._getContainer().current),this._restoreScrollPosition(),this._getContainer().current.addEventListener("scroll",this._onScroll,R),this._emitter.fire(null)},n.componentDidUpdate=function(e){var t=this.props;e.cacheKey===t.cacheKey&&(e.cacheKey||t.cacheKey)||this._restoreScrollPosition()},n.componentWillUnmount=function(){this._getContainer().current.removeEventListener("scroll",this._onScroll,R),this._emitter.fire(null)},n.render=function(){var e=this.props;return i.createElement("div",{className:C({width:e.width||"narrow",disabled:e.disabled,native:e.native,"full-height":e.fullHeight})},i.createElement("div",{className:C("container"),ref:this._getContainer()},i.createElement("div",{className:C("content")},i.createElement(h.ID,{value:this._provider},e.children,i.createElement(v.Z,{eventHandler:this._onScrollSelf,throttleWait:64})))))},t}(i.Component);var k=function(e){function t(t){var n;return(n=e.call(this,t)||this)._stickyListeners=void 0,n._stickyHeights=void 0,n._stickyRefs=void 0,n._registerStickyElement=function(e,t,r,o){n._stickyHeights[r][e]=0,n._stickyRefs[r][e]=t,n._stickyListeners[r][e]=o,n._calcStickyPositions(Math.max(e-1,0),r)},n._unregisterStickyElement=function(e,t){delete n._stickyHeights[t][e],delete n._stickyRefs[t][e]},n._updateStickyElement=function(e,t,r){n._stickyHeights[r][e]=t,n._calcStickyPositions(e,r)},n._calcStickyPositions=function(e,t){for(var r=0,o=0;o<=e;o++)"number"==typeof n._stickyHeights[t][o]&&(r+=n._stickyHeights[t][o]);for(var i=e+1;i<n._stickyHeights[t].length;i++){var a,s;null===(a=(s=n._stickyListeners[t])[i])||void 0===a||a.call(s,r),"number"==typeof n._stickyHeights[t][i]&&(r+=n._stickyHeights[t][i])}},n._isNodeWithinStickyElement=function(e){return n._stickyRefs.top.concat(n._stickyRefs.bottom).some((function(t){var n;return null===(n=t.current)||void 0===n?void 0:n.contains(e)}))},n._getStickyElementsOffset=function(e){return n._stickyHeights[e].filter(Boolean).reduce((function(e,t){return e+t}),0)},n._stickyListeners={top:[],bottom:[]},n._stickyHeights={top:[],bottom:[]},n._stickyRefs={top:[],bottom:[]},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e,t;null===(e=(t=this.props).setIsNodeWithinStickyElementRef)||void 0===e||e.call(t,this._isNodeWithinStickyElement)},n.componentWillUnmount=function(){var e,t;null===(e=(t=this.props).setIsNodeWithinStickyElementRef)||void 0===e||e.call(t,void 0)},n.render=function(){var e=this.props.config.uatraits.isMobile||this.props.native?P:S;return i.createElement(e,(0,r.Z)({},this.props,{getStickyElementsOffset:this._getStickyElementsOffset,registerStickyElement:this._registerStickyElement,unregisterStickyElement:this._unregisterStickyElement,updateStickyElement:this._updateStickyElement}))},t}(i.Component);const I=(0,y.ZP)(k)},4916:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(7363),o=n(834);const i=function(e){var t=e.view,n=e.withoutMargin,i=e.color,a=(0,o.Z)("spinner-view_"+t);return r.createElement("div",{className:a({"without-margin":n,color:i})},r.createElement("div",{className:a("circle")}))}},7734:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>i});n(7363);var r=(0,n(5369).Z)("time",{getToday:function(){return new Date},timeContext:{hydrationPhaseTime:null}}),o=r.connect;r.Provider,r.Context;const i=o},6021:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(4578),o=n(7363),i=n(576);const a=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props;window.addEventListener(e.type,e.listener,e.options)},n.componentDidUpdate=function(e){var t=this.props;e.listener===t.listener&&(0,i.Z)(e.options,t.options)||(window.removeEventListener(e.type,e.listener,e.options),window.addEventListener(t.type,t.listener,t.options))},n.componentWillUnmount=function(){var e=this.props;window.removeEventListener(e.type,e.listener,e.options)},n.render=function(){return null},t}(o.Component)},4479:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(7363),o=n(834),i=n(4467),a=n(8696),s=n(1745),c=n(150);var l=n(3988),u=(0,o.Z)("zoom-control");const d=function(e){var t,n=(0,i.ZR)(),o=Boolean(n.mapWidget),d=null!==(t=e.size)&&void 0!==t?t:n.uatraits.isMobile?"xmedium":"medium",p=n.uatraits.isMobile&&!o?[l.zoomIn48Icon,l.zoomOut48Icon]:['<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 5.992c0-.537.448-.992 1-.992.556 0 1 .444 1 .992V11h5.008c.537 0 .992.448.992 1 0 .556-.444 1-.992 1H13v5.008c0 .537-.448.992-1 .992-.556 0-1-.444-1-.992V13H5.992C5.455 13 5 12.552 5 12c0-.556.444-1 .992-1H11V5.992z" fill="currentColor"/></svg>','<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5 12a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1z" fill="currentColor"/></svg>'],m=p[0],f=p[1];return r.createElement("div",{className:u()},r.createElement("div",{className:u("group")},r.createElement("div",{className:u("zoom-in")},r.createElement(s.Z,{text:"Приблизить",position:"left",isDisabled:e.disabledZoomIn,isAir:!0},r.createElement(c.ZP,{name:"zoom_in",logClick:!0},r.createElement(a.Z,{view:"air",size:d,icon:r.createElement("div",{className:u("icon"),dangerouslySetInnerHTML:{__html:m}}),onClick:e.onZoomIn,ariaLabel:"Приблизить",disabled:e.disabledZoomIn,pinBottom:!n.uatraits.isMobile||o})))),r.createElement("div",{className:u("zoom-out")},r.createElement(s.Z,{text:"Отдалить",position:"left",isDisabled:e.disabledZoomOut,isAir:!0},r.createElement(c.ZP,{name:"zoom_out",logClick:!0},r.createElement(a.Z,{view:"air",size:d,icon:r.createElement("div",{className:u("icon"),dangerouslySetInnerHTML:{__html:f}}),ariaLabel:"Отдалить",onClick:e.onZoomOut,disabled:e.disabledZoomOut,pinTop:!n.uatraits.isMobile||o}))))))}},3471:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(4578),o=n(7363),i=n(1533),a=n(9269);const s=function(e){function t(t){var n;return(n=e.call(this,t)||this)._addListeners=function(e){var t=(0,a.r1)();t.events.animationEnd&&e.addEventListener(t.events.animationEnd,n._onHideAnimationEnd),t.events.transitionEnd&&e.addEventListener(t.events.transitionEnd,n._onHideAnimationEnd)},n._removeListeners=function(e){var t=(0,a.r1)();t.events.animationEnd&&e.removeEventListener(t.events.animationEnd,n._onHideAnimationEnd),t.events.transitionEnd&&e.removeEventListener(t.events.transitionEnd,n._onHideAnimationEnd)},n._onHideAnimationEnd=function(){var e;null!==(e=n.props.animationRef)&&void 0!==e&&e.current&&n._removeListeners(n.props.animationRef.current),i.flushSync((function(){n.setState({content:null},n.props.onHideEnd)}))},n.state={content:t.children},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.children&&this.setState({content:this.props.children},this.props.onShow)},n.componentDidUpdate=function(e){var t=this.props.children;if(t)t!==e.children&&this.setState({content:t},this.state.content?void 0:this.props.onShow);else{var n,r=null===(n=this.props.animationRef)||void 0===n?void 0:n.current;r&&(this._addListeners(r),r.classList.add("_animation-hide")),this.props.onHideStart&&this.props.onHideStart()}},n.componentWillUnmount=function(){var e;null!==(e=this.props.animationRef)&&void 0!==e&&e.current&&this._removeListeners(this.props.animationRef.current)},n.render=function(){return this.state.content},t}(o.Component)},7238:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7462),o=n(4086),i=n(8574),a=n(129);const s=function(e){var t=a.stringify(e,{sort:function(e,t){var n=e.toLowerCase(),r=t.toLowerCase();return n<r?-1:n>r?1:0}});return t?String(function(e){for(var t=e.length,n=5381,r=0;r<t;r++)n=33*n^e.charCodeAt(r);return n>>>0}(t)):""};var c;const l=function e(t,n,a,l){var u={csrfToken:c||a.csrfToken,sessionId:a.counters.analytics.sessionId,host_config:a.hostConfig,ajax:"1"};a.query["no-mail"]&&(u["no-mail"]=!0),a.query["no-cache"]&&(u["no-cache"]=!0),a.query.debug&&(u.debug=a.query.debug),a.mocks&&(u.mocks=0!==Object.keys(a.mocks).length?a.mocks:"1");var d={url:(n.baseUrl||a.baseUrl)+"/api/"+t,method:"body"in n&&n.body?"POST":"GET",headers:(0,r.Z)({"X-Retpath-Y":window.location.href},n.headers)};"body"in n&&n.body&&(d.body=JSON.stringify(n.body),d.headers=(0,r.Z)({},d.headers,{"Content-Type":"application/json; charset=utf-8"}));var p=(0,r.Z)({},u,"query"in n&&n.query?n.query:{}),m=s(p);return d.query=(0,r.Z)({},p,{s:m}),"prestable"===a.environment&&(d.headers=(0,r.Z)({},d.headers,{"X-Ya-Maps-Prestable":"1"})),(0,o.Z)(d).then((function(r){if(function(e){return"type"in e&&"captcha"===e.type}(r))throw window.location.href=r.captcha["captcha-page"],new Error("Response is captcha");if("csrfToken"in r){if(!1!==l)return c=r.csrfToken,e(t,n,a,!1);throw new Error("Invalid csrf token")}if(r.debug&&(0,i.v)(r.debug),"error"in r)throw"message"in r.error?new Error(r.error.message):r.error;return r.data}))}},6667:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r={create:function(e,t){var n=t.success,r=t.fail,o=t.always,i=!1;return e.then((function(e){i||(n&&n(e),o&&o(null,e))}),(function(e){i||(r&&r(e),o&&o(e))})),{cancel:function(){return i=!0}}},cancel:function(e){e&&e.cancel()}}},9269:(e,t,n)=>{"use strict";n.d(t,{r1:()=>o});var r=n(2967),o=(n(622),function(){return{events:{transitionEnd:i("transition"),animationEnd:i("animation")},styles:{transform:s("transform"),transition:s("transition"),userSelect:s("user-select")},cssStyles:{transform:a("transform"),transformOrigin:a("transform-origin")},has:{touch:"ontouchstart"in window||Boolean(window.navigator.maxTouchPoints),retinaDisplay:window.devicePixelRatio>1,printColorAdjust:null!==c("printColorAdjust"),snapAlign:null!==c("scrollSnapAlign"),objectFit:null!==c("objectFit")}}});function i(e){var t=c(e);return t?t+(0,r.Z)(e)+"End":null!==t?e+"end":null}function a(e){var t=c(e);return t?"-"+t+"-"+e:null!==t?e:null}function s(e){var t=c(e);return t?t+l(e):null!==t?e:null}function c(e){var t=window.document.createElement("div");return void 0!==t.style[e]?"":void 0!==t.style["webkit"+l(e)]?"webkit":void 0!==t.style["Moz"+l(e)]?"Moz":void 0!==t.style["ms"+l(e)]?"ms":null}function l(e){return e.split("-").map((function(e){return(0,r.Z)(e)})).join("")}},4897:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7462),o=n(3366),i=n(7363),a=n(2441),s=n(1091),c=["children","tag","forwardedRef","ariaHidden","ariaLabel","onClick","role","skipBlurOnPress"];const l=(0,s.Z)((function(e){var t=e.children,n=e.tag,s=void 0===n?"div":n,l=e.forwardedRef,u=e.ariaHidden,d=e.ariaLabel,p=e.onClick,m=e.role,f=e.skipBlurOnPress,v=(0,o.Z)(e,c),h=(0,a.h)({callback:e.onClick,clickableRef:l,skipBlurOnPress:f}),g=u||!p,y=g?-1:0,_="string"==typeof t?t:d,b=i.useCallback((function(t){var n;h.onMouseLeave(t),null===(n=e.onMouseLeave)||void 0===n||n.call(e,t)}),[h,e]),E=i.useCallback((function(t){var n;h.onMouseDown(t),null===(n=e.onMouseDown)||void 0===n||n.call(e,t)}),[h,e]);return i.createElement(s,(0,r.Z)({},v,h,{onMouseDown:E,onMouseLeave:b,onClick:p,"aria-hidden":g,"aria-label":_,role:m||"button",tabIndex:y}),t)}))},2441:(e,t,n)=>{"use strict";n.d(t,{h:()=>c});var r=n(7462),o=n(7363),i=n(2327),a=n(4837);n(1091);function s(e){var t=e.callback;return o.useCallback((function(e,n){if(e.keyCode===i.n.ENTER||e.keyCode===i.n.SPACE){var r=n||t;null==r||r(e)}}),[t])}var c=function(e){var t=o.useRef(null),n=e.clickableRef||t,i=(0,a.p)({ref:n,skipBlurOnPress:e.skipBlurOnPress}),c=s({callback:e.callback});return(0,r.Z)({},i,{onKeyDown:c,ref:n})}},622:(e,t,n)=>{"use strict";n(6504),n(3173)},1091:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(7462),o=n(7363);const i=function(e){var t=function(t,n){return o.createElement(e,(0,r.Z)({},t,{forwardedRef:n||void 0}),t.children)};return o.forwardRef(t)}},4837:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});var r=n(7462),o=n(7363);function i(e){var t=o.useState(!1),n=t[0],i=t[1],a={onMouseLeave:o.useCallback((function(){return i(!1)}),[i]),onMouseDown:o.useCallback((function(){return i(!0)}),[i]),onFocus:o.useCallback((function(){var t;n&&e.ref.current===window.document.activeElement&&!e.skipBlurOnPress&&(null===(t=e.ref.current)||void 0===t||t.blur())}),[e,n])};return(0,r.Z)({},a)}},2713:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var r=n(7462),o=n(4578),i=n(7363),a=n(834),s=n(4086),c=n(6667),l=n(4897),u=n(5877),d=n.n(u),p={},m={},f=(0,a.Z)("inline-image");const v=function(e){function t(t){var n;return(n=e.call(this,t)||this)._loadAction=void 0,n._generatedId=void 0,n._load=function(){c.Z.cancel(n._loadAction);var e=n.props.url;""!==e&&(m[e]||(m[e]=(0,s.Z)({url:e,parser:"string"}),m[e].then((function(t){return p[e]=t}),(function(){return delete m[e]}))),n._loadAction=c.Z.create(m[e],{success:function(){return n.setState({loaded:!0})}}))},n._generatedId=d().v4(),n.state={loaded:Boolean(p[n.props.url])},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.state.loaded||this._load()},n.componentDidUpdate=function(e){if(this.props.url!==e.url){c.Z.cancel(this._loadAction);var t=Boolean(p[this.props.url]);this.setState({loaded:t}),t||this._load()}},n.componentWillUnmount=function(){c.Z.cancel(this._loadAction)},n.render=function(){var e,t,n=this.props,o=p[n.url],a=null===(e=o)||void 0===e||null===(t=e.match(/<clipPath[^>]+id="([^"]+)"/))||void 0===t?void 0:t[1];return a&&(o=o.replace(new RegExp(a,"g"),this._generatedId)),n.children?n.children(o||""):i.createElement(l.Z,{tag:"span",key:this.state.loaded?0:1,style:(0,r.Z)({},n.style,{fontSize:0,lineHeight:0}),ariaLabel:n.ariaLabel,className:f({loaded:this.state.loaded})+(n.className?" "+n.className:""),onClick:n.onClick,dangerouslySetInnerHTML:{__html:o||""}})},t}(i.PureComponent)},9526:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r={};const o=function(e,t){var n=e.toString();return r[n]||Object.keys(t).reduce((function(t,o){return t[o]=function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return function(t){var a=function(e){return t(e[o].apply(e,i))};return r[n]?a(r[n]):e().then((function(e){var t=e.default;return a(r[n]=t)}),(function(e){return t(function(e){return function(t,n){t({type:"EXTEND",payload:{loadingErrors:[].concat(n().loadingErrors,[e])}})}}(e.message))}))}},t}),{})}},6922:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7462),o=n(3366),i=n(4578),a=n(7363),s=n(8216),c=["shouldRender"];const l=function(e,t,n){void 0===n&&(n={});var l=!1,u=function(t){function s(){return t.apply(this,arguments)||this}(0,i.Z)(s,t);var u=s.prototype;return u.shouldComponentUpdate=function(e){return(n.withSideEffect||!l&&!this.props.shouldRender)&&e.shouldRender},u.componentDidUpdate=function(e){!e.shouldRender&&this.props.shouldRender&&(l=!0)},u.render=function(){var t=this.props,i=t.shouldRender,s=(0,o.Z)(t,c);return i?a.createElement(e,(0,r.Z)({},s)):n.placeholder||null},s}(a.Component);return s.$j((function(e){return{shouldRender:t(e)}}))(u)}},8810:(e,t,n)=>{"use strict";n.d(t,{k7:()=>r,sL:()=>o,M8:()=>s,Uc:()=>c,h9:()=>m,OO:()=>f,b:()=>v,aC:()=>i,EB:()=>a,mH:()=>l,B1:()=>u,iR:()=>d,WN:()=>p,mu:()=>h,US:()=>g,az:()=>y,Uv:()=>_,cg:()=>b,Cb:()=>E});var r=["object/add"],o=["entrance/add","address/add","road/add","other/add","transit/stop/add","parking/add","barrier/add","fence/add","crosswalk/add","gate/add","provider/add"],i=["object/edit"],a=["object/other","address/edit","entrance/edit","object/location/edit","object/name/edit","object/not-found"],s=["assignment/organization/status"],c=["assignment/barrier/edit","assignment/gate/edit","assignment/entrance/edit","assignment/settlement/scheme/add","assignment/address/add"],l=["transit/stop/edit"],u=["transit/stop/not-found","transit/stop/name/edit","transit/stop/location/edit","transit/stop/route/incorrect","transit/stop/other"],d=["subway/edit"],p=["subway/not-found","subway/name/edit","subway/location/edit","subway/other"],m=["organization/add"],f=["organization/edit","organization/closed"],v=["organization/edit-info","organization/other","organization/closed/permanently","organization/closed/temporary","organization/closed/unknown","organization/opened","organization/moved","organization/location/edit","organization/edit-accessibility"],h=["route/edit","route/incorrect"],g=["route/edit/better","route/incorrect/road-closed","route/incorrect/poor-condition","route/incorrect/prohibiting-sign","route/incorrect/obstruction","route/incorrect/other","route/other"],y=["object/select"],_=["map/edit"],b=["spot/other"],E=([].concat(["ru.yandex.yandexnavi","ru.yandex.yandexnavi.inhouse","ru.yandex.yandexnavi.sandbox","ru.yandex.yandexnavi.debug","ru.yandex.yandexnavi.pr","ru.yandex.mobile.navigator","ru.yandex.mobile.navigator.inhouse","ru.yandex.mobile.navigator.sandbox"],["desktop-yango-maps","touch-yango-maps","com.yango.maps.android.pr","com.yango.maps.android.debug","com.yango.maps.ios.inhouse","com.yango.maps.ios.sandbox","com.yango.maps.android","com.yango.maps.ios","ru.yandex.yango","ru.yandex.yango.develop","ru.yandex.yango.inhouse","com.yandex.yango","com.yandex.yango.develop","com.yandex.yango.debug","com.yango.driver","com.yango.driver.beta","com.yango.driver.flutter.ios","com.yango.driver.flutter.ios.develop","ru.yandex.taximeter","ru.yandex.taximeter.flutter.ios","ru.yandex.taximeter.flutter.ios.develop","ru.yandex.taximeter.flutter.ios.develop.debug","ru.yandex.taximeter.flutter.ios.inhouse","ru.yandex.taximeter.beta"],["web","mobile_maps_android","mobile_maps_ios","serp","tycoon","webview_form","ugc","nyak","ru.yandex.searchplugin","ru.yandex.yandexmaps","ru.yandex.traffic","ru.yandex.traffic.sandbox","ru.yandex.traffic.inhouse","ru.yandex.yandexmaps.debug","ru.yandex.yandexmaps.pr","com.yandex.maps.TestApp","com.yandex.maps.testapp","com.yandex.maps.mrctestapp","com.yandex.maps.mrctestapp.testing","com.yandex.browser","ru.yandex.mobile","ru.yandex.mobile.search","desktop-maps","touch-maps","touch-nmaps"]),["feedback.common.error_in_geo_object_menu","feedback.common.add_object_to_map","feedback.spot_other.finish","feedback.finish_form.edit_status_carousel","toponym.add_finish","toponym.edit_finish","organization.add_finish","organization.edit_finish","ugc_profile.feedbacks_footer","ugc_profile.feedbacks_footer.edit_map","ugc_profile.feedbacks_footer.add_object","ugc_profile.feedbacks_placeholder","ugc_profile.feedbacks_drafts.feedbacks_draft","ugc_profile.assignments_placeholder.add_object","ugc_profile.assignments_push_placeholder.edit_object","ugc_profile.organization_edit_status_assignment.edit","ugc_profile.organization_edit_status_assignment.submit","ugc_profile.barrier_assignment.edit","ugc_profile.gate_assignment.edit","ugc_profile.add_address_assignment.edit","ugc_profile.settlement_scheme_assignment.edit","ugc_profile.entrances_assignment.edit","ugc_profile.review_impression.closed","map.context","map.controls","organization.footer","organization.features","organization.search_result","toponym.search_results","toponym.default","toponym.building","toponym.building_without_address","toponym.add_object","route.routes_list","route.detailed_info","user_profile.edit_map","masstransit.default","masstransit.subway"])},9541:(e,t,n)=>{"use strict";n.d(t,{qv:()=>S,W3:()=>i,bl:()=>c,RP:()=>a,Qr:()=>s,NM:()=>l,OI:()=>u,ai:()=>d,mR:()=>p,KT:()=>m,LB:()=>f,Rf:()=>g,UZ:()=>v,pj:()=>h,xT:()=>_,cV:()=>C,T_:()=>b,XS:()=>E,fU:()=>w});var r=n(8810);function o(e){return r.sL.includes(e)}function i(e){return function(e){return r.k7.includes(e)}(e)||o(e)}function a(e){return r.aC.includes(e)}function s(e){return r.EB.includes(e)}function c(e){return a(e)||s(e)}function l(e){return r.mH.includes(e)}function u(e){return r.B1.includes(e)}function d(e){return r.iR.includes(e)}function p(e){return r.WN.includes(e)}function m(e){return function(e){return d(e)||p(e)}(e)||function(e){return l(e)||u(e)}(e)}function f(e){return r.h9.includes(e)}function v(e){return r.OO.includes(e)}function h(e){return r.b.includes(e)}function g(e){return v(e)||h(e)}function y(e){return r.US.includes(e)}function _(e){return function(e){return r.mu.includes(e)}(e)||y(e)}function b(e){return r.az.includes(e)}function E(e){return r.Uv.includes(e)}function w(e){return r.cg.includes(e)}function S(e){return function(e){return r.M8.includes(e)}(e)||function(e){return r.Uc.includes(e)}(e)||o(e)||s(e)||u(e)||p(e)||function(e){return h(e)||f(e)}(e)||y(e)||w(e)}function C(e){return o(e)||y(e)||w(e)||["transit/stop/location/edit","object/location/edit","entrance/edit","subway/location/edit"].includes(e)}},9771:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Cc});var r=n(7462),o=n(4578),i=n(7363),a=n(1533),s=n(775),c=n(2332),l=n(2824),u=n(9740),d=n(5731);var p=n(6667),m=n(30),f=n(129),v=n(4270),h=n(9749),g=["","permission_denied","position_unavailable","timeout","unknown"],y=function(e){this.code=void 0,this.message=void 0,this.message=e,this.code=g.indexOf(e)},_=6e4,b={ERROR_TYPES:g,getCurrentPosition:function(e,t){var n,r,o;return void 0===t&&(t=_),"denied"===(null===(n=e.query.mocks)||void 0===n?void 0:n.geolocation)?Promise.reject(new y("permission_denied")):"unavailable"===(null===(r=e.query.mocks)||void 0===r?void 0:r.geolocation)?Promise.reject(new y("position_unavailable")):(null===(o=(0,h.W)())||void 0===o||o.logEvent("geolocation_request"),w({timeout:t}).then((function(t){var n,r,o,i=t.coords;null===(n=(0,h.W)())||void 0===n||n.logEvent("geolocation_success",{accuracy:i.accuracy});var a=C(null===(r=e.query.mocks)||void 0===r?void 0:r.geolocation),s=a?{accuracy:null!==(o=a.accuracy)&&void 0!==o?o:i.accuracy,latitude:a.latitude,longitude:a.longitude,altitude:null,altitudeAccuracy:null,heading:null,speed:null}:i;return E(s,e),s})).catch((function(e){var t;throw null===(t=(0,h.W)())||void 0===t||t.logEvent("geolocation_fail",{type:null!=e&&e.code?b.ERROR_TYPES[e.code]:"unknown"}),e||new y("unknown")})))},watchPosition:function(e,t,n){var o,i,a;if(void 0===n&&(n=_),"denied"===(null===(o=t.query.mocks)||void 0===o?void 0:o.geolocation))return e.onError("permission_denied"),0;if("unavailable"===(null===(i=t.query.mocks)||void 0===i?void 0:i.geolocation))return e.onError("position_unavailable"),0;null===(a=(0,h.W)())||void 0===a||a.logEvent("geolocation_watch_request");var s,c,l,u,d,p,m=!1;return s=function(n){var r,o,i;m||(null===(i=(0,h.W)())||void 0===i||i.logEvent("geolocation_watch_success",{accuracy:n.coords.accuracy}),m=!0);var a=C(null===(r=t.query.mocks)||void 0===r?void 0:r.geolocation),s=a?{accuracy:null!==(o=a.accuracy)&&void 0!==o?o:n.coords.accuracy,latitude:a.latitude,longitude:a.longitude,altitude:null,altitudeAccuracy:null,heading:null,speed:null}:n.coords;E(s,t),e.onSuccess(s)},c=function(t){var n,r=null!=t&&t.code?b.ERROR_TYPES[t.code]:"unknown";m||(null===(n=(0,h.W)())||void 0===n||n.logEvent("geolocation_watch_fail",{type:r}),m=!0),e.onError(r)},l={timeout:n},(null===(u=window.yandex)||void 0===u||null===(d=u.mapsApp)||void 0===d?void 0:d.getCurrentUserLocation)?window.setInterval((function(){return w(l).then(s).catch(c)}),null!==(p=null==l?void 0:l.timeout)&&void 0!==p?p:_):window.navigator.geolocation.watchPosition(s,c,(0,r.Z)({enableHighAccuracy:!0},l))},clearWatch:function(e){var t,n;null!==(t=window.yandex)&&void 0!==t&&null!==(n=t.mapsApp)&&void 0!==n&&n.getCurrentUserLocation?window.clearInterval(e):window.navigator.geolocation.clearWatch(e)},checkPermission:function(){return window.navigator.permissions?Promise.race([window.navigator.permissions.query({name:"geolocation"}).then((function(e){return e.state})),v.Vs(2e3)]).catch((function(){})):Promise.resolve(void 0)}};function E(e,t){e&&(e.accuracy>5e3||((new window.Image).src=t.morda.url+"/gpsave?"+f.stringify({sk:t.xscriptCsrfToken,lat:e.latitude,lon:e.longitude,precision:e.accuracy})))}function w(e){var t,n,o,i=null===(t=window.yandex)||void 0===t||null===(n=t.mapsApp)||void 0===n?void 0:n.getCurrentUserLocation;return i?Promise.race([i().then((function(e){return"string"==typeof e?JSON.parse(e):e})).catch((function(){throw new y("position_unavailable")})),v.Vs(null!==(o=null==e?void 0:e.timeout)&&void 0!==o?o:_).then((function(){throw new y("timeout")}))]):new Promise((function(t,n){return window.navigator.geolocation.getCurrentPosition(t,n,(0,r.Z)({enableHighAccuracy:!0},e))}))}var S=/^\d+\.?(\d+)?,\d+\.?(\d+)?(,\d+)?$/;function C(e){if(S.test(e)){var t=e.split(",").map(Number);return{latitude:t[0],longitude:t[1],accuracy:t[2]}}}const Z=b;var R=n(4086),P=n(7238);const k={getRoadEvents:function(e,t){return(0,P.Z)("traffic/getRoadEvents",{query:{id:e}},t)},getRoadEvent:function(e,t){return(0,P.Z)("traffic/getRoadEvent",{query:{eventId:e}},t)},getForecast:function(e,t){return(0,P.Z)("traffic/getForecast",{query:{id:e}},t)},actual:{getLevel:function(e,t){return(0,P.Z)("traffic/getLevelInfo",{query:{ids:e.map(String)}},t)}},archive:{getMetaData:function(e,t,n){return(0,R.Z)({url:n.hosts.trafficArchive+"description/traffic-light",query:{tm:t,ids:e.join(","),l:n.locale},jsonp:!0}).then((function(t){var n=(t.data.features||[]).find((function(t){var n=t.properties;return Boolean(n&&n.HotspotMetaData&&e.includes(n.HotspotMetaData.id))}));if(!n)return{level:null};var r=n.properties&&n.properties.JamsMetaData.level;return{level:void 0!==r?r:null}}))}}};var I=n(4467),M=n(5877),T=n.n(M),x=n(2690),L=n(8067),D=n(8586),N=n(7292),A=U(N.F),z=U(N.i);[].concat(A,["panorama"]),[].concat(z,["panorama","gallery"]);function U(e){return e.filter((function(e){return"overview"!==e}))}n(8926),n(2227),n(7439);var O=n(6786);n(622);n(6204);n(2396),n(9541);var F=n(2394),B=(n(5311),n(917));n(8810);var H=n(7771),q=n(2714),G=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,W=/^\w*$/;const j=function(e,t){if((0,H.Z)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!(0,q.Z)(e))||(W.test(e)||!G.test(e)||null!=t&&e in Object(t))};var V=n(520);function Y(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(Y.Cache||V.Z),n}Y.Cache=V.Z;const K=Y;var $=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,X=/\\(\\)?/g;const Q=function(e){var t=K(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace($,(function(e,n,r,o){t.push(r?o.replace(X,"$1"):n||e)})),t}));var J=n(7338);const ee=function(e,t){return(0,H.Z)(e)?e:j(e,t)?[e]:Q((0,J.Z)(e))};const te=function(e){if("string"==typeof e||(0,q.Z)(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t};const ne=function(e,t){for(var n=0,r=(t=ee(t,e)).length;null!=e&&n<r;)e=e[te(t[n++])];return n&&n==r?e:void 0};var re=n(2119);const oe=function(){try{var e=(0,re.Z)(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();const ie=function(e,t,n){"__proto__"==t&&oe?oe(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var ae=n(106),se=Object.prototype.hasOwnProperty;const ce=function(e,t,n){var r=e[t];se.call(e,t)&&(0,ae.Z)(r,n)&&(void 0!==n||t in e)||ie(e,t,n)};var le=n(6009),ue=n(7226);const de=function(e,t,n,r){if(!(0,ue.Z)(e))return e;for(var o=-1,i=(t=ee(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var c=te(t[o]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var u=s[c];void 0===(l=r?r(u,c,s):void 0)&&(l=(0,ue.Z)(u)?u:(0,le.Z)(t[o+1])?[]:{})}ce(s,c,l),s=s[c]}return e};const pe=function(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var a=t[r],s=ne(e,a);n(s,a)&&de(i,ee(a,e),s)}return i};const me=function(e,t){return null!=e&&t in Object(e)};var fe=n(4732),ve=n(1656);const he=function(e,t,n){for(var r=-1,o=(t=ee(t,e)).length,i=!1;++r<o;){var a=te(t[r]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++r!=o?i:!!(o=null==e?0:e.length)&&(0,ve.Z)(o)&&(0,le.Z)(a,o)&&((0,H.Z)(e)||(0,fe.Z)(e))};const ge=function(e,t){return null!=e&&he(e,t,me)};const ye=function(e,t){return pe(e,t,(function(t,n){return ge(e,n)}))};var _e=n(7619);const be=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var Ee=Math.max;const we=function(e,t,n){return t=Ee(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=Ee(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),be(e,this,s)}};const Se=function(e){return function(){return e}};const Ce=function(e){return e};const Ze=oe?function(e,t){return oe(e,"toString",{configurable:!0,enumerable:!1,value:Se(t),writable:!0})}:Ce;var Re=Date.now;const Pe=function(e){var t=0,n=0;return function(){var r=Re(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Ze);ke=function(e,t){return null==e?{}:ye(e,t)},Pe(we(ke,void 0,_e.Z),ke+"");var ke;var Ie=n(6897);n(7047);n(5249);function Me(e){return{type:"area"===e.query.rlt?"area":"ruler",isEnabled:!1,points:("string"==typeof e.query.rl?e.query.rl:"").split("~").reduce((function(e,t){var n=(0,d.P)(t);if(!n)return e;var r=e[e.length-1],o=r?[r.coordinates[0]+n[0],r.coordinates[1]+n[1]]:n;return e.push({coordinates:o,value:r?r.value+(0,L.t)(o,r.coordinates):0,showBalloon:!1}),e}),[])}}var Te=n(5778),xe={};function Le(e,t,n){return e.uri&&e.coords?function(e,t,n,r){return Ne(e,n,r).then((function(e){return!e&&t?De(t,n,r):e}))}(e.uri,e.coords,t,n):e.uri?Ne(e.uri,t,n):e.value&&!e.coords?function(e,t,n){return Ae(e,(function(){return Te.Z.fetch({type:["geo"],text:e,count:1,origin:n},t)}))}(e.value,t,n):e.coords?De(e.coords,t,n):Promise.resolve(void 0)}function De(e,t,n){return Ae(e.join(","),(function(){return Te.Z.fetch({mode:"reverse",type:["geo"],center:e,count:1,origin:n},t)}))}function Ne(e,t,n){return Ae(e,(function(){return Te.Z.fetch({uri:e,count:1,origin:n},t)}))}function Ae(e,t){return xe[e]?Promise.resolve(xe[e]):t().then((function(e){return e.items.length>0?e.items[0]:void 0})).then((function(t){var n;t&&(xe[e]=t,Object.keys(xe).length>100&&((n={})[e]=xe[e],xe=n));return t}))}var ze=n(834),Ue=n(1243),Oe=n(150),Fe=n(8033),Be=n(6304),He=n(348),qe=(0,ze.Z)("geolocation-pin"),Ge={fill:"#000",fillOpacity:.05,stroke:[{width:1,opacity:.07,color:"#000"}],interactive:!1,zIndex:Fe.I.minimum,simplificationRate:0},We=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(i.Fragment,null,i.createElement(Oe.ZP,{name:"geolocation_pin"},i.createElement(Ue.Z,{coordinates:e.currentPosition,zIndex:Fe.I.minimum,nonInteractive:!0},i.createElement("div",{className:qe()},i.createElement("div",{className:qe("shadow")},i.createElement(He.Z,{name:"map-placemark-dot-shadow-32"})),i.createElement("div",{className:qe("placemark")},i.createElement(He.Z,{name:"map-placemark-dot-32"}))))),e.config.uatraits.isMobile?i.createElement(Be.Z,{center:e.currentPosition,radius:e.accuracy,drawingStyle:Ge}):null)},t}(i.Component);const je=(0,I.ZP)(We);var Ve=n(3366),Ye=n(2713),Ke=n(2606),$e=n.n(Ke),Xe=n(4123),Qe=n.n(Xe),Je=["color","size","comma","caption","outline"],et=(0,ze.Z)("map-circle-placemark");const tt=function(e){var t=e.color,n=e.size,o=void 0===n?"medium":n,a=e.comma,s=e.caption,c=e.outline,l=(0,Ve.Z)(e,Je);return i.createElement(Ue.Z,(0,r.Z)({},l),i.createElement("div",{className:et({comma:a,size:o,outline:c}),style:{color:t}},i.createElement(Ye.Z,{className:et("placemark"),url:a?Qe():$e()}),i.createElement("div",{className:et("content")},e.children),s?i.createElement("div",{className:et("caption")},s):null))};var nt={pmbl:"#177ee6",pmrd:"#f43",pmgn:"#3bb300"},rt=nt.pmbl;const ot=function(e){return e.points?i.createElement(i.Fragment,null,e.points.map((function(e,t){var n=e.coordinates,r=e.color;return i.createElement(tt,{key:t+"_"+n.join(),coordinates:n,color:r&&r in nt?nt[r]:rt,nonInteractive:!0,comma:!0})}))):null};var it=n(3144),at=n(9611);function st(e,t,n){return st=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&(0,at.Z)(o,n.prototype),o},st.apply(null,arguments)}var ct=n(9790),lt=n(9269),ut=n(1170),dt=n(4100),pt=n(9249),mt=n(4787),ft=n(6021),vt=n(576),ht=n(9111),gt=n(7151),yt=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._updateLayer=function(e,n){var r=t.props.map;if(!r.destroyed){var o=n&&r.getDataSource(n.layer);n&&n.dataSource&&(o?e&&r.updateTileDataSource(n.layer,n.dataSource):r.addDataSource(n.layer,n.dataSource));var i=r.getLayers(),a=i.topRasterLayers,s=i.mainLayers,c=[].concat(s,a);if(e){var l=(0,ut.se)(e.layer);c=c.filter((function(e){return!l.includes(e)}))}if(n){var u,d=(0,ut.se)(n.layer);(u=c).push.apply(u,d)}r.setLayers((0,ut.c8)(c,t.props.ymaps3.EventBlockerLayer,t.props.config)),!e||!e.dataSource||n&&n.dataSource||r.removeDataSource(e.layer)}},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._updateLayer(void 0,this.props)},n.componentDidUpdate=function(e){this.props.layer===e.layer&&(0,vt.Z)(e.dataSource,this.props.dataSource)||this._updateLayer(e,this.props)},n.componentWillUnmount=function(){this._updateLayer(this.props)},n.render=function(){return i.createElement(gt.Z,(0,r.Z)({},this.props))},t}(i.Component);const _t=(0,I.ZP)((0,dt.ZP)({shouldWait:!0})(yt));var bt,Et={failIfMajorPerformanceCaveat:!0,antialias:!1,depth:!0,stencil:!0,alpha:!1},wt=[{renderer:/SwiftShader/},{renderer:/Parallels/}];function St(){try{var e=document.createElement("canvas");e.width=1,e.height=1;var t=e.getContext("webgl",Et);if(t)return t}catch(n){}Rt()}function Ct(e){if(void 0===bt){var t=e||St();t?bt=function(e){for(var t=!0,n=[],r=0,o=["requestAnimationFrame","Worker","URL","Blob","XMLHttpRequest","Set","Map"];r<o.length;r++){var i=o[r];window[i]||(t=!1,n.push("WindowPropertyNotExist-".concat(i)))}"function"!=typeof Math.trunc&&(t=!1,n.push("MathTrunc"));0===e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)&&(t=!1,n.push("MAX_VERTEX_TEXTURE_IMAGE_UNITS"));e.getExtension("OES_vertex_array_object")||(t=!1,n.push("OES_vertex_array_object"));e.getExtension("OES_standard_derivatives")||(t=!1,n.push("OES_standard_derivatives"));var a=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);a&&0!==a.precision||(t=!1,n.push("Highp"));(function(e){if(!e)return!1;var t=e.createShader(e.VERTEX_SHADER);if(!t)return!1;e.shaderSource(t,"#version 100\nattribute vec2 p;\nvoid main() {\n    gl_Position = vec4(p,0,1);\n    gl_PointSize = 1.0;\n}"),e.compileShader(t);var n=e.createShader(e.FRAGMENT_SHADER);if(!n)return!1;e.shaderSource(n,"#version 100\nvoid main() {\n    gl_FragColor = vec4(1, 0, 0, 1);\n}"),e.compileShader(n);var r=e.createProgram();if(!r)return!1;e.attachShader(r,t),e.attachShader(r,n),e.bindAttribLocation(r,0,"p"),e.linkProgram(r);var o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0]),e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),e.clearColor(0,1,0,1),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(r),e.drawArrays(e.POINTS,0,1);var i=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,i),e.deleteBuffer(o),e.deleteShader(t),e.deleteShader(n),e.deleteProgram(r),255===i[0]})(e)||(t=!1,n.push("TestPoints"));for(var s=e.getExtension("WEBGL_debug_renderer_info"),c=s&&e.getParameter(s.UNMASKED_VENDOR_WEBGL),l=s&&e.getParameter(s.UNMASKED_RENDERER_WEBGL),u="string"==typeof c?c:"",d="string"==typeof l?l:"",p=navigator.userAgent,m=0,f=wt;m<f.length;m++){if(Pt(f[m],{vendor:u,renderer:d,ua:p})){t=!1,n.push("BlacklistedGpu");break}}return{supported:t,reasonsFailed:n,info:{vendor:u,renderer:d}}}(t):Rt()}return bt}function Zt(){return bt?bt.supported:window.WebGLRenderingContext?(n=navigator.userAgent,!(!(/YandexSearch\//.test(n)||/YaApp/.test(n)||/YaBrowser\/[0-9][0-9.]* YaApp_iOS\/[0-9][0-9.]*/.test(n))&&!/MiuiBrowser\//.test(n)&&/Mac OS X [0-9_]+;.*HTC[_/ ]/.test(n)||/Mac OS X 10_[0-8][^0-9]/.test(navigator.userAgent)||/SamsungBrowser\//.test(n)||(t=null===(e=navigator.userAgent)||void 0===e?void 0:e.match(/WebKit\/?(\d+)/i),Boolean(t&&Number(t[1])<537))||function(){var e,t=null===(e=navigator.userAgent)||void 0===e?void 0:e.match(/Chrome\/(\d+)/i);return!!t&&Number(t[1])<57}())||(Rt(),!1)):(Rt(),!1);var e,t,n}function Rt(){bt={supported:!1,reasonsFailed:["HasWebGl"],info:{}}}function Pt(e,t){return Object.keys(e).every((function(n){var r=e[n],o=t[n];return!r||r.test(o)}))}var kt,It=n(6169),Mt=n(4675),Tt=n(1934),xt="undefined"==typeof window,Lt=[],Dt=0,Nt=3e3,At=2e4;function zt(){xt=!0,Lt.forEach((function(e){return e()})),kt&&kt.disconnect()}function Ut(){var e=window.performance.now();e>At?zt():(Dt?Nt-(e-Dt):Nt)<=0?zt():setTimeout(Ut,1e3)}xt||(0,Tt.Z)((function(){if(!window.PerformanceLongTaskTiming||!window.performance||!window.performance.now)return void setTimeout(zt,5e3);(kt=new window.PerformanceObserver((function(e){var t=e.getEntries().pop();t&&(Dt=t.startTime+t.duration)}))).observe({entryTypes:["longtask"]}),Ut()}));const Ot=function(e){xt?e():Lt.push(e)};var Ft=n(3055),Bt=n(2326),Ht=function(){return Promise.all([n.e("ymaps").then(n.bind(n,2052)),n.e("ymaps").then(n.bind(n,6830)),n.e("ymaps").then(n.t.bind(n,8040,23))]).then((function(e){var t=e[0],n=e[1].EventBlockerLayer,o=e[2];return new Promise((function(e){return setTimeout((function(){return e([(0,r.Z)({},t,{EventBlockerLayer:n}),o.default])}),0)}))}))},qt=function(e,t,r){return function(e,t){return Promise.all([n.e("ymaps-vector").then(n.bind(n,8771)),n.e("ymaps-vector").then(n.t.bind(n,4828,23)),e+new URL(n(2448),n.b).pathname])}(e).then((function(e){var t=e[0],n=e[1],o=e[2];return function(e){return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return st(t.VectorMapEngine,[n.default,o,r||{},e].concat(a))}}}))},Gt=(0,ct.Z)(I.ZP,Bt.ZP),Wt=function(e){function t(t){var n;(n=e.call(this,t)||this)._isMapCreated=!1,n._ymaps3=void 0,n._loadAction=void 0,n._loadDelayStart=void 0,n._ref=i.createRef(),n._location=void 0,n._camera=void 0,n._margin=void 0,n._map=void 0,n._previousWindowMap=void 0,n._onMapUpdateDebounced=void 0,n._filter=void 0,n._onYmaps3Load=function(e){var t=e[0],r=e[1];n._ymaps3=t,t.errorLoggerFactory((function(e){var t=new r;return t.initErrors(e),t.logError})),n._createMap()},n._handleMapLocationRequest=function(e){var t=n._map;if(n._location&&e&&t){var r=n._location,o="bounds"in e?(0,s.$Y)({bounds:e.bounds},n._margin,n._getSize(),n.props.config.uatraits.isMobile||"snap"===t.effectiveZoomRounding):void 0,i=r.center,a=r.zoom;o?i=o.center:"center"in e&&(i=e.center),o?a=o.zoom:"zoom"in e&&e.zoom&&(a=e.zoom),a===r.zoom&&(0,Ie.J)(i,r.center)||t.animateCenterAndZoom(i,a,e.duration||0)}},n._createMap=function(){var e,t,r=n.props,o=n.state,i=n._isElementProvided?r.element:n._ref.current;if(i&&!n._isMapCreated&&n._ymaps3){n._isMapCreated=!0,r.config.query["disable-vector-force"]?(B.Z.set("disable_vector_force",!0),n.setState({isVectorDisabledForce:!0})):B.Z.get("disable_vector_force")&&n.setState({isVectorDisabledForce:!0});var a=r.locationRequest,s=a&&"center"in a&&a.center||r.initialLocation.center,c=a&&"zoom"in a&&a.zoom||r.initialLocation.zoom;n._location={center:s,zoom:c},n._margin=r.marginRequest,n._camera=r.initialCamera||{azimuth:0,tilt:0};var l=(0,ut.mt)(r.config,r.theme),u=n._getMapMode(),d=n._ymaps3.YaMap,p=Object.values(ut.UZ),m=(0,ut.c8)(p,n._ymaps3.EventBlockerLayer,r.config),f=m.topRasterLayers,v=m.mainLayers;i.dir="ltr";var h=new d({mode:u,element:i,center:s,zoom:c,margin:n._margin,zoomRange:r.zoomRange||{min:2,max:21},dataSources:l,topRasterLayers:f,mainLayers:v,behaviors:r.behaviors,zoomRounding:r.zoomRounding,eventObjectsFilter:r.eventObjectsFilter,nonRotatableRasterSources:ut.Iw});if(r.initialCamera&&(r.initialCamera.azimuth||r.initialCamera.tilt)&&h.on("vectorStart",(function(){var e,t;null!==(e=r.initialCamera)&&void 0!==e&&e.azimuth&&(0,Ft.Cm)(h,r.initialCamera.azimuth),null!==(t=r.initialCamera)&&void 0!==t&&t.tilt&&(0,Ft.lp)(h,r.initialCamera.tilt)})),window.yandex_map=h,h.events.clickTimeout=300,h.events.waitHotspotsTimeout=1e3,(0,lt.r1)().has.touch?n._ymaps3.loadHotspotsForViewport(h):n._ymaps3.loadHotspotsByPointerPosition(h),r.vector&&r.config.isVectorEnabled&&!o.isVectorDisabledForce)if(Zt()){var g=qt(r.config.baseUrl,r.config.experiments.ui),y=new Promise((function(e,t){setTimeout((function(){var n=St();n&&Ct(n).supported||t(new Error("Vector is not supported")),e(n)}))}));Promise.all([g,y]).then((function(e){var t=e[0],n=e[1];h.destroyed||h.provideVectorMapEngineFactory(t(n))})).catch((function(){n.setState({isVectorSupported:!1})}))}else n.setState({isVectorSupported:!1});n._map=h,n._onMapUpdate(),n._onZoomRoundingChange(),n._onMapSizeChange(),n._addFilter(),null===(e=(t=n.props).onMarginChange)||void 0===e||e.call(t,n._margin||[0,0,0,0]),r.onReady&&r.onReady(h),n._handleMapLocationRequest(a),n.forceUpdate()}},n._addFilter=function(){var e=n.props.getFilter;e&&(n._filter=e(n._ymaps3),n._map.addObjectFilter(n._filter))},n._onMapUpdate=function(){var e=n._map;if(!e.isInAction){var t,r,o=[e.center[0],e.center[1]],i=n._location.zoom!==e.zoom||!(0,Ie.J)(n._location.center,o);if(!(0,vt.Z)(n._margin,e.margin))n._margin=e.margin,null===(t=(r=n.props).onMarginChange)||void 0===t||t.call(r,e.margin);i&&(n._location={zoom:Math.round(100*e.zoom)/100,center:o},n._onLocationChange()),n._camera.azimuth===e.azimuth&&n._camera.tilt===e.tilt||(n._camera={azimuth:e.azimuth,tilt:e.tilt},n.props.onCameraChange&&n.props.onCameraChange(n._camera))}},n._onLocationChange=function(){var e=n.props.onLocationChange;if(e){var t=(0,s.$Y)(n._location,n._margin,n._getSize()),o=t.bounds,i=t.span;e((0,r.Z)({},n._location,{bounds:o,span:i}))}},n._onMapSizeChange=function(){n.props.onSizeChange&&n.props.onSizeChange(n._getSize(),n._map.offset),n._onLocationChange()},n._getSize=function(){var e=n._map.size;return{width:e.x,height:e.y}},n._onResize=function(){var e=n._map;e&&e.resize()},n._onDragStart=function(){n.setState({isDragged:!0})},n._onDragEnd=function(){n.setState({isDragged:!1})},n._onZoomRoundingChange=function(){n.props.onZoomRoundingChange&&n._map&&n.props.onZoomRoundingChange(n._map.effectiveZoomRounding)},n._onThemeChange=function(){var e=n.props,t=n._map,r=(0,ut.mt)(e.config,e.theme);Object.entries(r).filter((function(e){return"tile"===e[1].type})).forEach((function(e){var n=e[0],r=e[1];null==t||t.updateTileDataSource(n,r)}))},n._renderLayers=function(){var e=n.props;return"satellite"===e.type?i.createElement(_t,{layer:"sat"}):"hybrid"===e.type?i.createElement(i.Fragment,null,i.createElement(_t,{layer:"sat"}),i.createElement(_t,{layer:"skl",onClick:e.onPoiClick,shouldHover:function(){return Boolean(e.isPoiEnabled||e.isHoverForceEnabled)}})):i.createElement(i.Fragment,null,i.createElement(_t,{layer:"map",onClick:e.onPoiClick,shouldHover:function(){return Boolean(e.isPoiEnabled||e.isHoverForceEnabled)}}),!e.disablePersonalizedPoi&&!e.config.bunker.disablePersonalizedPoi&&e.config.authorization&&e.config.hosts.tilesApi?i.createElement(_t,{layer:"personalizedPoi",onClick:e.onPoiClick,shouldHover:function(){return Boolean(e.isPoiEnabled||e.isHoverForceEnabled)}}):null)},n.state={isDragged:!1,isVectorSupported:!0,isVectorDisabledForce:!1};var o=n.props.updateTimeout||300;return n._onMapUpdateDebounced=(0,ht.Z)(n._onMapUpdate,o),"undefined"!=typeof window&&(t.delayLoad?(n._loadDelayStart=Date.now(),(0,Mt.J3)("mapLoadDelay",n._loadDelayStart),Ot((function(){n._loadAction||((0,Mt.J3)("mapLoadDelayCompleted",Date.now()-n._loadDelayStart),n._loadAction=p.Z.create(Ht(),{success:n._onYmaps3Load}))}))):n._loadAction=p.Z.create(Ht(),{success:n._onYmaps3Load})),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._createMap(),this._previousWindowMap=window.yandex_map},n.componentDidUpdate=function(e){!e.delayLoad||this.props.delayLoad||this._loadAction||((0,Mt.J3)("mapLoadDelayAborted",Date.now()-this._loadDelayStart),this._loadAction=p.Z.create(Ht(),{success:this._onYmaps3Load}));var t=this._map;if(!t)return this._createMap();var n=this.props;n.behaviors&&!(0,vt.Z)(n.behaviors,e.behaviors)&&t.behaviors.setEnabled(n.behaviors);var r=n.locationRequest;r!==e.locationRequest&&this._handleMapLocationRequest(r),(0,vt.Z)(n.marginRequest,e.marginRequest)||t.setMargin(n.marginRequest);var o=this._getMapMode();t.setMode(o),n.getFilter!==e.getFilter&&(this._filter&&(t.removeObjectFilter(this._filter),this._filter=void 0),this._addFilter()),e.theme!==n.theme&&this._onThemeChange()},n.componentWillUnmount=function(){p.Z.cancel(this._loadAction),this._onMapUpdateDebounced.cancel(),this._map&&this._map.destroy(),window.yandex_map=this._previousWindowMap||window.yandex_map},n._getMapMode=function(){var e=this.state.isVectorSupported&&this.props.vector&&this.props.config.isVectorEnabled&&!this.state.isVectorDisabledForce,t=this.props.config.uatraits.isMobile;return e?t?"vector":"auto":"raster"},n.render=function(){var e=this.props,t=this.state;return i.createElement(i.Fragment,null,this._isElementProvided?null:i.createElement("div",{className:e.className,ref:this._ref}),i.createElement(dt.Ib,{value:{map:this._map,ymaps3:this._ymaps3}},this._renderLayers(),i.createElement(pt.Z,{onUpdate:this._onMapUpdateDebounced,onDragStart:this._onDragStart,onInertiaStart:this._onDragEnd,onDragEnd:this._onDragEnd,onResize:this._onMapSizeChange,onZoomRoundingChanged:this._onZoomRoundingChange}),e.children,this.state.isDragged?i.createElement(It.Z,{cursor:"grabbing"}):null),i.createElement(mt.Z,{onResize:this._onResize}),i.createElement(ft.Z,{type:"resize",listener:this._onResize}),t.isVectorDisabledForce?i.createElement(Oe.ZP,{name:"disable_vector_force"}):null)},(0,it.Z)(t,[{key:"_isElementProvided",get:function(){return"element"in this.props}}]),t}(i.Component);const jt=Gt(Wt);var Vt,Yt=n(7473),Kt=n.n(Yt),$t=n(9705),Xt=["layer"],Qt={getLayers:function(e,t){var n=(Vt=Vt||{}).requests||[],r=n.push(function(e,t){return{layerIds:e.layers,center:e.center?(0,$t.s)(e.center,{fractionDigits:8}):void 0,zoom:e.zoom&&Math.round(e.zoom),span:e.span?(0,$t.s)(e.span,{fractionDigits:8}):void 0,locale:t.locale,lang:t.lang}}(e,t))-1,o=Vt.promise||function(e){return new Promise((function(t,n){Kt()((function(){var r=Vt.requests;Vt=void 0,function(e,t){return(0,P.Z)("layers/info",{query:{requests:e}},t)}(r,e).then(t).catch(n)}))}))}(t);return Vt={promise:o,requests:n},o.then((function(e){return e[r]}))},getLayer:function(e,t){var n=e.layer,o=(0,Ve.Z)(e,Xt);return o.zoom&&!Jt(n,o.zoom,t)?Promise.resolve(void 0):Qt.getLayers((0,r.Z)({layers:[n]},o),t).then((function(e){return e[n]}))},checkStaticZoomRange:Jt};function Jt(e,t,n){var r=n.layers[e];if(!r)return!0;var o="zoomRange"in r&&r.zoomRange;return!o||t>=o[0]&&t<=o[1]}const en=Qt;const tn=(0,ct.Z)(I.ZP,(0,dt.ZP)({shouldWait:!0}))(function(e){function t(t){var n;return(n=e.call(this,t)||this)._updateDebounced=void 0,n._loadAction=void 0,n._update=function(){var e=n.props,t=e.map.getLayers(),r=t.topRasterLayers,o=t.mainLayers,i=[].concat(r,o).map((function(e){return e.split(":")[0]})),a=ut.Hi.filter((function(e){return i.includes(e)}));p.Z.cancel(n._loadAction);var s=(0,vt.Z)(a,["map"])?Promise.resolve({map:{copyrights:["© Яндекс"]}}):en.getLayers({layers:a,center:e.map.center,zoom:e.map.zoom},e.config);n._loadAction=p.Z.create(s,{success:n._onDataLoad})},n._onDataLoad=function(e){var t=n.props.map;Object.entries(e).forEach((function(e){var n=e[0],o=e[1];if(o){var i=t.getDataSource(n),a=(0,r.Z)({},i);if("zoomRange"in o&&o.zoomRange){var s=o.zoomRange,c=s[0],l=s[1];a.zoomRange={min:c,max:l}}a.copyrights="copyrights"in o?o.copyrights:void 0,(0,vt.Z)(i,a)||t.updateTileDataSource(n,a)}}))},n._updateDebounced=(0,ht.Z)(n._update,500),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._updateDebounced()},n.componentWillUnmount=function(){this._updateDebounced.cancel(),p.Z.cancel(this._loadAction)},n.render=function(){return i.createElement(pt.Z,{onUpdate:this._updateDebounced})},t}(i.Component));var nn=["map","indoor","personalizedPoi"],rn=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._loaderAction=void 0,t._loadFile=function(){var e=t.props,n=e.config.staticHost+"static/v39/map-customizations/"+e.name+".json";p.Z.cancel(t._loaderAction),t._loaderAction=p.Z.create((0,R.Z)({url:n,parser:"json"}),{success:t._setMapCustomization})},t._setMapCustomization=function(e){var n;void 0===e&&(e={});var r=t.props;(null!==(n=r.dataSourceIds)&&void 0!==n?n:nn).forEach((function(t){var n=r.map.getDataSource(t);n&&"tile"===n.type&&r.map.updateTileDataSource(t,(0,ut._I)(n,e))}))},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._loadFile()},n.componentDidUpdate=function(e){this.props.name!==e.name&&this._loadFile()},n.componentWillUnmount=function(){this._setMapCustomization(),p.Z.cancel(this._loaderAction)},n.render=function(){return null},t}(i.PureComponent);const on=(0,I.ZP)((0,dt.ZP)({shouldWait:!0})(rn));var an=n(3907),sn=n(366),cn="_vector_ready",ln=["drag","dblClick","magnifier","oneFingerZoom","pinchZoom"],un=["scrollZoom"],dn=["mouseRotate","pinchRotate","mouseTilt","panTilt"],pn=(0,ze.Z)("map-widget-map-component"),mn=function(e){function t(t){var n;return(n=e.call(this,t)||this)._map=void 0,n._onReady=function(e){window.document.body.classList.add("_map_ready"),n._map=e,n.setState({isReady:!0})},n._getBehaviors=function(){var e;return[].concat(ln,null!==(e=n.props.config.flyover)&&void 0!==e&&e.isEnabled?dn:[],n.props.config.isScrollDisabled?[]:un)},n._onMainEngineChanged=function(){var e;"vector"!==(null===(e=n._map)||void 0===e?void 0:e.getEffectiveMode())||window.document.body.classList.contains(cn)||window.document.body.classList.add(cn)},n._setFlyoverActive=function(e){n.state.flyover.isFlyoverActive!==e&&n.setState((function(t){return{flyover:(0,r.Z)({},t.flyover,{isFlyoverActive:e})}}))},n._setTile3dLayerInitialized=function(){n.state.flyover.isLayerInitialized||n.setState((function(e){return{flyover:(0,r.Z)({},e.flyover,{isLayerInitialized:!0})}}))},n.state={isReady:!1,flyover:{isFlyoverActive:!1,isLayerInitialized:!1,setFlyoverActive:n._setFlyoverActive,setLayerInitialized:n._setTile3dLayerInitialized}},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e,t=this.props,n=(null===(e=t.config.flyover)||void 0===e?void 0:e.isEnabled)&&this.state.flyover.isLayerInitialized;return i.createElement(jt,{className:pn(),type:t.config.mapType,initialLocation:t.location,vector:t.config.isVectorEnabled,isPoiEnabled:t.isPoiEnabled,onReady:this._onReady,locationRequest:t.locationRequest,marginRequest:t.margin,onPoiClick:t.onPoiClick,onLocationChange:t.onLocationChange,onSizeChange:t.onSizeChange,behaviors:this._getBehaviors()},i.createElement(tn,null),n?i.createElement(i.Fragment,null,i.createElement(sn.Z,null),i.createElement(on,{name:"realty",dataSourceIds:["map"]})):null,this.state.isReady?i.createElement(an.v6,{value:this.state.flyover},t.children):null,i.createElement(pt.Z,{onMainEngineChanged:this._onMainEngineChanged}))},t}(i.Component);const fn=(0,I.ZP)(mn);var vn=n(3128);function hn(e,t){var n,r,o,i,a,s,c,l,u,d,p=0,m="FeatureCollection"===e.type,f="Feature"===e.type,v=m?e.features.length:1;for(n=0;n<v;n++){for(s=m?e.features[n].geometry:f?e.geometry:e,l=m?e.features[n].properties:f?e.properties:{},u=m?e.features[n].bbox:f?e.bbox:void 0,d=m?e.features[n].id:f?e.id:void 0,a=(c=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=c?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,p,l,u,d))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===t(i.geometries[r],p,l,u,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,p,l,u,d))return!1;p++}}var gn=6378137;function yn(e){return function(e,t,n){var r=n;return hn(e,(function(e,o,i,a,s){r=0===o&&void 0===n?e:t(r,e,o,i,a,s)})),r}(e,(function(e,t){return e+function(e){var t,n=0;switch(e.type){case"Polygon":return _n(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)n+=_n(e.coordinates[t]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)}),0)}function _n(e){var t=0;if(e&&e.length>0){t+=Math.abs(bn(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(bn(e[n]))}return t}function bn(e){var t,n,r,o,i,a,s=0,c=e.length;if(c>2){for(a=0;a<c;a++)a===c-2?(r=c-2,o=c-1,i=0):a===c-1?(r=c-1,o=0,i=1):(r=a,o=a+1,i=a+2),t=e[r],n=e[o],s+=(En(e[i][0])-En(t[0]))*Math.sin(En(n[1]));s=s*gn*gn/2}return s}function En(e){return e*Math.PI/180}var wn=n(1886),Sn=n(8447),Cn=n(9657),Zn=n(1421),Rn=n(7937),Pn=n(7225),kn=n(8696),In=n(1745),Mn=(0,ze.Z)("ruler-balloon"),Tn={main:10,side:0},xn={"delete-points":{title:"Удалить все точки?",description:"Чтобы удалить только одну точку, нажмите на неё дважды.",confirmation:"Удалить все"},close:{title:"Выключить линейку?",description:"Вы уверены, что хотите удалить все точки и выключить линейку?",confirmation:"Выключить"}};const Ln=function(e){function t(t){var n;return(n=e.call(this,t)||this)._clearAndDisableRuler=function(){var e,t;(n.props.deletePoints(),n.props.isEnabled)&&(null===(e=(t=n.props).switchRuler)||void 0===e||e.call(t))},n._openPopup=function(e){n.setState({popupType:e})},n._closePopup=function(){n.setState({popupType:null})},n._clearRuler=function(){n.props.deletePoints()},n._renderPopup=function(){var e=n.state.popupType;if(!e)return null;var t=n.props;return i.createElement(Pn.Z,{coordinates:t.coordinates,position:["top","bottom","left","right"],offset:Tn,showArrow:!1,isShown:!0},i.createElement(Oe.ZP,{name:"popup",nodeState:{type:e}},i.createElement("div",{className:Mn("popup")},i.createElement("div",{className:Mn("title")},xn[e].title),i.createElement("div",{className:Mn("description")},xn[e].description),i.createElement("div",{className:Mn("buttons")},i.createElement("div",{className:Mn("confirm")},i.createElement(Oe.ZP,{name:"confirm",logClick:!0},i.createElement(kn.Z,{ariaHidden:!0,view:"primary",size:"small",onClick:"delete-points"===e?n._clearRuler:n._clearAndDisableRuler},xn[e].confirmation))),i.createElement("div",{className:Mn("cancel")},i.createElement(Oe.ZP,{name:"cancel",logClick:!0},i.createElement(kn.Z,{ariaHidden:!0,view:"secondary-blue",size:"small",onClick:n._closePopup},"Отмена")))))))},n._renderTooltip=function(){return i.createElement("div",{className:Mn("tooltip-wrapper")},i.createElement("div",{className:Mn("tooltip")},i.createElement("div",{className:Mn("label")},Rn.jq(n.props.value,n.props.measure),"quadratic"===n.props.measure?"²":null),n._renderControls()))},n._renderControls=function(){return n.props.showControls?i.createElement(Oe.ZP,{name:"controls"},i.createElement("div",{className:Mn("controls")},i.createElement(In.Z,{text:"Удалить точки",position:"bottom",size:"s",isAir:!0},i.createElement(Oe.ZP,{name:"remove_all_points",logClick:!0},i.createElement("div",{className:Mn("icon",{type:"trash"}),onClick:function(){return n._openPopup("delete-points")}},i.createElement(He.Z,{name:"trash-12",className:Mn("icon-icon"),inline:!0})))),n.props.isEnabled?i.createElement(In.Z,{text:"Удалить точки и закрыть",position:"bottom",size:"s",isAir:!0},i.createElement(Oe.ZP,{name:"turn_off_ruler",logClick:!0},i.createElement("div",{className:Mn("icon",{type:"close"}),onClick:function(){return n._openPopup("close")}},i.createElement(He.Z,{name:"cross-small-12",className:Mn("icon-inner"),inline:!0})))):null,n.props.isEnabled?i.createElement(In.Z,{text:"Завершить редактирование",position:"bottom",size:"s",isAir:!0},i.createElement(Oe.ZP,{name:"stop_editing",logClick:!0},i.createElement("div",{className:Mn("icon",{type:"stop-editing"}),onClick:function(){var e,t;return null===(e=(t=n.props).switchRuler)||void 0===e?void 0:e.call(t)}},i.createElement(He.Z,{name:"done-12",className:Mn("icon-inner"),inline:!0})))):i.createElement(In.Z,{text:"Добавить точки",position:"bottom",size:"s",isAir:!0},i.createElement(Oe.ZP,{name:"start_editing",logClick:!0},i.createElement("div",{className:Mn("icon",{type:"stop-editing"}),onClick:function(){var e,t;return null===(e=(t=n.props).switchRuler)||void 0===e?void 0:e.call(t)}},i.createElement(He.Z,{name:"edit-12",className:Mn("icon-inner"),inline:!0})))))):null},n.state={popupType:null},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(Ue.Z,{coordinates:e.coordinates,zIndex:Fe.I.ruler+1,dataSourceId:e.dataSourceId,blockEvents:!0,draggable:e.draggable,cursor:e.draggable?"grab":void 0,onDragStart:e.onDragStart,onDragMove:e.onDragMove,onDragEnd:e.onDragEnd},i.createElement("div",{className:Mn()},this.state.popupType?this._renderPopup():this._renderTooltip()))},t}(i.Component);var Dn=n(555),Nn=n(5900);function An(e,t){var n=t[0],r=t[1],o=[n[1]-r[1],r[0]-n[0],n[0]*r[1]-r[0]*n[1]],i=[o[1],-o[0],e[1]*o[0]-e[0]*o[1]],a=o[0]*i[1]-i[0]*o[1];return[(i[2]*o[1]-o[2]*i[1])/a,(i[0]*o[2]-o[0]*i[2])/a]}function zn(e,t,n){var r=t[0],o=t[1],i=n[0]-r,a=n[1]-o,s=i*i+a*a,c=0;0!==s&&(c=((e[0]-r)*i+(e[1]-o)*a)/s,c=Math.max(0,Math.min(1,c)));var l=r+c*i,u=o+c*a,d=e[0]-l,p=e[1]-u;return Math.sqrt(d*d+p*p)}function Un(e,t,n,r,o){for(var i=0;i<e.length-1;i++){var a=[e[i],e[i+1]];if(zn((0,Nn.f)(t,r),(0,Nn.f)(a[0],r),(0,Nn.f)(a[1],r))<n/2){var s=An(t,[a[0],a[1]]);return o?{point:s,segmentIndex:i}:s}}}var On,Fn=(0,ze.Z)("map-line-editor"),Bn=Fe.I.editing-3,Hn=Fe.I.editing-1,qn=Fe.I.editing-2,Gn=function(e){function t(t){var n;return(n=e.call(this,t)||this)._setLayers=function(e){var t=n.props.map,r=t.getLayers(),o=r.topRasterLayers,i=r.mainLayers,a=[].concat(o,i),s=n.props.config.uatraits.isMobile?"click":"fastclick";n.props.editorLayerOwner?(a.push(ut.Il),On=n.props.editorLayerOwner,t.events.on(s,ut.Il,n._onEditorLayerClick)):e&&(e.editorLayerOwner===On&&(a=a.filter((function(e){return e!==ut.Il})),On=void 0),t.events.off(s,ut.Il,n._onEditorLayerClick)),t.setLayers((0,ut.c8)(a,n.props.ymaps3.EventBlockerLayer,n.props.config))},n._onEditorLayerClick=function(e,t){n.props.onPointAdd(t.coordinates,n.props.points.length)},n._updatePoint=function(e,t,r){n.props.onPointUpdate&&void 0!==t&&n.props.onPointUpdate(e,t,Boolean(r))},n._onMouseMove=function(e){var t=n.props.map.convertScreenToWorldCoordinates(e).coordinates;if(n.props.onLineMouseMove&&n.props.onLineMouseMove(e,{coordinates:t}),n.props.polyLineCoordinates&&n.props.isActive&&void 0===n.state.draggingPoint){var r=Math.max.apply(Math,n.props.lineStyle.stroke.map((function(e){return e.width||0}))),o=Un(n.props.polyLineCoordinates,t,r,n.props.map.zoom,!0);o&&"point"in o&&n.setState({previewPoint:o})}},n._onNewPointDragStart=function(){var e=n.state,t=n.props;if(e.previewPoint){var r=function(e,t,n){for(var r=0,o=15e-7,i=0;i<e.length-1;i++){var a=t[r];if(a&&(0,Ie.J)(a,e[i],o)&&(r+=1),i===n)return r}return r}(t.polyLineCoordinates,t.points,e.previewPoint.segmentIndex)||void 0;void 0!==r&&e.previewPoint.point&&(n.setState({draggingPoint:{index:r,point:e.previewPoint.point}}),t.onPointAdd(e.previewPoint.point,r))}},n._onExistingPointDragStart=function(e){n.props.points[e]&&n.setState({draggingPoint:{index:e,point:n.props.points[e]}})},n._onDragMove=function(e){var t=e.coordinates,r=n.state;r.draggingPoint&&(n.setState({draggingPoint:{index:r.draggingPoint.index,point:t}}),n._updatePoint(t,r.draggingPoint.index))},n._onDragEnd=function(e){var t=e.coordinates,r=n.state;r.draggingPoint&&(n.setState({draggingPoint:void 0,previewPoint:void 0}),n._updatePoint(t,r.draggingPoint.index,!0))},n._onPointDoubleClick=function(e){n.props.isActive&&n.props.onPointRemove&&n.props.onPointRemove(e)},n._onPointClick=function(e){n.props.onPointClick&&n.props.onPointClick(e)},n._renderDraggingOrPreviewPoint=function(){var e=n.state,t=n.props,r=e.draggingPoint||e.previewPoint;if(!r||!t.isActive||t.config.uatraits.isMobile)return null;var o="segmentIndex"in r;return i.createElement(Ue.Z,{coordinates:r.point,onDragStart:n._onNewPointDragStart,onDragMove:n._onDragMove,onDragEnd:n._onDragEnd,onMouseMove:n._onMouseMove,onMouseLeave:t.onPreviewPointMouseLeave,onClick:t.onPreviewPointClick,zIndex:o?Bn:Hn,draggable:t.isActive,dataSourceId:ut.UZ[t.editorLayerOwner?"EDITOR_MARKERS":"DEFAULT_MARKERS"],blockEvents:!0},o?i.createElement("div",{className:Fn("preview-point")},t.previewPointElement):n.props.renderPointElement("index"in r&&r.index||0))},n._renderPoints=function(){return n.props.points.map((function(e,t){return i.createElement(Ue.Z,{key:t,onDragStart:function(){return n._onExistingPointDragStart(t)},onDragMove:n._onDragMove,onDragEnd:n._onDragEnd,onDoubleClick:function(){return n._onPointDoubleClick(t)},onClick:function(){return n._onPointClick(t)},coordinates:e,draggable:n.props.isActive,zIndex:qn,dataSourceId:ut.UZ[n.props.editorLayerOwner?"EDITOR_MARKERS":"DEFAULT_MARKERS"],blockEvents:!0,nonInteractive:!n.props.isActive},n.state.draggingPoint&&n.state.draggingPoint.index===t?null:n.props.renderPointElement(t))}))},n.state={},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._setLayers()},n.componentDidUpdate=function(e){e.editorLayerOwner!==this.props.editorLayerOwner&&this._setLayers(e)},n.render=function(){var e=this.props.editorLayerOwner?"EDITOR_GRAPHICS":"RASTER_GRAPHICS";return i.createElement(i.Fragment,null,this._renderDraggingOrPreviewPoint(),this._renderPoints(),i.createElement(Dn.Z,{drawingStyle:this.props.lineStyle,geometry:{type:"LineString",coordinates:this.props.polyLineCoordinates},onMouseMove:this._onMouseMove,onMouseEnter:this.props.onLineMouseEnter,onMouseLeave:this.props.onLineMouseLeave,dataSourceId:ut.UZ[e],onClick:this.props.onPreviewPointClick}))},t}(i.Component);const Wn=(0,dt.ZP)({shouldWait:!0})((0,I.ZP)(Gn));var jn=n(8623),Vn={stroke:[{color:"#666",width:3,opacity:.7},{color:"#fff",width:5,opacity:.7}],fillOpacity:0,simplificationRate:0,cursor:"pointer",zIndex:21},Yn={stroke:[{color:"#666",width:0,opacity:0}],fill:"#666",fillOpacity:.3,simplificationRate:0,cursor:"grab",zIndex:20},Kn=(0,ze.Z)("ruler-view"),$n=function(e){function t(t){var n;if((n=e.call(this,t)||this)._referencePointPositions=[],n._area=0,n._getGeometryApproximateCenter=function(e){var t=(0,wn.o)(e),n=(0,Sn.t)(t[0],t[1]);return(0,Cn.S)(t[0],n.startDirection,n.distance/2).endPoint},n._caclGeodesicLine=function(e){var t=e[0],r=e.slice(1);return("area"===n.props.type&&t?[].concat(r,[t]):r).reduce((function(e,t){return[].concat(e,(0,Zn.b)((0,jn.g)([e.pop(),t])))}),t?[t]:[])},n._onPointAdd=function(e,t){n._updatePoints(t,e)},n._onPointUpdate=function(e,t){n._updatePoints(t,e,!0)},n._onPointRemove=function(e){n._updatePoints(e,void 0,!0)},n._calcArea=function(e){return e.length>2?yn({type:"Polygon",coordinates:[n._caclGeodesicLine(e.map((function(e){return e.coordinates})))]}):0},n._updatePoints=function(e,t,o){if(n.props.onUpdate){var i=n.props.draggedPoints||n.props.points,a=i.slice(0,e);if(t&&a.push({coordinates:t,value:Xn(t,a[a.length-1]),showBalloon:i[e]&&i[e].showBalloon}),i.slice(e+(o?1:0)).forEach((function(e){a.push((0,r.Z)({},e,{value:Xn(e.coordinates,a[a.length-1])}))})),n._area=n._calcArea(a),a.length>1){var s=n._getGeometryApproximateCenter(a.map((function(e){return e.coordinates})));s&&(n._referencePointPositions=a.map((function(e){return(0,Sn.t)(s,e.coordinates)})))}n.props.onUpdate(a,a)}},n._togglePointBalloon=function(e){if(n.props.onUpdate){var t=n.props.points,o=(0,r.Z)({},t[e],{showBalloon:!t[e].showBalloon}),i=[].concat(t.slice(0,e),[o],t.slice(e+1));n.props.onUpdate(i)}},n._applyDragEvent=function(e){var t=n.props;if(t.onUpdate){var o=(t.draggedPoints||t.points).map((function(t,o){return(0,r.Z)({},t,{coordinates:(0,Cn.S)(e,n._referencePointPositions[o].startDirection,n._referencePointPositions[o].distance).endPoint})}));t.onUpdate(t.points,o)}},n._onBalloonDrag=function(e){var t=n.props,r=t.draggedPoints||t.points,o=(0,Sn.t)(r[r.length-1].coordinates,e.coordinates),i=n._getGeometryApproximateCenter(r.map((function(e){return e.coordinates}))),a=(0,Cn.S)(i,o.endDirection,o.distance).endPoint;n._applyDragEvent(a)},n._onFeatureDrag=function(e){if(n.props.onUpdate){var t=n._getGeometryApproximateCenter(e.coordinates[0]);t&&n._applyDragEvent(t)}},n._onFeatureDragStart=function(e){n.setState({isDragging:!0}),n._onFeatureDrag(e)},n._onFeatureDragEnd=function(e){n.setState({isDragging:!1}),n._onFeatureDrag(e)},n._renderBalloon=function(e,t){var r=t===n.props.points.length-1,o="area"===n.props.type;if(o&&!r)return null;if(0===t||!e.showBalloon&&!r)return null;var a=o?n._area:e.value;return i.createElement(Ln,{key:t,coordinates:e.coordinates,value:a,measure:o?"quadratic":"linear",showControls:r,dataSourceId:n.props.isEnabled?ut.UZ.EDITOR_MARKERS:void 0,isEnabled:n.props.isEnabled,switchRuler:n.props.switchRuler,deletePoints:n.props.deletePoints,draggable:o&&Boolean(n.props.onUpdate),onDragStart:n._onBalloonDrag,onDragMove:n._onBalloonDrag,onDragEnd:n._onBalloonDrag})},n._renderPoint=function(){return i.createElement("div",{className:Kn("point")},i.createElement(He.Z,{name:"point"}))},n.state={geodesicLine:n._caclGeodesicLine(n.props.points.map((function(e){return e.coordinates}))),isDragging:!1},n.props.points.length>1){var o=n._getGeometryApproximateCenter(n.props.points.map((function(e){return e.coordinates})));o&&(n._referencePointPositions=n.props.points.map((function(e){return(0,Sn.t)(o,e.coordinates)})))}return n._area=n._calcArea(n.props.points),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){if(e.points!==this.props.points||e.type!==this.props.type||this.props.draggedPoints!==e.draggedPoints){var t=this.props.draggedPoints||this.props.points;this.setState({geodesicLine:this._caclGeodesicLine(t.map((function(e){return e.coordinates})))})}},n.render=function(){var e=this.props.draggedPoints||this.props.points,t="area"===this.props.type;return i.createElement(i.Fragment,null,t?i.createElement(Dn.Z,{drawingStyle:(0,r.Z)({},Yn,{cursor:this.state.isDragging?"grabbing":"grab"}),geometry:{type:"Polygon",coordinates:[this.state.geodesicLine]},draggable:Boolean(this.props.onUpdate),onDragStart:this._onFeatureDragStart,onDragMove:this._onFeatureDrag,onDragEnd:this._onFeatureDragEnd,dataSourceId:this.props.isEnabled?ut.UZ.EDITOR_GRAPHICS:ut.UZ.RASTER_GRAPHICS}):null,i.createElement(Wn,{previewPointElement:i.createElement("div",{className:Kn("preview-point")}),renderPointElement:this._renderPoint,polyLineCoordinates:this.state.geodesicLine,points:e.map((function(e){return e.coordinates})),lineStyle:Vn,isActive:Boolean(this.props.onUpdate),onPointAdd:this._onPointAdd,onPointUpdate:this._onPointUpdate,onPointRemove:this._onPointRemove,onPointClick:this._togglePointBalloon,editorLayerOwner:this.props.isEnabled?"ruler":void 0}),e.map(this._renderBalloon))},t}(i.Component);function Xn(e,t){return t?t.value+(0,L.t)(e,t.coordinates):0}$n.displayName="RulerComponent";const Qn=(0,I.ZP)($n);var Jn=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(Qn,{type:e.ruler.type,points:e.ruler.points,isEnabled:e.ruler.isEnabled,onUpdate:function(t){return e.updateRuler({points:t})},deletePoints:function(){return e.updateRuler({points:[]})},switchRuler:function(){return e.updateRuler({isEnabled:!e.ruler.isEnabled})}})},t}(i.Component);const er=Jn;var tr=n(1596),nr=n(6600),rr=n(8769),or=(0,ze.Z)("traffic-road-event-content-view"),ir=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=this.props.event;if(!t.position)return null;var n=t.time_start||t.time_end,r=t.time_start_value&&t.tzOffset&&(0,F.wQ)(new Date(1e3*Number(t.time_start_value)),t.tzOffset)||void 0,o=t.time_end_value&&t.tzOffset&&(0,F.wQ)(new Date(1e3*Number(t.time_end_value)),t.tzOffset)||void 0;return i.createElement("div",{className:or()},i.createElement("div",{className:or("title")},(0,rr.t0)(this.props.event.type||"other")),t.description?i.createElement("div",{className:or("description"),dangerouslySetInnerHTML:{__html:t.description}}):null,n?i.createElement("div",{className:or("time"),dangerouslySetInnerHTML:{__html:r&&o?(0,nr.o0)(r,e.config)+" &mdash; "+(0,nr.o0)(o,e.config):r?(0,nr.o0)(r,e.config):""}}):null,t.author?i.createElement("div",{className:or("source")},i.createElement("span",{className:or("source-label")},"Источник"),t.link?i.createElement("a",{className:or("source-link"),href:t.link.href,target:"_blank"},t.author.name):null):null)},t}(i.Component);const ar=(0,I.ZP)(ir);function sr(e){var t,n;return(null===(t=e.query.l)||void 0===t?void 0:t.includes("trfe"))||(null===(n=e.userMap)||void 0===n?void 0:n.isTrafficShown)}function cr(e){return"atm"===e.query.rtm}function lr(e){var t;return null!==(t={auto:"auto",mt:"masstransit",pd:"pedestrian",bc:"bicycle"}[e.query.rtt])&&void 0!==t?t:"auto"}var ur=function(e){function t(t){var n,r,o;return(o=e.call(this,t)||this)._loadStaticLayerAction=void 0,o._updateVersionFromStaticLayers=function(e){e.trf&&e.trfe&&o.setState({actualVersion:e.trf.version,roadEventsVersion:e.trfe.version})},o.state={actualVersion:null===(n=t.config.layers.trf)||void 0===n?void 0:n.version,roadEventsVersion:null===(r=t.config.layers.trfe)||void 0===r?void 0:r.version},o}(0,o.Z)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),p.Z.cancel(this._loadStaticLayerAction)},n._shouldUpdateLayer=function(e){return e.mapLocation!==this.props.mapLocation},n._updateLayer=function(){e.prototype._updateLayer.call(this),this._updateStaticLayer()},n._onLayerLoad=function(e){var t,n,r=k.actual.getLevel(e.timezone.ids,this.props.config);null===(t=(n=this.props).onLayerLoaded)||void 0===t||t.call(n,e),this._loadLevel(r)},n._updateStaticLayer=function(){p.Z.cancel(this._loadStaticLayerAction),this._loadStaticLayerAction=p.Z.create(en.getLayers({layers:["trf","trfe"]},this.props.config),{success:this._updateVersionFromStaticLayers})},n.render=function(){var e=this.state;return this.props.children({actualVersion:e.actualVersion,roadEventsVersion:e.roadEventsVersion})},t}(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._loadLayerAction=void 0,t._loadLevelAction=void 0,t._updateTimer=-1,t._onLayerDataLoad=function(e){var n,r,o=t.props;e&&e.timezone?null===(n=(r=t)._onLayerLoad)||void 0===n||n.call(r,e):o.onTrafficLevelChange(null)},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this._updateLayer(),this._updateTimer=window.setInterval((function(){return e._updateLayer()}),12e4)},n.componentDidUpdate=function(e){this._shouldUpdateLayer(e)&&this._updateLayer()},n.componentWillUnmount=function(){window.clearInterval(this._updateTimer),p.Z.cancel(this._loadLayerAction),p.Z.cancel(this._loadLevelAction)},n._loadLevel=function(e){p.Z.cancel(this._loadLevelAction);var t=this.props;this._loadLevelAction=p.Z.create(e,{success:function(e){return t.onTrafficLevelChange(e.level)},fail:function(){return t.onTrafficLevelChange(null)}})},n._updateLayer=function(){p.Z.cancel(this._loadLayerAction),this._loadLayerAction=p.Z.create(en.getLayer({layer:"trf",center:this.props.mapLocation.center,zoom:this.props.mapLocation.zoom},this.props.config),{success:this._onLayerDataLoad})},t}(i.Component));const dr=(0,I.ZP)(ur);var pr=n(7048),mr=n(7494),fr=n(526);const vr=function(e){return i.createElement(fr.Z,{type:"mapNode"},i.createElement(Oe.ZP,(0,r.Z)({},e),e.children))};function hr(e){return[.5*(e[0][0]+e[1][0]),.5*(e[0][1]+e[1][1])]}var gr=n(7689);function yr(e,t){var n=hr(e),r=hr(t),o=(0,gr.j)(e),i=(0,gr.j)(t);return Math.abs(n[0]-r[0])<.5*(o[0]+i[0])&&Math.abs(n[1]-r[1])<.5*(o[1]+i[1])}var _r=n(7612);const br={getTimings:function(e,t){var n=new RegExp("/tiles\\?.*l=("+e.join("|")+")"),r=6e5,o=_r.Z.getResourcesTimings((function(e){return n.test(e)})).filter((function(e){var n=f.parse(e.name),o=[[256*Number(n.x),256*Number(n.y)],[256*(Number(n.x)+1),256*(Number(n.y)+1)]];return yr(t,o)&&e.responseEnd<r&&e.responseEnd>0&&e.duration<r&&e.duration>=0}));if(0!==(o=o.filter((function(e,t){var n=e.name;return o.findIndex((function(e){return e.name===n}))===t}))).length){o.sort((function(e,t){return t.responseEnd-e.responseEnd}));var i=o.reduce((function(e,t){return e+t.duration}),0);return{averageDuration:Math.round(i/o.length),minLoadEnd:Math.round(o[o.length-1].responseEnd),medianaLoadEnd:Math.round(o[Math.floor(o.length/2)].responseEnd),maxLoadEnd:Math.round(o[0].responseEnd)}}}};var Er=n(8216);const wr=function(e){return e.ready?i.createElement(fr.Z,{type:"timingNode"},i.createElement(Oe.ZP,{name:e.type,nodeState:(0,r.Z)({ready:e.ready},e.extraState)},e.children)):null};var Sr=Er.$j((function(e){return{config:e.config,isSidebarCollapsed:D.XA(e)}})),Cr=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){if("distribution_fullscreen"!==this.props.type){if(!t.isTimingLogged){var e=this.props,n=e.config.pageMode;("search-result"===e.config.pageMode||e.config.uatraits.isMobile&&"orgpage"===e.config.pageMode)&&(n="search"),"metro_page"===e.type&&(n="metro"),function(e){switch(e){case"routes_page":return"routes";case"org_page":return"orgpage";case"discovery_page":return"discovery";case"home_page":case"distribution_fullscreen":return"home";case"panorama_page":return"panoramas";case"photos_page":return"photos";case"search_card_page":case"search_list_page":return"search";case"traffic_page":return"traffic";case"masstransit_stop_page":case"masstransit_route_page":return"masstransit";case"catalog_page":return"catalog";case"metro_page":return"metro"}}(e.type)===n&&(t.isTimingLogged=!0,e.isSidebarCollapsed||this.setState({ready:_r.Z.getTimeToNow()}))}}else this.setState({ready:_r.Z.getTimeToNow()})},n.render=function(){var e=this.props.type;if("undefined"==typeof window)return null;var t=window._maps_internal_timingsMarks;return i.createElement(wr,{type:e,ready:this.state.ready,extraState:{show:t&&e in t?t[e]:this.state.ready}})},t}(i.PureComponent);Cr.isTimingLogged=!1;const Zr=Sr(Cr);var Rr=n(2446);const Pr=(0,ct.Z)(I.ZP,Bt.ZP)(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._memoizedCreateHotspotFetchFunction=K(Rr.R),t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.config,n=t.hosts.roadEventsRenderer,r=n+"2.x/tiles?trf&%n&%l&x={{x}}&y={{y}}&z={{z}}&v=%v&format=protobuf",o=n+"1.1/tiles?trf&%n&%l&%c&v=%v";return i.createElement(_t,{layer:"trfe",dataSource:{type:"tile",vector:(0,ut.x8)({priority:"medium",tileUrl:(0,ut.pr)(r.replace("%n","l=trfe"),t.lang,e.roadEventsVersion),imageUrl:n+"icons?id={{id}}&scale={{scale}}",glyphRangeUrl:t.hosts.vectorGlyphs.replace("{{lang}}",t.lang),theme:(0,ut.gh)(e.theme)},t),raster:{type:"ground",fetchTile:(0,ut.pp)((0,ut.pr)(o.replace("%n","l=trfe"),t.lang,e.roadEventsVersion),t),fetchHotspots:this._memoizedCreateHotspotFetchFunction((0,ut.pp)((0,ut.c1)((0,ut.pr)(o.replace("%n","l=trje")+"&format=json",t.lang,e.roadEventsVersion),t),t)),transparent:!0},zoomRange:e.zoomRange},onClick:e.onClick})},t}(i.Component));var kr=(0,ct.Z)(I.ZP,Bt.ZP),Ir=!0;const Mr=kr(function(e){function t(t){var n;(n=e.call(this,t)||this)._onTilesReady=function(){if(!n.state.tilesReady){var e=n.props,t=(0,pr.n)(e.mapLocation.bounds,e.mapLocation.zoom);if(n.setState({tilesReady:!0}),Ir){var r=br.getTimings(["trf"],t);r&&n.setState({tilesTimings:r}),Ir=!1}}},n._countTrafficModeChange=function(){mr.Z.reachGoal("traffic")},n._renderLayer=function(){var e=n.props,t=e.config;if(!t.layers.trf)return null;var r=t.layers.trf.zoomRange?{min:t.layers.trf.zoomRange[0],max:t.layers.trf.zoomRange[1]}:void 0;if("traffic#actual"===e.providerKey){var o=t.hosts.traffic+"2.x/tiles?trf&%n&%l&x={{x}}&y={{y}}&z={{z}}&tm=%v&format=protobuf",a=t.hosts.traffic+"1.1/tiles?trf&%n&%l&%c&tm=%v";return i.createElement(i.Fragment,null,i.createElement(_t,{layer:"trf",dataSource:{type:"tile",vector:(0,ut.x8)({priority:"medium",tileUrl:(0,ut.pr)(o.replace("%n","l=trf"),t.lang,e.actualVersion),imageUrl:t.hosts.traffic+"icons/{{id}}?scale={{scale}}&id={{id}}",theme:(0,ut.gh)(e.theme)},t),raster:{type:"ground",fetchTile:(0,ut.pp)((0,ut.pr)(a.replace("%n","l=trf"),t.lang,e.actualVersion),t),transparent:!0},zoomRange:r}}),e.showRoadEvents?i.createElement(Pr,{onClick:e.onClick,zoomRange:r,roadEventsVersion:e.roadEventsVersion}):null)}return"traffic#archive"===e.providerKey?i.createElement(_t,{layer:"trfa",dataSource:{type:"tile",raster:{type:"ground",fetchTile:(0,ut.pp)((0,ut.pr)(t.hosts.trafficArchive+"tiles?trj&l=trf&%l&%c&tm=%v",t.lang,e.archiveVersion),t),transparent:!0},vector:(0,ut.x8)({priority:"medium",tileUrl:(0,ut.pr)(t.hosts.trafficArchive+"2.x/tiles?trf&l=trf&%l&x={{x}}&y={{y}}&z={{z}}&tm=%v&format=protobuf",t.lang,e.archiveVersion),imageUrl:t.hosts.trafficArchive+"icons?id={{id}}&scale={{scale}}",theme:(0,ut.gh)(e.theme)},t),zoomRange:r}}):null};var r=t.config.query;return Ir=Ir&&r.l&&r.l.split(",").includes("trf"),n.state={tilesReady:!1},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._countTrafficModeChange()},n.componentDidUpdate=function(e){var t=this.props;e.providerKey!==t.providerKey&&this._countTrafficModeChange()},n.componentWillUnmount=function(){Ir=!1},n.render=function(){var e=this.props,t=this.state;return i.createElement(i.Fragment,null,i.createElement(pt.Z,{onReady:this._onTilesReady}),this._renderLayer(),i.createElement(vr,{name:"traffic_layer",nodeState:{providerKey:e.providerKey}}),i.createElement(wr,{type:"traffic_tiles",ready:t.tilesTimings?t.tilesTimings.averageDuration:void 0,extraState:t.tilesTimings}),this.state.tilesReady&&this.props.logTilesReady?i.createElement(Zr,{type:"traffic_page"}):null)},t}(i.Component));var Tr={main:16,side:0},xr=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getDisplayType=function(){return t.props.mapSize.width*t.props.mapSize.height>16e4?"balloon":"panel"},t._renderContent=function(){return t.props.content?i.createElement(tr.Z,{displayType:t._getDisplayType(),mapLocation:t.props.mapLocation,coordinates:t.props.content.data.coordinates,onClose:t.props.resetContentData,updateLocationRequest:t.props.updateLocationRequest,offset:Tr,mapSize:t.props.mapSize},i.createElement(ar,{event:t.props.content.data.event})):null},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=sr(e.config);return i.createElement(i.Fragment,null,i.createElement(dr,{mapLocation:e.mapLocation,onTrafficLevelChange:e.onTrafficLevelChange},(function(n){return i.createElement(Mr,{providerKey:"traffic#actual",mapLocation:e.mapLocation,actualVersion:n.actualVersion,onClick:e.onClick,showRoadEvents:t,roadEventsVersion:n.roadEventsVersion})})),this._renderContent())},t}(i.Component);const Lr=(0,I.ZP)(xr);var Dr=n(1881),Nr=7,Ar=-10,zr=-30,Ur=-12,Or=-24,Fr=8,Br={};function Hr(e,t){if(!t.offset||!t.size)return{left:0,right:0,bottom:0,top:0};var n=t.offset[0],r=t.offset[0],o=t.offset[1],i=t.offset[1]+t.size.height;return"MASSTRANSIT"===e.pinType&&(n+=e.rotated?-t.size.width:-Nr,r+=e.rotated?Nr:t.size.width),"CONSTRUCTION"===e.pinType&&(n+=Ar,r=r+t.size.width+Ar,o+=zr,i+=zr),"ROUTEPOINT"===e.pinType&&(n-=t.size.width/2,r+=t.size.width/2,o=o+Fr-10,i+=Fr),"SPECIAL"===e.pinType&&(n+=Ur,r=r+t.size.width+Ur,o+=Or,i+=Or),{left:n,right:r,top:o,bottom:i}}function qr(e,t,n,r){return Promise.all(e.map((function(e){return function(e,t,n,r){var o=jr(e);return Br[o]=Br[o]||(0,Dr.Z)((function(){return t(e)}),r),Br[o].then((function(t){var r=(0,Nn.f)(n.bounds[0],n.zoom),o=(0,Nn.f)(e.coordinates,n.zoom);return{size:t,offset:[o[0]-r[0],o[1]-r[1]]}}))}(e,t,n,r)}))).then((function(t){return e.map((function(n,r){return function(e,t,n){var r=e[n],o=t[n];if(!o.offset||!o.size)return[];var i=Hr(r,o);return i.left===i.right||i.top===i.bottom?[]:e.reduce((function(e,n,o){if(r===n)return e;var a=t[o];if(!a.offset||!a.size)return e;var s=Hr(n,a);return s.left===s.right||s.top===s.bottom?e:yr([[i.left,i.top],[i.right,i.bottom]],[[s.left,s.top],[s.right,s.bottom]])?e.concat(o):e}),[])}(e,t,r)}))}))}function Gr(e,t,n,r){return qr(e,t,n,r).then((function(e){return e.every((function(e){return 0===e.length}))}))}function Wr(e,t,n,r,o,i){return new Promise((function(a){if(1===e.length)a({pins:e,optimized:!0});else if(o>10)a({pins:e,optimized:!1});else{var s=t(e);Gr(s.pins,n,r,i).then((function(e){e?a({pins:s.pins,optimized:!0}):s.isFinished?s.isFinished&&a({pins:s.pins,optimized:!1}):a(Wr(s.pins,t,n,r,o++,i))}))}}))}function jr(e){switch(e.pinType){case"CONSTRUCTION":return e.coordinates.join(",")+e.pinType;case"MASSTRANSIT":return(e.balloonItems&&String(e.balloonItems.length)||"0")+(e.text||"")+(e.dotSize||"")+(e.rotated||"")+e.pinType+e.coordinates.join(",")+e.pinIndex;case"ROUTEPOINT":return(String(e.index)||0)+(e.value||"")+e.pinType+(e.isLast&&"last");case"SPECIAL":return e.coordinates.join(",")+e.position+e.pinType}}function Vr(e){switch(e.pinType){case"CONSTRUCTION":case"MASSTRANSIT":case"SPECIAL":return jr(e);case"ROUTEPOINT":return(String(e.index)||0)+e.pinType+(e.isLast&&"last")}}var Yr=n(111),Kr={ROUTEPOINT:"ROUTEPOINT",MASSTRANSIT:"MASSTRANSIT",CONSTRUCTION:"CONSTRUCTION",SPECIAL:"SPECIAL"},$r=function(e){function t(t){var n;return(n=e.call(this,t)||this)._updateMapLocationThrottled=void 0,n._validityChecksCounter=0,n._processingTimeout=0,n._routeComponentProcessingFunction=function(e,t){return 1===e.length?Promise.resolve(e):function(e,t,n){return t.reduce((function(e,t){return e.then((function(e){return e.optimized?e:n(e.pins,t)}))}),Promise.resolve({pins:e,optimized:!1}))}(e.sort((function(e,t){return e.pinIndex>t.pinIndex?1:-1})),n.props.algoSteps,t).then((function(e){return e.pins}))},n._updatePins=function(){n._validityChecksCounter=0,window.clearTimeout(n._processingTimeout),n._validateDrawing(n.props.unprocessedPins.map((function(e,t){return(0,r.Z)({pinIndex:t},e)})))},n._collectAndProcessGroups=function(e){var t=n.state.mapLocation,r=n.props.config;qr(e,n.props.getNodeByPin,t,r).then((function(o){var i=function(e){for(var t=new Array(e.length).map((function(){return!1})),n=[],r=0;r<e.length;r++)if(!t[r]){var o=[r],i=[r];for(t[r]=!0;o.length>0;)for(var a=e[o.pop()],s=0;s<a.length;++s){var c=a[s];t[c]||(t[c]=!0,o.push(c),i.push(c))}n.push(i)}return n}(o).map((function(o){var i=o.map((function(t){return e[t]}));return n._routeComponentProcessingFunction(i,(function(e,o){return Wr(e,o,n.props.getNodeByPin,t,0,r)}))}));Promise.all(i).then((function(e){var t=e.reduce((function(e,t){return e.concat(t)}));n._validateDrawing(t)}))}))},n._updateMapLocation=function(){var e=n.props.map.zoom;Math.abs(n.state.mapLocation.zoom-e)<.25||n.setState({mapLocation:(0,s.cx)(n.props.map)})},n._onMapUpdate=function(){n._updateMapLocationThrottled()},n._validateDrawing=function(e){n._validityChecksCounter+=1;var t=n.props.filterPinsByZoom(e,n.state.mapLocation.zoom);n._validityChecksCounter>=2?n.setState({pinsToDraw:t}):Gr(t,n.props.getNodeByPin,n.state.mapLocation,n.props.config).then((function(e){e?n.setState({pinsToDraw:t}):n._processingTimeout=window.setTimeout((function(){return n._collectAndProcessGroups(t)}),50)}))},n.state={pinsToDraw:[],mapLocation:(0,s.cx)(n.props.map)},n._updateMapLocationThrottled=(0,Yr.Z)(n._updateMapLocation,300),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._validityChecksCounter=0,this._validateDrawing(this.props.unprocessedPins.map((function(e,t){return(0,r.Z)({pinIndex:t},e)})))},n.componentDidUpdate=function(e,t){this.state.mapLocation.zoom===t.mapLocation.zoom&&this.props.unprocessedPins===e.unprocessedPins||this._updatePins()},n.componentWillUnmount=function(){window.clearTimeout(this._processingTimeout)},n.render=function(){var e=this;return i.createElement(i.Fragment,null,this.state.pinsToDraw.map((function(t){var n=e.props.getMapPlacemarkProps(t);return n?i.createElement(Ue.Z,(0,r.Z)({key:Vr(t)},n),e.props.getNodeByPin(t)):null})),i.createElement(pt.Z,{onUpdate:this._onMapUpdate}))},t}(i.Component);const Xr=(0,dt.ZP)({shouldWait:!0})((0,I.ZP)($r));var Qr,Jr=n(251),eo=n.n(Jr),to=n(3331),no=n.n(to),ro=n(4050),oo=n.n(ro),io=n(561),ao=n.n(io),so=n(2976),co=((Qr={fallback:{small:"subway-fallback-16",normal:"subway-fallback-24"},adana_metro:{small:"subway-adana-16",normal:"subway-adana-24"},almaty_metro:{small:"subway-almaty-16",normal:"subway-almaty-24"},amsterdam_metro:{},ankara_metro:{small:"subway-ankara-16",normal:"subway-ankara-24"},ankaray:{small:"subway-ankaray-16",normal:"subway-ankaray-24"},athens_metro:{small:"subway-athens-16",normal:"subway-athens-24"},baku_metro:{small:"subway-baku-16",normal:"subway-baku-24"},barcelona_fgc:{small:"subway-barcelona-16",normal:"subway-barcelona-24"},barcelona_tmb:{small:"subway-barcelona-16",normal:"subway-barcelona-24"},beijing_metro:{},berlin_ubahn:{small:"subway-berlin-16",normal:"subway-de-ubahn-24"},brussels_metro:{},bucharest_metro:{small:"subway-bucharest-16",normal:"subway-bucharest-24"},budapest_metro:{small:"subway-budapest-16",normal:"subway-budapest-24"},buenos_aires_metro:{},bursaray:{small:"subway-bursa-16",normal:"subway-bursa-24"},cairo_metro:{},copenhagen_metro:{small:"subway-copenhagen-metro-16",normal:"subway-copenhagen-24"},dnipro_metro:{small:"subway-dnepropetrovsk-16",normal:"subway-dnepropetrovsk-24"},dubai_metro:{small:"uae-subway-16",normal:"uae-subway-24"},dubai_monorail:{small:"uae-monorail-16",normal:"uae-monorail-24"},dubai_tram:{small:"uae-tram-16",normal:"uae-tram-24"},ekaterinburg_metro:{small:"subway-ekb-16",normal:"subway-ekb-24"},genoa_metro:{},glasgow_subway:{},hamburg_ubahn:{},harbin_metro:{},helsinki_metro:{small:"subway-helsinki-16",normal:"subway-helsinki-24"},hong_kong_mtr:{},istanbul_funicular:{},istanbul_marmaray:{small:"subway-istanbul-marmaray-16",normal:"subway-istanbul-marmaray-24"},istanbul_metro:{small:"subway-istanbul-16",normal:"subway-istanbul-24"},istanbul_metrobus:{small:"subway-bus-istanbul-16",normal:"subway-bus-istanbul-24"},izmir_metro:{small:"subway-izmir-16",normal:"subway-izmir-24"},kazan_metro:{small:"subway-kazan-16",normal:"subway-kazan-24"},kharkiv_metro:{small:"subway-kharkov-16",normal:"subway-kharkov-24"},kiev_metro:{small:"subway-kiev-16",normal:"subway-kiev-24"},kryvyirih_metrotram:{},lille_metro:{},lisbon_metro:{small:"subway-lisboa-16",normal:"subway-lisbon-24"},london_dlr:{small:"subway-london-16",normal:"subway-london-underground-24"},london_underground:{small:"subway-london-16",normal:"subway-london-underground-24"},lyon_metro:{},madrid_metro:{small:"subway-madrid-16",normal:"subway-madrid-24"},mexico_city_metro:{},milan_metro:{},minsk_metro:{small:"subway-minsk-16",normal:"subway-minsk-24"},moscow_mcd:{small:"subway-msk-16",normal:"subway-msk-24"}}).__internal__moscow_mcd={small:"subway-msk-16",normal:"subway-msk-24"},Qr.moscow_metro={small:"subway-msk-16",normal:"subway-msk-24"},Qr.munich_ubahn={},Qr.naples_metro={},Qr.newathos_metro={},Qr.nizhnynovgorod_metro={small:"subway-nn-16",normal:"subway-nn-24"},Qr.novosibirsk_metro={small:"subway-nsk-16",normal:"subway-nsk-24"},Qr.nuremberg_ubahn={},Qr.oslo_metro={small:"subway-oslo-16",normal:"subway-oslo-24"},Qr.paris_metro={small:"subway-paris-16",normal:"subway-paris-metro-24"},Qr.paris_rer={small:"subway-paris-rer-16",normal:"subway-paris-rer-24"},Qr.paris_tramway={small:"subway-paris-tramway-16",normal:"subway-paris-tramway-24"},Qr.prague_metro={small:"subway-prague-metro-16",normal:"subway-prague-24"},Qr.pyongyang_metro={},Qr.rome_metro={small:"subway-roma-16",normal:"subway-roma-24"},Qr.sanfrancisco_metro={small:"subway-san-francisco-metro-16",normal:"subway-san-francisco-metro-24"},Qr.samara_metro={small:"subway-samara-16",normal:"subway-samara-24"},Qr.seville_metro={},Qr.singapore_mrt={},Qr.sofia_metro={small:"subway-sofia-metro-16",normal:"subway-sofia-metro-24"},Qr.spb_metro={small:"subway-spb-16",normal:"subway-spb-24"},Qr.stockholm_metro={small:"subway-stockholm-16",normal:"subway-stockholm-24"},Qr.tashkent_metro={small:"subway-tashkent-16",normal:"subway-tashkent-24"},Qr.tbilisi_metro={small:"subway-tbilisi-16",normal:"subway-tbilisi-24"},Qr.toulouse_metro={},Qr.turin_metro={},Qr.vienna_ubahn={small:"subway-wein-16",normal:"subway-wein-24"},Qr.volgograd_metrotram={small:"subway-tram-volgograd-16",normal:"subway-volgograd-tram-24"},Qr.warsaw_metro={small:"subway-warsaw-metro-16",normal:"subway-warsaw-24"},Qr.washington_metro={},Qr.yerevan_metro={small:"subway-erevan-16",normal:"subway-erevan-24"},Qr),lo=Object.entries({bus:{normal:"bus-16"},minibus:{normal:"minibus-16"},tramway:{normal:"tram-16"},trolleybus:{normal:"trolley-16"},water:{normal:"ship-16"},underground:{normal:"subway-icon-fallback-16"},cable:{normal:"cableway-16-flip"},aero:{normal:"aero-16-flip"},aeroexpress:{normal:"aeroexpress-16"},funicular:{normal:"funicular-16-flip"},train:{normal:"train-16"},suburban:{normal:"train-16"},railway:{normal:"train-16"},fallback:{normal:"unknown-16-flip"}}).reduce((function(e,t){var n=t[0],r=t[1];return e[n]=null==r?void 0:r.normal,e}),{walk:"pedestrian-16-flip"}),uo=n(4897),po=(0,ze.Z)("masstransit-route-pin-view"),mo=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._onClick=function(e){var n=t.props,r=e||n.balloonItems&&n.balloonItems[0].stopId;r&&n.onClick&&n.onClick({coordinates:n.coordinates,id:r})},t._renderBalloonItem=function(e){var n,r="underground"===e.iconType&&e.transportSystemId,o=r?null===(n=co[e.transportSystemId])||void 0===n?void 0:n.small:"metro-exit"===e.iconType?void 0:lo[e.iconType];return i.createElement(uo.Z,{className:po("balloon-item",{type:e.iconType}),style:{backgroundColor:"underground"!==e.iconType?e.color:void 0},onClick:function(){return t._onClick(e.stopId)}},o?i.createElement(He.Z,{inline:!0,className:po("balloon-icon"),name:o,theme:r?t.props.theme:void 0}):null,["suburban","aeroexpress"].includes(e.iconType)?null:i.createElement("div",{className:po("balloon-text"),style:{backgroundColor:e.color}},e.text))},t._renderBalloon=function(){var e=t.props.balloonItems;return e?i.createElement("div",{className:po("balloon")},t._renderBalloonItem(e[0]),e[1]?i.createElement(i.Fragment,null,i.createElement(He.Z,{name:"arrow-right-8-flip",className:po("arrow"),inline:!0}),t._renderBalloonItem(e[1])):null):null},t._renderText=function(){return t.props.text?i.createElement(uo.Z,{tag:"span",className:po("text"),onClick:function(){return t._onClick()}},t.props.text):null},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.balloonItems&&t.balloonItems[t.balloonItems.length-1].color||t.dotColor,r=t.dotSize||"normal";return i.createElement("div",{className:po({rotated:t.rotated,double:t.balloonItems&&2===t.balloonItems.length,clickable:Boolean(t.onClick)})},i.createElement("div",{className:po("container")},i.createElement("div",{"aria-hidden":!0,className:po("dot",{size:r}),style:{background:n},onClick:function(){return e._onClick()}}),this._renderBalloon()),this._renderText())},t}(i.PureComponent);const fo=(0,Bt.ZP)((0,I.ZP)(mo));var vo=n(9410),ho=n(1109),go=n(1791),yo=n.n(go),_o=n(5097),bo=n.n(_o),Eo=(0,ze.Z)("waypoint-pin-view"),wo=function(e){function t(t){var n;(n=e.call(this,t)||this)._getServiceIconUrl=function(){var e=n.props;return e.serviceType&&"geolocation"!==e.serviceType?ho.Gr({type:"service",name:e.serviceType,size:e.mobileChooseMode?"normal":"small"},e.config):null},n._getRubricIconUrl=function(){var e=n.props;if(e.searchResult){var t,r;if("categories"in e.searchResult&&e.searchResult.categories)t=null===(r=e.searchResult.categories[0])||void 0===r?void 0:r.class;else"kind"in e.searchResult&&(t=e.searchResult.kind);if(t)return ho.Gr({type:"rubrics",name:t,size:e.mobileChooseMode?"normal":"small"},e.config)||void 0}},n._renderText=function(){if(!n.props.text)return null;var e=(0,vo.Z)(n.props.text,{length:40});return i.createElement("div",{className:Eo("text",{hidden:n.props.hideText})},e.split(" ").map((function(e,t){return i.createElement("span",{key:t,className:Eo("word")},e)})))},n._renderWaypoint=function(){var e=n.props,t=n.state;return i.createElement(i.Fragment,null,i.createElement(Ye.Z,{url:e.mobileChooseMode?bo():yo(),className:Eo("pin-icon")}),i.createElement(Ye.Z,{url:t.currentIconUrl,key:t.currentIconUrl,className:Eo("rubric-icon",{"mobile-choose":e.mobileChooseMode,current:!0,type:e.serviceType})}),t.temporaryIconUrl?i.createElement(Ye.Z,{url:t.temporaryIconUrl,key:t.temporaryIconUrl,className:Eo("rubric-icon",{"mobile-choose":e.mobileChooseMode,temporary:!0})}):null,n._renderText())},n._renderIntermediatePoint=function(){var e=n.props;return i.createElement(i.Fragment,null,i.createElement("div",{className:Eo("content")},i.createElement("span",{className:Eo("index")},e.index)),n._renderText())};var r=ho.Gr({type:"rubrics",name:"fallback",size:t.mobileChooseMode?"normal":"small"},t.config),o=n._getServiceIconUrl()||n._getRubricIconUrl()||r;return n.state={temporaryIconUrl:null,currentIconUrl:o},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this.props,n=this._getServiceIconUrl()||this._getRubricIconUrl();(t.serviceType||t.searchResult!==e.searchResult)&&n&&n!==this.state.currentIconUrl&&this.setState({temporaryIconUrl:this.state.currentIconUrl,currentIconUrl:n})},n.render=function(){var e=this.props,t=0===e.index,n=!t&&!e.isLast&&!e.mobileChooseMode;return"geolocation"===e.serviceType&&e.config.uatraits.isMobile?i.createElement("div",{className:Eo({geolocation:!0})}):i.createElement("div",{className:Eo({disabled:e.disabled,first:t,last:e.isLast,intermediate:n,"mobile-choose":e.mobileChooseMode})},n?this._renderIntermediatePoint():this._renderWaypoint())},t}(i.Component);const So=(0,I.ZP)(wo);var Co=n(6306);function Zo(e){return"CONSTRUCTION"===e.pinType&&["STAIRS_UP","STAIRS_DOWN","STAIRS_UNKNOWN"].includes(e.type)}function Ro(e){var t=e.filter((function(e){return"CONSTRUCTION"===e.pinType&&["STAIRS_UP","STAIRS_DOWN","STAIRS_UNKNOWN"].includes(e.type)}));if(t.length<2)return{pins:e,isFinished:!0};var n=e.findIndex((function(e){return Zo(e)})),r=(0,m.Z)(e[n],{type:"STAIRS_UNKNOWN"}),o=e.filter((function(e){return!Zo(e)})).concat(r);return{pins:o,isFinished:!0}}function Po(e){var t=e.filter((function(e){return"CONSTRUCTION"===e.pinType}));if(t.length<2)return{pins:e,isFinished:!0};var n=e.findIndex((function(e){return"CONSTRUCTION"===e.pinType})),r=e.filter((function(e){return"CONSTRUCTION"!==e.pinType})).concat(e[n]);return{pins:r,isFinished:!0}}function ko(e){return{pins:e.filter((function(e){return"CONSTRUCTION"!==e.pinType})),isFinished:!0}}function Io(e){return{pins:e.filter((function(e){return"MASSTRANSIT"!==e.pinType||"balloonItems"in e&&e.balloonItems||"dotSize"in e})),isFinished:!0}}function Mo(e){var t=e.findIndex((function(e){return"MASSTRANSIT"===e.pinType&&e.balloonItems}));if(-1!==t){var n=[].concat(e),r=n[t];return n[t]=(0,m.Z)(n[t],{balloonItems:void 0,dotColor:r.balloonItems&&r.balloonItems[r.balloonItems.length-1].color,dotSize:"none",rotated:!1,text:void 0}),{pins:n,isFinished:!1}}return{pins:e,isFinished:!0}}function To(e){return{pins:e.filter((function(e){var t;return"MASSTRANSIT"!==e.pinType||!e.balloonItems||"metro-exit"!==(null===(t=e.balloonItems[0])||void 0===t?void 0:t.iconType)})),isFinished:!0}}function xo(e){var t=Uo(e);return t?zo(t,e):{pins:e,isFinished:!0}}function Lo(e){var t=e.reduce((function(e,t,n){return"MASSTRANSIT"===t.pinType?e.concat(n):e}),[]);return zo(t.length>2?t.slice(0,3):t.slice(0,2),e)}function Do(e){var t=Uo(e);return t?function(e,t){var n=e[0],o=e[1],i=t[n],a=t[o];if("MASSTRANSIT"!==i.pinType||"MASSTRANSIT"!==a.pinType)return{pins:t,isFinished:!0};if(!i.balloonItems||!a.balloonItems)return{pins:t,isFinished:!0};var s=i.balloonItems[0].initialText===a.balloonItems[0].initialText&&i.balloonItems[0].color===a.balloonItems[0].color;return t[o]=s?(0,m.Z)(a,(0,r.Z)({},i,{pinIndex:a.pinIndex,rotated:!1})):(0,m.Z)(a,{rotated:!1,text:"",balloonItems:[i.balloonItems[0],a.balloonItems[0]]}),{pins:t.filter((function(e){return e.pinIndex!==i.pinIndex})),isFinished:!1}}(t,e):{pins:e,isFinished:!0}}function No(e){var t=e.findIndex((function(e,t,n){var r=n[t+1];return r&&"MASSTRANSIT"===e.pinType&&"MASSTRANSIT"===r.pinType&&e.text===r.text})),n=-1!==t?[e[t],e[t+1]]:[];return 2===n.length&&"MASSTRANSIT"===n[0].pinType&&"MASSTRANSIT"===n[1].pinType?n[0].balloonItems&&1===n[0].balloonItems.length&&n[1].balloonItems&&1===n[1].balloonItems.length&&n[0].balloonItems[0].color!==n[1].balloonItems[0].color?{pins:e,isFinished:!0}:{pins:[].concat(e.filter((function(e){return!n.includes(e)})),[n[1]]),isFinished:!0}:{pins:e,isFinished:!0}}function Ao(e){return{pins:e.map((function(e){return"MASSTRANSIT"!==e.pinType||!e.balloonItems||2===e.balloonItems.length||e.first||"MASSTRANSIT"!==e.pinType||1!==e.balloonItems.length||e.first?e:(0,m.Z)(e,{balloonItems:void 0,dotColor:e.balloonItems&&e.balloonItems[e.balloonItems.length-1].color,dotSize:"none",rotated:!1,text:void 0})})),isFinished:!0}}function zo(e,t){var n=e.map((function(e){return t[e].rotated?1:0})),r=Math.pow(2,n.length)-1,o=parseInt(n.join(""),2);return o<r?((o+1).toString(2).padStart(n.length,"0").split("").map(Number).map(Boolean).forEach((function(n,r){t[e[r]]=(0,m.Z)(t[e[r]],{rotated:n})})),{pins:t,isFinished:!1}):{pins:t,isFinished:!0}}function Uo(e){for(var t=e.map((function(e,t){return{pin:e,index:t}})).filter((function(e){var t=e.pin;return"MASSTRANSIT"===t.pinType&&t.balloonItems&&1===t.balloonItems.length})),n=[],r=1;r<t.length;r++)if(t[r-1].pin.pinIndex===t[r].pin.pinIndex-1){n.push(t[r-1],t[r]);break}return n.length>0?[n[0].index,n[1].index]:null}function Oo(e){var t=e.findIndex((function(e){return"MASSTRANSIT"===e.pinType&&e.balloonItems&&2===e.balloonItems.length}));if(-1===t)return{pins:e,isFinished:!0};var n=e[t];if("MASSTRANSIT"!==n.pinType||!n.balloonItems||2!==n.balloonItems.length)return{pins:e,isFinished:!0};var r={pinIndex:n.pinIndex-1,balloonItems:[n.balloonItems[0]],coordinates:n.balloonItems[0].initialCoordinates,last:!0,pinType:Kr.MASSTRANSIT,rotated:!1,text:n.balloonItems[0].initialText},o={pinIndex:n.pinIndex,balloonItems:[n.balloonItems[1]],coordinates:n.balloonItems[1].initialCoordinates,first:!0,pinType:Kr.MASSTRANSIT,rotated:!1,text:n.balloonItems[1].initialText},i=[].concat(e);return i.splice(t,1,r,o),{pins:i,isFinished:!1}}function Fo(e){return{pins:[].concat(e).map((function(e){return(0,m.Z)(e,{rotated:!1})})),isFinished:!0}}function Bo(e){if(e.filter((function(e){return"ROUTEPOINT"===e.pinType&&e.value})).length>1){var t=e.findIndex((function(e){return"ROUTEPOINT"===e.pinType&&e.value&&0!==e.index&&!e.isLast})),n=[].concat(e);if(-1!==t)return n[t]=(0,m.Z)(n[t],{value:""}),{pins:n,isFinished:!1};var r=e.findIndex((function(e){return"ROUTEPOINT"===e.pinType&&e.value&&0===e.index}));if(-1!==r)return n[r]=(0,m.Z)(e[r],{value:""}),{pins:n,isFinished:!0}}return{pins:e,isFinished:!0}}function Ho(e){return e.length<2?{pins:e,isFinished:!0}:{pins:e.filter((function(e){return!("SPECIAL"===e.pinType&&"end"===e.position)})),isFinished:!0}}function qo(e){if(e.length<2)return{pins:e,isFinished:!0};var t=e.filter((function(e){return"SPECIAL"!==e.pinType||["RAILWAY_CROSSING","SPEED_BUMP","BORDER_CROSSING"].includes(e.type)})),n=e.filter((function(e){return"SPECIAL"===e.pinType&&"FERRY"===e.type})),r=e.filter((function(e){return"SPECIAL"===e.pinType&&"TOLL_ROAD"===e.type})),o=e.filter((function(e){return"SPECIAL"===e.pinType&&"FORD_CROSSING"===e.type})),i=e.filter((function(e){return"SPECIAL"===e.pinType&&"RUGGED_ROAD"===e.type}));return n.length&&t.push(n[0]),r.length&&t.push(r[0]),o.length&&t.push(o[0]),i.length&&t.push(i[0]),{pins:t,isFinished:!0}}function Go(e){return e.length<2?{pins:e,isFinished:!0}:{pins:e.filter((function(e){return!("SPECIAL"===e.pinType&&"RUGGED_ROAD"===e.type)})),isFinished:!0}}function Wo(e){return function(t){if(t.length<2)return{pins:t,isFinished:!0};var n=t.filter((function(t){return!("SPECIAL"===t.pinType&&t.type===e)}));if(!n.length){var r=t.filter((function(e,t){return t%2==0}));return{pins:r,isFinished:1===r.length}}return{pins:n,isFinished:!0}}}function jo(e){return 0===e.length?{pins:e,isFinished:!0}:{pins:e.filter((function(e){return"SPECIAL"!==e.pinType})),isFinished:!0}}var Vo={FORD_CROSSING:{ru:{begin:"poi-alerts-ford-crossing-24",end:"poi-alerts-ford-crossing-end-24"}},RUGGED_ROAD:{ru:{begin:"poi-alerts-road-rugged-24",end:"poi-alerts-rugged-end-24"}},TOLL_ROAD:{ru:{begin:"poi-alerts-pay-wd-24",end:"poi-alerts-pay-wd-end-24"}},FERRY:{ru:{begin:"poi-alerts-ship-24",end:"poi-alerts-ship-end-24"}},RAILWAY_CROSSING:{ru:{single:"poi-alerts-railway-crossing-24"}},SPEED_BUMP:{ru:{single:"poi-alerts-speed-bump-24"}},BORDER_CROSSING:{ru:{single:"poi-alerts-border-24"}}},Yo={STAIRS_UP:eo(),STAIRS_DOWN:no(),STAIRS_UNKNOWN:oo(),GATES:ao()},Ko=(0,ze.Z)("route-pins-view"),$o=function(e){function t(t){var n;return(n=e.call(this,t)||this)._updatePins=function(){n.setState({pins:[].concat(n._getRoutePointPins(),n._getMasstransitPins(),n._getConstructionPins(),n._getSpecialRoadPins())})},n._getUpdatedWaypointCoordinates=function(e,t){var r=n.props,o=r.routePoints.filter((function(e,t){return!r.viaIndexes.includes(t)}))[t];return r.routePoints.map((function(t){return o===t?e:t.coords}))},n._onDragStart=function(){n.props.setDragging(!0)},n._onDragMove=function(e,t){var r=n.props,o=n._getUpdatedWaypointCoordinates(e,t);r.onRoutePointsChange&&r.onRoutePointsChange(o,{viaIndexes:r.viaIndexes,isRough:!0})},n._onDragEnd=function(e,t){var r=n.props;r.setDragging(!1);var o=n._getUpdatedWaypointCoordinates(e,t);r.onRoutePointsChange&&r.onRoutePointsChange(o,{viaIndexes:r.viaIndexes,isRough:!1})},n._getMasstransitPins=function(){var e=n.props;return e.activeRoute&&"paths"in e.activeRoute?e.activeRoute.paths.reduce((function(t,n){return t.concat((r=n.segments,e.config,r.reduce((function(e,t){var n;if(!t.edgePoints||!t.transports)return e;var r=t.stops&&t.stops[0],o=t.stops&&t.stops[t.stops.length-1];return e.push({balloonItems:[Jo(t.transports,t.edgePoints[0],r)],pinType:Kr.MASSTRANSIT,coordinates:t.edgePoints[0],rotated:!1,first:!0,text:null==r?void 0:r.name},{pinType:Kr.MASSTRANSIT,dotColor:Xo(t.transports),coordinates:t.edgePoints[1]}),null!=o&&null!==(n=o.exit)&&void 0!==n&&n.name&&e.push({pinType:Kr.MASSTRANSIT,balloonItems:[Qo(o.exit,o)],coordinates:o.exit.coordinates,rotated:!1,dotSize:"small",text:"Выход"}),e.push({pinType:Kr.MASSTRANSIT,balloonItems:[Jo(t.transports,t.edgePoints[1],o)],coordinates:t.edgePoints[1],rotated:!1,last:!0,text:null==o?void 0:o.name}),e}),[])));var r}),[]):[]},n._getMapPlacemarkProps=function(e){var t;switch(e.pinType){case"CONSTRUCTION":return{coordinates:e.coordinates,zIndex:Fe.I.routes};case"MASSTRANSIT":return{coordinates:e.coordinates,zIndex:Fe.I.routePins.masstransit,blockEvents:!0};case"ROUTEPOINT":var r=n.props,o=e;return o.coords?{zIndex:0===o.index?Fe.I.routePins.waypoint+1:o.isLast?Fe.I.routePins.waypoint+2:Fe.I.routePins.waypoint,coordinates:o.coords,draggable:r.draggable&&!o.disabled&&(!r.draggableIndexes||(null===(t=r.draggableIndexes)||void 0===t?void 0:t.includes(o.index))),onDragStart:n._onDragStart,onDragEnd:function(e){var t=e.coordinates;return n._onDragEnd(t,o.index)},onDragMove:function(e){var t=e.coordinates;return n._onDragMove(t,o.index)}}:null;case"SPECIAL":return{zIndex:Fe.I.routes,coordinates:e.coordinates}}},n._getConstructionPins=function(){var e=n.props;return e.activeRoute&&"constructions"in e.activeRoute?e.activeRoute.constructions.map((function(e){return(0,r.Z)({},e,{pinType:Kr.CONSTRUCTION})})):[]},n._getSpecialRoadPins=function(){var e=n.props;return e.activeRoute&&"specialRoadPoints"in e.activeRoute&&e.activeRoute.specialRoadPoints?e.activeRoute.specialRoadPoints.map((function(e){return(0,r.Z)({},e,{pinType:Kr.SPECIAL})})):[]},n._getRoutePointPins=function(){var e=n.props,t="taxi"===e.travelMode,o=c.MW(e.travelMode,e.config),i=e.routePoints.every((function(e){return!e.coords||Boolean(e.input)}))&&!e.isRoutePointDragging;return e.routePoints.filter((function(t,n){return!e.viaIndexes.includes(n)})).map((function(e,n,a){var s=t&&0!==n&&n!==a.length-1||n>=o-1&&n!==a.length-1;return(0,r.Z)({},e,{pinType:Kr.ROUTEPOINT,coordinates:e.coords||[0,0],disabled:s,showText:i,index:n,isLast:n===a.length-1})}))},n._getConstructionNode=function(e){return i.createElement("div",{className:Ko("construction",{type:e.type})},i.createElement(Ye.Z,{url:Yo[e.type]}))},n._getSpecialRoadPinNode=function(e){var t=n.props.config,r=Vo[e.type];if(!r)return null;var o=r[t.lang],a=(0,ho.XT)(t)?r.ru:r.en,s=r.ru,c=o||a||s;return i.createElement("div",{className:Ko("special-road",{type:e.type,position:e.position})},i.createElement(He.Z,{name:c[e.position]}))},n._getMasstransitPinNode=function(e){var t=n.props,o=!t.activeRoute||"isIntercityRoute"in t.activeRoute&&t.activeRoute.isIntercityRoute||t.isMapEditing?void 0:t.onStopClick;return i.createElement(fo,(0,r.Z)({},e,{onClick:o}))},n._getWaypointPinNode=function(e){return i.createElement(So,{text:e.value,hideText:!e.showText,index:e.index,isLast:e.isLast,disabled:e.disabled,searchResult:e.searchResult,serviceType:e.serviceType})},n._getRouteItemPinNode=function(e){switch(e.pinType){case"CONSTRUCTION":return n._getConstructionNode(e);case"MASSTRANSIT":return n._getMasstransitPinNode(e);case"ROUTEPOINT":return n._getWaypointPinNode(e);case"SPECIAL":return n._getSpecialRoadPinNode(e)}},n._getAlgoSteps=function(){var e=[Ro,Po,ko],t=n.props.activeRoute&&"masstransit"===n.props.activeRoute.type?[Io,No,xo,To,Fo,xo,Do,Ao,Oo,Ao,Fo,Lo,Fo,Mo]:[],r=[Bo],o=[Wo("SPEED_BUMP"),Wo("RAILWAY_CROSSING"),Go,Wo("TOLL_ROAD"),Wo("FERRY"),Wo("FORD_CROSSING"),Ho,qo,Wo("BORDER_CROSSING"),jo];return[].concat(e,t,r,o)},n._filterPinsByZoom=function(e,t){return e.filter((function(e){return!("SPECIAL"===e.pinType&&"SPEED_BUMP"===e.type&&t<12)}))},n.state={pins:[]},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){this.props.activeRoute===e.activeRoute&&this.props.routePoints===e.routePoints||this._updatePins()},n.componentDidMount=function(){this._updatePins()},n.render=function(){return i.createElement(i.Fragment,null,i.createElement(Xr,{unprocessedPins:this.state.pins,getNodeByPin:this._getRouteItemPinNode,getMapPlacemarkProps:this._getMapPlacemarkProps,algoSteps:this._getAlgoSteps(),filterPinsByZoom:this._filterPinsByZoom}),this.state.pins.filter((function(e){return e.pinType===Kr.ROUTEPOINT})).map((function(e){var t,n=e.uri||(null===(t=e.searchResult)||void 0===t?void 0:t.uri);return n?i.createElement(so.Z,{key:n,uri:n}):null})))},t}(i.Component);function Xo(e){var t=c.Sk(e);return Co.Sm(t)}function Qo(e,t){return{iconType:"metro-exit",color:"#666",text:e.name,initialCoordinates:e.coordinates,initialText:e.name,stopId:null==t?void 0:t.id}}function Jo(e,t,n){var r=c.Sk(e);return{iconType:r.type,color:Xo(e),transportSystemId:r.transportSystemId,text:"underground"===r.type&&r.shortName?r.shortName:r.name,initialCoordinates:t,initialText:null==n?void 0:n.name,stopId:null==n?void 0:n.id}}const ei=(0,I.ZP)($o);var ti=n(9599),ni=n(5113);const ri=(0,ct.Z)(ni.Z,(0,dt.ZP)({shouldWait:!0}))(function(e){function t(t){var n;return(n=e.call(this,t)||this)._id=void 0,n._id=T().v4(),t.map.addGroup(n._dataSourceId,n._id,t.style,t.parentGroupId),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){this.props.map.removeGroupAndChildren(this._dataSourceId,this._id)},n.render=function(){return i.createElement(ni.Q,{value:{parentGroupId:this._id}},this.props.children)},(0,it.Z)(t,[{key:"_dataSourceId",get:function(){return this.props.dataSourceId||ut.UZ.DEFAULT_GRAPHICS}}]),t}(i.PureComponent));var oi={main:4,underlay:8,dash:[5,10]};const ii=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getStrokeStyleByType=function(e){return{simplifyPalette:!1,width:oi.main,dash:oi.dash,opacity:"undergroundWalk"===e?.5:1,palette:t.props.activeRoute.colorizeInfo.map((function(t){var n=t.type,r=t.count;return{color:n===e?"binding"===n?c.uC:"#6000ff":ti.L,count:r}}))}},t._getActiveStyle=function(){return[t._getStrokeStyleByType("undergroundWalk"),t._getStrokeStyleByType("walk"),t._getStrokeStyleByType("binding"),{width:oi.underlay,color:"#fff"}]},t._getInactiveStyle=function(){return[{width:oi.main,color:"#6d6d6d"},{width:oi.underlay,color:"#fff"}]},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props;return i.createElement(ri,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,style:{opacity:.6}},i.createElement(Dn.Z,{key:t.activeRoute.uuid,dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,drawingStyle:{stroke:this._getActiveStyle(),cursor:"default",zIndex:10},geometry:c.d(t.activeRoute),onFastClick:function(e,n){return t.onRouteClick(t.activeRoute,n.coordinates)}}),t.inactiveRoutes?t.inactiveRoutes.map((function(n){return i.createElement(Dn.Z,{key:n.uuid,dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,drawingStyle:{stroke:e._getInactiveStyle(),cursor:"pointer"},geometry:c.d(n),onFastClick:function(e,r){return t.onRouteClick(n,r.coordinates)}})})):null)},t}(i.Component);var ai=n(5055),si=n.n(ai),ci=n(8286),li=n.n(ci),ui=n(9500),di=n.n(ui),pi=n(8755),mi=n.n(pi),fi=n(6176),vi=n.n(fi),hi=n(2621),gi=n.n(hi),yi=n(264),_i=n.n(yi),bi=n(4609),Ei=n.n(bi),wi=n(211),Si=n.n(wi),Ci=n(5642),Zi=n.n(Ci),Ri=n(5111),Pi=n.n(Ri),ki=n(5551),Ii=n.n(ki),Mi=n(6057),Ti=n.n(Mi),xi=n(8776),Li=n.n(xi),Di=n(8704),Ni=n.n(Di),Ai=n(728),zi=n.n(Ai),Ui=n(1512),Oi=n.n(Ui),Fi=n(2501),Bi=n.n(Fi),Hi=n(9627),qi=n.n(Hi),Gi=n(7204),Wi=n.n(Gi),ji={start:[si()],middle:["",li(),di(),mi(),vi(),gi(),_i(),Ei(),Si(),Zi()].concat(new Array(40).fill(Wi())),finish:["",Pi(),Ii(),Ti(),Li(),Ni(),zi(),Oi(),Bi(),qi()].concat(new Array(40).fill(qi()))};const Vi=(0,I.ZP)((function(e){return e.cursor?i.createElement(It.Z,{src:(t=e.cursor,n=t.split("_"),r=n[0],o=n[1],ji[r][Number(o)]),basePoint:[32,44]}):null;var t,n,r,o}));var Yi="#737ce6",Ki={stroke:[{width:4,color:"#6d6d6d"},{width:8,color:"#fff"}],cursor:"pointer"};const $i=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getBicycleActiveDrawingStyle=function(){var e=t.props.mapLocation.zoom>=17,n={width:c.Qt(t.props.mapLocation.zoom).main,opacity:1,palette:(t.props.activeRoute.colorizeInfo||[]).map((function(t){return{count:t.count,color:["PEDESTRIAN","PEDESTRIAN_UNDERGROUND"].includes(t.type)&&e||"BINDING"===t.type?ti.L:"AUTO"===t.type?Yi:"#54b235"}}))},r={width:4,opacity:1,palette:(t.props.activeRoute.colorizeInfo||[]).map((function(e){return{count:e.count,color:"BINDING"===e.type?c.uC:ti.L}})),dash:[5,10]},o={width:e?4:0,opacity:1,palette:(t.props.activeRoute.colorizeInfo||[]).map((function(e){return{count:e.count,color:"PEDESTRIAN"===e.type?Yi:ti.L}})),dash:[5,10]},i={width:e?4:0,opacity:.5,palette:(t.props.activeRoute.colorizeInfo||[]).map((function(e){return{count:e.count,color:"PEDESTRIAN_UNDERGROUND"===e.type?Yi:ti.L}})),dash:[5,10]};return{stroke:[{width:1.5,opacity:1,palette:(t.props.activeRoute.colorizeInfo||[]).map((function(e){return{count:e.count,color:"BICYCLE"===e.type?"#fff":ti.L}})),dash:[2,4]},n,r,o,i,{width:c.Qt(t.props.mapLocation.zoom).underlay,color:"#fff"}],cursor:"default",zIndex:10}},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(ri,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,style:{opacity:1}},i.createElement(Dn.Z,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,drawingStyle:this._getBicycleActiveDrawingStyle(),geometry:c.d(e.activeRoute),onFastClick:function(t,n){return e.onRouteClick(e.activeRoute,n.coordinates)}}),e.inactiveRoutes?i.createElement(ri,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,style:{opacity:.6}},e.inactiveRoutes.map((function(t){return i.createElement(Dn.Z,{key:t.uuid,dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,drawingStyle:Ki,geometry:c.d(t),onFastClick:function(n,r){return e.onRouteClick(t,r.coordinates)}})}))):null)},t}(i.Component);const Xi=function(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(void 0===s?a==a&&!(0,q.Z)(a):n(a,s)))var s=a,c=i}return c};var Qi=n(5365),Ji=n(6808);const ea=function(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=Object(e);o--;){var s=n[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){var c=(s=n[o])[0],l=e[c],u=s[1];if(a&&s[2]){if(void 0===l&&!(c in e))return!1}else{var d=new Qi.Z;if(r)var p=r(l,u,c,e,t,d);if(!(void 0===p?(0,Ji.Z)(u,l,3,r,d):p))return!1}}return!0};const ta=function(e){return e==e&&!(0,ue.Z)(e)};var na=n(8543);const ra=function(e){for(var t=(0,na.Z)(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,ta(o)]}return t};const oa=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}};const ia=function(e){var t=ra(e);return 1==t.length&&t[0][2]?oa(t[0][0],t[0][1]):function(n){return n===e||ea(n,e,t)}};const aa=function(e,t,n){var r=null==e?void 0:ne(e,t);return void 0===r?n:r};const sa=function(e,t){return j(e)&&ta(t)?oa(te(e),t):function(n){var r=aa(n,e);return void 0===r&&r===t?ge(n,e):(0,Ji.Z)(t,r,3)}};var ca=n(4193);const la=function(e){return function(t){return ne(t,e)}};const ua=function(e){return j(e)?(0,ca.Z)(te(e)):la(e)};const da=function(e){return"function"==typeof e?e:null==e?Ce:"object"==typeof e?(0,H.Z)(e)?sa(e[0],e[1]):ia(e):ua(e)};const pa=function(e,t){return e<t};const ma=function(e,t){return e&&e.length?Xi(e,da(t,2),pa):void 0};var fa=n(1091),va=(0,ze.Z)("mrc-map-icon-view");const ha=(0,fa.Z)((function(e){return i.createElement(Ue.Z,{disableRoundCoordinates:!0,coordinates:e.coordinates,nonInteractive:!e.onClick,zIndex:e.zIndex,onClick:e.onClick},i.createElement("div",{className:va({type:e.type||"main"}),style:{transform:"rotate("+(e.direction?e.direction:0)+"deg)"},ref:e.forwardedRef?e.forwardedRef:null}))}));var ga=n(4916),ya=(0,ze.Z)("mrc-preview-balloon"),_a={main:20,side:20},ba=function(e){function t(t){var n;return(n=e.call(this,t)||this)._image=i.createRef(),n._onLoad=function(){n.setState({isPreviewLoaded:!0})},n._renderSpinner=function(){var e;return n.state.isPreviewLoaded||null!==(e=n._image.current)&&void 0!==e&&e.complete?null:i.createElement("div",{className:ya("placeholder")},i.createElement("div",{className:ya("spinner")},i.createElement(ga.Z,{view:"large"})))},n.state={isPreviewLoaded:!1},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(Oe.ZP,{name:"preview_balloon"},i.createElement("div",{ref:e.forwardedRef,className:ya()},i.createElement(Pn.Z,{type:"transparent",coordinates:e.coordinates,position:"bottom-right",offset:_a,onClose:function(){},showArrow:!1,isShown:!0},i.createElement("div",{className:ya("balloon")},this._renderSpinner(),i.createElement("img",{ref:this._image,className:ya("image",{loaded:this.state.isPreviewLoaded}),src:e.image.url,onLoad:this._onLoad})))))},t}(i.Component);const Ea=(0,fa.Z)(ba);var wa=n(1074);const Sa=(0,n(9526).Z)((function(){return n.e("mrc").then(n.bind(n,8031))}),{openPlayer:!0,closePlayer:!0,replaceId:!0,fetchSimilarNearby:!0,fetchSimilar:!0,fetchDirections:!0,enableLayer:!0,disableLayer:!0,play:!0,pause:!0,setGraphType:!0,updateFeatureCache:!0});var Ca=new(function(){function e(){this._queue=[],this._isPending=!1}var t=e.prototype;return t._runNext=function(){var e=this;if(!this._isPending){var t=this._queue[this._queue.length-1];t&&(this._isPending=!0,t.runFn().finally((function(){e._isPending=!1,e._queue.pop(),e._runNext()})))}},t.add=function(e,t){var n=this,r=!1;return{promise:new Promise((function(o,i){n._queue.push({runFn:function(){return r?Promise.resolve().then(i):e().then(o).catch(i)},meta:t}),n._runNext()})),abort:function(){r=!0}}},t.has=function(e){var t=this._queue.find((function(t){var n=t.meta;return e(n)}));return Boolean(t)},e}());const Za=function(e){var t=(0,I.ZR)(),n=Er.I0();return i.useEffect((function(){if(!Boolean(e.feature.properties.imageFull)&&!Ca.has((function(t){return t.includes(e.feature.properties.id)}))){var r=function(e,t){for(var n=[],r=0;n.length<200;){var o=e-r,i=e+(r||1),a=t.features[o],s=t.features[i];if(a&&!a.properties.imageFull&&n.push(a.properties.id),s&&!s.properties.imageFull&&n.push(s.properties.id),o<=0&&i>=t.features.length-1)break;r++}return n}(e.featureCollection.features.indexOf(e.feature),e.featureCollection),o=Ca.add((function(){return wa.Fz(r,t)}),r);return o.promise.then((function(e){n(Sa.updateFeatureCache(e))})).catch((function(){})),function(){o.abort()}}}),[]),null};const Ra=function(e){function t(t){var n;return(n=e.call(this,t)||this)._leaveTimer=0,n._getNearestFeature=function(e){var t=n.props,r=ma(t.featureCollection.features,(function(t){return(0,x.g)(t.geometry.coordinates,e)}));if(!r||r.properties.id!==t.selectedFeatureId)return r},n._onClick=function(){var e=n.state.currentFeature;e&&n.props.onClick&&n.props.onClick(e.properties.id),n.setState({currentFeature:null})},n._onMouseMove=function(e,t){var r=t.coordinates,o=Un(n.props.featureCollection.features.map((function(e){return e.geometry.coordinates})),r,n.props.lineWidth,n.props.zoom);if(o&&!("point"in o)){var i=n._getNearestFeature(o);n.setState({currentFeature:i||null})}},n._onMouseEnter=function(){window.clearTimeout(n._leaveTimer)},n._onMouseLeave=function(){n._leaveTimer=window.setTimeout((function(){n.setState({currentFeature:null})}),200)},n._renderPreview=function(){var e=n.state;return e.currentFeature?e.currentFeature.properties.imagePreview?"placemark"===n.props.preview?i.createElement(ha,{coordinates:e.currentFeature.geometry.coordinates,direction:e.currentFeature.properties.heading||0,type:"additional"}):i.createElement(Ea,{coordinates:e.currentFeature.geometry.coordinates,image:e.currentFeature.properties.imagePreview}):i.createElement(Za,{key:e.currentFeature.properties.id,feature:e.currentFeature,featureCollection:n.props.featureCollection}):null},n.state={currentFeature:null},n._onMouseMove=(0,Yr.Z)(n._onMouseMove,16),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this;if(this.props.featureCollection.features!==e.featureCollection.features&&this.state.currentFeature){var n=this.props.featureCollection.features.find((function(e){var n;return(null===(n=t.state.currentFeature)||void 0===n?void 0:n.properties.id)===e.properties.id}))||null;this.setState({currentFeature:n})}},n.componentWillUnmount=function(){window.clearTimeout(this._leaveTimer)},n.render=function(){var e=this.props;return i.createElement(i.Fragment,null,e.children({onMouseMove:this._onMouseMove,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,onClick:this._onClick}),this._renderPreview())},t}(i.Component);var Pa=n(4960);var ka=(0,ze.Z)("map-routes-auto-view"),Ia=function(e){function t(t){var n;return(n=e.call(this,t)||this)._getPoints=function(){var e=n.props;return e.activeRoute.refPointsLineCoordinates.map((function(t,r){return n.state.editingIndex===r?e.routePoints[r].coords:t}))},n._getPointsWithVia=function(){return{points:n.props.routePoints.map((function(e){return e.coords})),isViaPoints:n.props.routePoints.map((function(e,t){return n.props.viaIndexes.includes(t)}))}},n._getViaIndexesFromRefsWithVia=function(e){return e.map((function(e,t){return e?t:0})).filter(Boolean)},n._removeViaPoint=function(e){if(n.props.onRoutePointsChange){var t=n._getPointsWithVia(),r=t.points,o=t.isViaPoints;r.splice(e,1),o.splice(e,1),n.props.onRoutePointsChange(r,{viaIndexes:n._getViaIndexesFromRefsWithVia(o),isRough:!1})}},n._addViaPoint=function(e,t){if(n.props.onRoutePointsChange){var r=n._getPointsWithVia(),o=r.points,i=r.isViaPoints;o.splice(t,0,e),i.splice(t,0,!0),n.props.setDragging(!0),n.props.onRoutePointsChange(o,{viaIndexes:n._getViaIndexesFromRefsWithVia(i),isRough:!1})}},n._updateViaPoint=function(e,t,r){if(n.props.onRoutePointsChange){var o=n.props.routePoints.slice().map((function(e){return e.coords}));o.splice(t,1,e),n.setState({editingIndex:r?t:void 0}),n.props.onRoutePointsChange(o,{viaIndexes:n.props.viaIndexes,isRough:r})}},n._getActiveRouteStrokeStyles=function(){var e=n.props;return c.TI({route:e.activeRoute,isDefaultColor:e.isDefaultColor},e.config)},n._onPointUpdate=function(e,t,r){n._updateViaPoint(e,t,!r),n.props.setDragging(!r)},n._onMapUpdate=function(){n.setState({mapAzimuth:n.props.map.azimuth})},n._renderPointElement=function(e){var t=n.props.activeRoute.refPointsLineCoordinates.reduce((function(e,t,r){return n.props.viaIndexes.includes(r)?e:e.concat(r)}),[]);return t.includes(e)?null:i.createElement("div",{className:ka("via-point")})},n._renderActiveRoute=function(e){var t=n.props,o=n._getActiveRouteStrokeStyles().underlayStyle.width,a=e?{onLineMouseEnter:e.onMouseEnter,onLineMouseMove:e.onMouseMove,onLineMouseLeave:e.onMouseLeave,onPreviewPointMouseLeave:e.onMouseLeave}:{};return i.createElement(Wn,(0,r.Z)({lineStyle:{stroke:[{width:o,opacity:0}],zIndex:12},polyLineCoordinates:t.activeRoute.coordinates||[],points:n._getPoints(),renderPointElement:n._renderPointElement,previewPointElement:i.createElement("div",{className:ka("via-point",{preview:!0})}),isActive:t.isEditorActive,onPointAdd:n._addViaPoint,onPointUpdate:n._onPointUpdate,onPointRemove:n._removeViaPoint,onPreviewPointClick:function(r,o){o&&n.props.onRouteClick(t.activeRoute,o.coordinates),null==e||e.onClick()}},a))},n._renderActiveMrcFeature=function(){var e=n.props;if(e.isMrcPlayerHidden||e.isLoading||"comparison"===e.travelMode||e.feedback&&"route/edit/better"===e.feedback.type||!e.mrcFeatureCollection||!e.activeMrcIndex&&0!==e.activeMrcIndex||e.isRoutePointDragging||!e.isMrcPlaying&&0===e.activeMrcIndex)return null;var t=e.mrcFeatureCollection.features[e.activeMrcIndex];return t&&t.properties.heading?i.createElement(i.Fragment,null,i.createElement(ha,{coordinates:t.geometry.coordinates,direction:t.properties.heading+(0,Pa.Z)(n.state.mapAzimuth)}),i.createElement(pt.Z,{onUpdate:n._onMapUpdate})):null},n.state={mapAzimuth:t.map.azimuth},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e,t,n=this,r=this.props,o=this._getActiveRouteStrokeStyles().underlayStyle.width,a=!("route/edit/better"===(null===(e=r.feedback)||void 0===e?void 0:e.type))&&!r.config.uatraits.isMobile&&"comparison"!==r.travelMode;return i.createElement(i.Fragment,null,a?i.createElement(Oe.ZP,{name:"mrc_route_thread",logClick:!0},i.createElement(Ra,{featureCollection:r.mrcFeatureCollection||(t=[],{uuid:T()(),type:"FeatureCollection",features:t}),lineWidth:o,zoom:r.zoom,onClick:r.onMrcClick,preview:"balloon"},this._renderActiveRoute)):this._renderActiveRoute(),i.createElement(ri,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,style:{opacity:.7}},i.createElement(Dn.Z,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,drawingStyle:c.X2({route:r.activeRoute,isActive:!0,isDefaultColor:r.isDefaultColor},r.config),geometry:c.d(r.activeRoute)}),r.inactiveRoutes?i.createElement(ri,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,style:{opacity:.86}},r.inactiveRoutes.map((function(e){return i.createElement(Dn.Z,{key:e.uuid,dataSourceId:ut.UZ.DEFAULT_GRAPHICS_UNDER_BUILDINGS,drawingStyle:c.X2({route:e,isActive:!1,isDefaultColor:r.isDefaultColor},r.config),geometry:c.d(e),onFastClick:function(t,r){return n.props.onRouteClick(e,r.coordinates)}})}))):null),r.config.uatraits.isMobile?null:this._renderActiveMrcFeature())},t}(i.Component);const Ma=(0,dt.ZP)({shouldWait:!0})((0,I.ZP)(Ia));var Ta=[{width:4,color:"#6d6d6d"},{width:8,color:"#fff"}],xa={main:4,dash:[5,10]},La="#9d64fb",Da=(0,ze.Z)("map-routes-masstransit-view"),Na=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getStopPlacemarksData=function(){return t.props.activeRoute.paths.reduce((function(e,t){return e.concat(t.segments.reduce((function(e,t){if(!t.stops)return e;var n=t.stops.reduce((function(e,t){return t.coordinateOnRoute?e.concat([t.coordinateOnRoute]):e}),[]);return n.shift(),e.concat({color:t.transports?Aa(t.transports):void 0,coordinates:n})}),[]))}),[])},t._getColorForTransport=function(e){var n=t.props,r=e.type,o=e.segmentIndex;if(["walk","transfer","undergroundWalk","binding"].includes(r))return ti.L;var i=n.activeRoute.paths.reduce((function(e,t){return e.concat(t.segments)}),[]);return o&&i[o]&&i[o].transports?Aa(i[o].transports):Co.Lq(r)},t._getActiveDrawingStyle=function(){var e=t.props;return{cursor:"default",zIndex:10,stroke:[{simplifyPalette:!1,width:c.Qt(e.mapLocation.zoom).main,palette:e.activeRoute.colorizeInfo.map((function(e){return{color:t._getColorForTransport(e),count:e.count}}))},{simplifyPalette:!1,width:xa.main,dash:xa.dash,opacity:.5,palette:e.activeRoute.colorizeInfo.map((function(e){var t=e.type,n=e.count;return{color:["undergroundWalk","transfer"].includes(t)?La:ti.L,count:n}}))},{simplifyPalette:!1,width:xa.main,dash:xa.dash,palette:e.activeRoute.colorizeInfo.map((function(e){var t=e.type,n=e.count;return{color:"walk"===t?La:ti.L,count:n}}))},{simplifyPalette:!1,width:xa.main,dash:xa.dash,palette:e.activeRoute.colorizeInfo.map((function(e){var t=e.type,n=e.count;return{color:"binding"===t?c.uC:ti.L,count:n}}))},{width:c.Qt(e.mapLocation.zoom).underlay,opacity:.9,color:"#fff"}]}},t._renderStopDots=function(){return t.props.mapLocation.zoom<14?null:t._getStopPlacemarksData().map((function(e,t){return e.coordinates.map((function(n,r){return i.createElement(Ue.Z,{key:t+"_"+r,coordinates:n,zIndex:Fe.I.default},i.createElement("div",{className:Da("stop-dot"),style:{borderColor:e.color}}))}))}))},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props;return i.createElement(i.Fragment,null,i.createElement(ri,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS,style:{opacity:1}},i.createElement(Dn.Z,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS,drawingStyle:this._getActiveDrawingStyle(),geometry:c.d(t.activeRoute),onFastClick:function(e,n){return t.onRouteClick(t.activeRoute,n.coordinates)}}),t.inactiveRoutes?i.createElement(ri,{dataSourceId:ut.UZ.DEFAULT_GRAPHICS,style:{opacity:.6}},t.inactiveRoutes.map((function(t){return i.createElement(Dn.Z,{key:t.uuid,dataSourceId:ut.UZ.DEFAULT_GRAPHICS,drawingStyle:{cursor:"pointer",stroke:Ta},geometry:c.d(t),onFastClick:function(n,r){return e.props.onRouteClick(t,r.coordinates)}})}))):null),this._renderStopDots())},t}(i.Component);function Aa(e){var t=c.Sk(e);return Co.Sm(t)}const za=(0,I.ZP)(Na);var Ua=(0,ze.Z)("route-warning-view"),Oa={barrier:"snippet-barrier-20",blocked:"snippet-closed-20",ferries:"snippet-ferry-20",ford:"snippet-ford-crossing-20",general:"snippet-all-20","rugged-road":"snippet-bad-road-20",tolls:"snippet-paid-fallback-20",frontier:"snippet-border-20","railway-crossing":"snippet-railway-crossing-20-flip"};const Fa=function(e){var t=e.type;return i.createElement("div",{className:Ua("wrapper")},i.createElement(He.Z,{name:Oa[t],className:Ua({type:t}),inline:!0}))};var Ba={pedestrian:"pedestrian-24-flip",bicycle:"bikes-24-flip",auto:"car-24",masstransit:"bus-24"},Ha=(0,ze.Z)("map-widget-routes-content-view"),qa=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n._renderContent=function(){switch(this.props.route.type){case"bicycle":case"pedestrian":case"masstransit":var e=c.K$(this.props.route.duration,this.props.config);return this._renderContentCommon(e,this.props.route.distance.text);case"auto":return this._renderContentAuto();default:return null}},n._renderRouteWarning=function(e){return"auto"===e.type?e.flags.blocked?i.createElement(Fa,{type:"blocked"}):e.flags.hasTolls?i.createElement(Fa,{type:"tolls"}):null:null},n._renderContentCommon=function(e,t){return i.createElement(i.Fragment,null,i.createElement("div",{className:Ha("header")},i.createElement(He.Z,{name:Ba[this.props.route.type],inline:!0,className:Ha("icon")}),e,i.createElement("div",{className:Ha("warning")},this._renderRouteWarning(this.props.route))),i.createElement("div",{className:Ha("body")},t))},n._renderContentAuto=function(){var e=this.props;if("auto"!==e.route.type)return null;var t,n=(t={duration:c.K$(e.route.duration,e.config),distance:e.route.distance.text}).distance+", без пробок: "+t.duration,r=c.K$(e.route.durationInTraffic,e.config),o=e.route.flags.blocked?"Проезд закрыт":r;return this._renderContentCommon(o,n)},n.render=function(){var e=D.md(this.props.config);return i.createElement("div",{className:Ha()},this._renderContent(),e?null:i.createElement(kn.Z,{view:"secondary-blue",size:"small",url:this.props.url,target:"_blank",isStretched:!0},"Подробнее"))},t}(i.Component);const Ga=(0,I.ZP)(qa);var Wa=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this)._lastChangedPointIndex=0,t._checkAndChangeBounds=function(){var e,n,r;if(!(t.props.routerResponse&&0===t.props.routerResponse.routes.length||"routes"!==(null===(e=t.props.config.mapWidget)||void 0===e?void 0:e.activeMode))){var o=(null===(n=t.props.routerResponse)||void 0===n?void 0:n.routes[t.props.activeRouteIndex])||(null===(r=t.props.routerResponse)||void 0===r?void 0:r.routes[0]),i=null==o?void 0:o.bounds,a=t.props.routePoints.filter((function(e){return Boolean(e.coords)}));if(0!==a.length){var s=a?wn.o(a.map((function(e){return e.coords}))):void 0,c=i||s;c&&t.props.onBoundsChange(c)}}},t._onRoutePointsChange=function(e){var n=t.props.routePoints.findIndex((function(t){return!!t.coords&&!e.includes(t.coords)}));-1===n&&(n=e[t._lastChangedPointIndex]?t._lastChangedPointIndex:e.length-1),t._lastChangedPointIndex=n,t.props.updateRoutePoint({coords:e[n],value:""},n)},t._onMapClick=function(e,n){var r={coords:n.coordinates,value:"",input:""};t.props.updateRoutePoint(r,t.props.emptyPointIndex)},t._renderContent=function(){var e,n;if(!t.props.content||!t.props.routerResponse||t.props.isRoutePointDragging)return null;var o=t.props.routerResponse.routes[t.props.activeRouteIndex]||t.props.routerResponse.routes[0];if(!o)return null;var a=t.props.content.data.coordinates||(null===(e=o.coordinates)||void 0===e?void 0:e[Math.floor((null===(n=o.coordinates)||void 0===n?void 0:n.length)/2)]);if(!a)return null;var s=c.DP({routePoints:t.props.routePoints,viaIndexes:t.props.routerResponse.viaIndexes||[],travelMode:t.props.routerResponse.type,activeRouteIndex:t.props.activeRouteIndex,routerResponse:null,detailedIndex:-1,settings:{auto:{ignoreTrafficJams:cr(t.props.config),avoid:[],timeDependent:{type:"departure"}},masstransit:{avoidTypes:[],timeDependent:{type:"departure"}}}},t.props.config),d={l:t.props.isTrafficLayerEnabled?t.props.config.query.l||"trf":void 0},p=(0,u._)(l.e_(l.sY("",(0,r.Z)({},s,d,{routes:{avoidTypes:void 0}})),t.props.config));return i.createElement(tr.Z,{coordinates:a,displayType:"balloon",mapLocation:t.props.mapLocation,onClose:t.props.resetContentData,offset:{main:3,side:3},mapSize:t.props.mapSize,key:o.uuid},i.createElement(Ga,{route:o,url:p}))},t._renderRouteView=function(){if(!t.props.routerResponse||0===t.props.routerResponse.routes.length)return null;var e=t.props.routerResponse.routes[t.props.activeRouteIndex]||t.props.routerResponse.routes[0],n=t.props.routerResponse.routes.filter((function(t){return t.uuid!==e.uuid}));switch(e.type){case"pedestrian":return i.createElement(ii,{activeRoute:e,inactiveRoutes:n,onRouteClick:t.props.onRouteClick});case"bicycle":return i.createElement($i,{activeRoute:e,inactiveRoutes:n,mapLocation:t.props.mapLocation,onRouteClick:t.props.onRouteClick});case"auto":return i.createElement(Ma,{activeRoute:e,inactiveRoutes:n,viaIndexes:t.props.routerResponse.viaIndexes||[],routePoints:t.props.routePoints,zoom:t.props.mapLocation.zoom,feedback:null,isDefaultColor:Boolean(t.props.isTrafficLayerEnabled)||(e.colorizeInfo||[]).every((function(e){return"UNKNOWN"===e.type})),isLoading:!1,isEditorActive:!1,setDragging:ja,onRouteClick:t.props.onRouteClick});case"masstransit":return i.createElement(za,{activeRoute:e,inactiveRoutes:n,onRouteClick:t.props.onRouteClick,mapLocation:t.props.mapLocation});default:return null}},t._renderRoutePinsView=function(){var e,n,r,o=(null===(e=t.props.routerResponse)||void 0===e?void 0:e.routes[t.props.activeRouteIndex])||(null===(n=t.props.routerResponse)||void 0===n?void 0:n.routes[0])||null;return i.createElement(ei,{activeRoute:o,travelMode:null==o?void 0:o.type,routePoints:t.props.routePoints,viaIndexes:(null===(r=t.props.routerResponse)||void 0===r?void 0:r.viaIndexes)||[],draggable:!0,isRoutePointDragging:t.props.isRoutePointDragging,draggableIndexes:t.props.draggablePointIndexes,setDragging:t.props.setDragging,onRoutePointsChange:t._onRoutePointsChange})},t._renderRouteCursor=function(){return t.props.cursor?i.createElement(Vi,{cursor:t.props.cursor}):null},t._renderMapListener=function(){return-1===t.props.emptyPointIndex?null:i.createElement(pt.Z,{onClick:t._onMapClick})},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._checkAndChangeBounds()},n.componentDidUpdate=function(e){!e.routerResponse&&this.props.routerResponse&&this._checkAndChangeBounds()},n.render=function(){return i.createElement(i.Fragment,null,this._renderRouteView(),this._renderRoutePinsView(),this._renderRouteCursor(),this._renderMapListener(),this._renderContent())},t}(i.Component);function ja(){}const Va=(0,I.ZP)(Wa);var Ya=n(284),Ka=(0,ze.Z)("user-maps-map-view"),$a=function(e){function t(t){var n;return(n=e.call(this,t)||this)._renderFeature=function(e,t,r){var o=n.props.config,a=(e.zIndex||r.length-t)+(t===n.state.hoveredIndex?r.length:0),s=!1;if("placemark"===e.type){var c,l;if(e.content)if("text"===e.content.type)c=i.createElement("div",{className:Ka("text")},e.content.text);else if(null!==(l=o.query.cnstr)&&void 0!==l&&l[e.content.name]){var u=o.query.cnstr[e.content.name];c=i.createElement(He.Z,{name:u,className:Ka("icon")})}else{var d=ho.y7(e.content.name),p="fallback"===e.content.name;d&&(s=!p,c=i.createElement(Ye.Z,{className:Ka("icon",{fallback:p}),url:d}))}return i.createElement(tt,{key:t,coordinates:e.coordinates,zIndex:a,color:e.stroke&&e.stroke.color,onClick:function(){return n.props.onFeatureClick(t,e.coordinates)},onMouseEnter:function(){return n.setState({hoveredIndex:t})},onMouseLeave:function(){return n.setState({hoveredIndex:-1})},comma:e.isComma,caption:e.caption,size:s?"large":"medium",outline:!0},c)}return i.createElement(Dn.Z,{key:t,geometry:n._moveGeometryToZeroWorld(e.geometry),drawingStyle:{zIndex:a,cursor:n.props.cursor||"pointer",stroke:e.stroke?[e.stroke]:void 0,fill:"polygon"===e.type&&e.fill?e.fill.color:void 0,fillOpacity:"polygon"===e.type&&e.fill?e.fill.opacity:void 0,interactive:Boolean(e.balloonCoordinates)},onClick:function(e,r){return n.props.onFeatureClick(t,r.coordinates)}})},n.state={hoveredIndex:-1},n}(0,o.Z)(t,e);var n=t.prototype;return n._moveGeometryToZeroWorld=function(e){var t=1/0,n=-1/0;(0,Ya.ZE)(e,(function(e){t=e[0]<t?e[0]:t,n=e[0]>n?e[0]:n}));var r=360*-Math.trunc((n+t)/360);return r?(0,Ya.ZE)(e,(function(e){return[e[0]+r,e[1]]})):e},n.render=function(){return this.props.features.map(this._renderFeature)},t}(i.PureComponent);const Xa=(0,I.ZP)($a);var Qa=(0,ze.Z)("user-maps-balloon-content");const Ja=function(e){return i.createElement(i.Fragment,null,"placemark"===e.feature.type&&e.feature.caption&&e.showTitle?i.createElement("div",{className:Qa("title"),dangerouslySetInnerHTML:{__html:e.feature.caption}}):null,i.createElement("span",{dangerouslySetInnerHTML:{__html:e.feature.isTextInTitle?e.feature.title:e.feature.subtitle}}))};var es=(0,ze.Z)("map-widget-user-maps-content-view"),ts=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){return this.props.feature.balloonCoordinates?i.createElement("div",{className:es()},i.createElement(Ja,{showTitle:!1,feature:this.props.feature})):null},t}(i.Component);const ns=(0,I.ZP)(ts);const rs=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getDisplayType=function(){return t.props.mapSize.width*t.props.mapSize.height>16e4?"balloon":"panel"},t._renderContent=function(){return t.props.content&&(t.props.content.data.feature.isTextInTitle?t.props.content.data.feature.title:t.props.content.data.feature.subtitle)?i.createElement(tr.Z,{coordinates:t.props.content.data.coordinates,mapLocation:t.props.mapLocation,updateLocationRequest:t.props.updateLocationRequest,displayType:t._getDisplayType(),onClose:t.props.resetContentData,mapSize:t.props.mapSize},i.createElement(ns,{feature:t.props.content.data.feature})):null},t}return(0,o.Z)(t,e),t.prototype.render=function(){return i.createElement(i.Fragment,null,i.createElement(Xa,{features:this.props.userMap.features,cursor:this.props.cursor,onFeatureClick:this.props.onFeatureClick}),this._renderContent())},t}(i.Component);var os=n(4403),is=(0,ze.Z)("masstransit-underground-line-name-view");const as=function(e){var t,n,r=e.transport,o=(0,Bt.Fg)(),a=r.transportSystemId?null===(t=co[r.transportSystemId])||void 0===t?void 0:t.small:null;return i.createElement("div",{className:is()},a?i.createElement("div",{className:is("icon")},i.createElement(He.Z,{inline:!0,name:a,theme:o})):null,i.createElement("div",{className:is("line-number"),style:{backgroundColor:r.Style&&r.Style.color||"transparent"}},null!==(n=r.shortName)&&void 0!==n?n:null),i.createElement("div",{className:is("line-name")},r.name))};var ss=n(999),cs=n(7062),ls=(0,ze.Z)("map-widget-masstransit-stop-content-view");const us=function(e){var t,n,r,o=(0,I.ZR)(),a=e.content.data.stop,s=a.region?l.uf(a,a.region):"",c=(0,u._)(l.e_("/"+s,o)),d={coords:a.coordinates,value:"",uri:null===(t=a.searchResult)||void 0===t?void 0:t.uri},p=(0,u.V)([{coords:null,value:""},d],{},o),m=function(){if("railway"===a.type){var e,t=null===(e=a.links)||void 0===e?void 0:e.find((function(e){return"timetable"===e.type}));return null==t?void 0:t.href}if("underground"===a.type)return l.WU(o.hosts.metro,{ll:(0,$t.s)(a.coordinates)});if("urban"===a.type&&a.region){var n=l.uf(a,a.region)||"";return(0,u._)(l.e_("/"+n,o))}};return i.createElement("div",{className:ls()},i.createElement(ss.Z,{title:("underground"===a.type?"Станция метро":"railway"===a.type?"Ж/д станция":"Остановка")+" "+a.name,titleUrl:c,subtitle:"underground"!==a.type?null===(n=a.searchResult)||void 0===n?void 0:n.description:void 0}),"underground"===a.type&&a.transports[0]?i.createElement("div",{className:ls("underground-title")},i.createElement(as,{transport:a.transports[0]})):null,i.createElement("div",{className:ls("buttons-container")},i.createElement("div",{className:ls("button-container")},i.createElement(kn.Z,{view:"secondary-blue",size:"small",isStretched:!0,url:p,target:"_blank"},"Как добраться")),i.createElement("div",{className:ls("button-container")},i.createElement(kn.Z,{view:"primary",size:"small",isStretched:!0,url:m(),target:"_blank"},"underground"===a.type?"Схема метро":"railway"===a.type?"Показать расписание":"Список маршрутов"))),null!==(r=a.searchResult)&&void 0!==r&&r.metro&&"underground"!==a.type?i.createElement("div",{className:ls("nearest-stops")},i.createElement(cs.Z,{result:a.searchResult})):null)};var ds={bus:{small:"rubrics-bus-stop-14-flip",normal:"rubrics-bus-stop-24-flip"},minibus:{small:"rubrics-bus-stop-14-flip",normal:"rubrics-bus-stop-24-flip"},tramway:{small:"rubrics-tram-stop-14-flip",normal:"rubrics-tram-stop-24-flip"},trolleybus:{small:"rubrics-bus-stop-14-flip",normal:"rubrics-bus-stop-24-flip"},water:{small:"rubrics-pier-14",normal:"rubrics-pier-24"},underground:{small:"rubrics-subway-fallback-14",normal:"rubrics-subway-fallback-24"},suburban:{small:"rubrics-railway-station-14-flip",normal:"rubrics-railway-station-24-flip"},funicular:{small:"rubrics-funicular-14-flip",normal:"rubrics-funicular-24-flip"},cable:{small:"rubrics-cableway-14-flip",normal:"rubrics-cableway-24-flip"},aeroexpress:{small:"aeroexpress-14",normal:"aeroexpress-24"},fallback:{small:"rubrics-fallback-14",normal:"rubrics-fallback-24"}};const ps=function(e){var t,n,r,o,a=(0,Bt.Fg)();if(!e.vehicleType)return null;var s=null===(t=co[null!==(n=e.transportSystemId)&&void 0!==n?n:""])||void 0===t?void 0:t[e.size],c=s||(null===(r=ds[e.vehicleType])||void 0===r?void 0:r[e.size])||(null===(o=ds.fallback)||void 0===o?void 0:o[e.size]);return c?i.createElement(He.Z,{inline:!0,name:c,className:e.className,theme:s?a:void 0}):null};var ms=n(4373),fs=n.n(ms),vs=n(7022),hs=n.n(vs),gs=n(5119),ys=n.n(gs),_s=(0,ze.Z)("masstransit-stop-placemark"),bs=function(e){function t(){return e.apply(this,arguments)||this}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props;return i.createElement(vr,{name:"masstransit_stop_placemark",logClick:!0},i.createElement(Ue.Z,{coordinates:e.coordinates,onClick:e.onClick,zIndex:Fe.I.masstransitStop},i.createElement("div",{className:_s({bookmark:e.isBookmark})},!e.hotspotIconUrl||e.isBookmark?i.createElement(ps,{className:_s("content-icon"),size:"normal",vehicleType:e.type,transportSystemId:e.transportSystemId}):null,e.hotspotIconUrl&&!e.isBookmark?i.createElement("img",{alt:"",src:e.hotspotIconUrl,className:_s("background-icon"),width:"60",height:"68"}):i.createElement(Ye.Z,{className:_s("background-icon"),url:e.isBookmark?hs():e.transportSystemId?ys():fs()}))),e.id?i.createElement(so.Z,{uri:O.p1(e.id)}):null)},t}(i.PureComponent);const Es=(0,I.ZP)(bs);var ws=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._getDisplayType=function(){return t.props.mapSize.width>=460?"balloon":"panel"},t._renderStopPlacemark=function(e,t){var n,r=(0,Co.Od)(e);"underground"===r&&(n=e.transports[0].transportSystemId);return i.createElement(Es,{id:e.id,type:r,coordinates:e.coordinates,transportSystemId:n,isBookmark:!1,onClick:function(){return null==t?void 0:t(e)}})},t._renderStaticStop=function(){var e,n=t.props.config.masstransitStop;return n&&n.id!==(null===(e=t.props.content)||void 0===e?void 0:e.data.stop.id)?t._renderStopPlacemark(n,t.props.onStaticPlacemarkClick):null},t._renderContentStop=function(){var e=t._getDisplayType();return t.props.content?i.createElement(i.Fragment,null,i.createElement(tr.Z,{coordinates:t.props.content.data.coordinates,mapLocation:t.props.mapLocation,updateLocationRequest:t.props.updateLocationRequest,onClose:t.props.onContentClose,displayType:e,mapSize:t.props.mapSize},i.createElement(us,{content:t.props.content})),"panel"===e?t._renderStopPlacemark(t.props.content.data.stop):null):null},t}return(0,o.Z)(t,e),t.prototype.render=function(){return i.createElement(i.Fragment,null,this._renderContentStop(),this._renderStaticStop())},t}(i.Component);const Ss=(0,I.ZP)(ws);var Cs;function Zs(e,t){var n,r,o,i,a=e.threads[0];if(null!=a&&null!==(n=a.BriefSchedule)&&void 0!==n&&n.Events&&(null===(r=a.BriefSchedule)||void 0===r?void 0:r.Events.length)>0){var s,c,l=(null===(s=a.BriefSchedule.Events[0].Estimated)||void 0===s?void 0:s.value)||(null===(c=a.BriefSchedule.Events[0].Scheduled)||void 0===c?void 0:c.value);if(l){var u=1e3*Number(l);return u-t<6e4?u-t:u}}if(null!=a&&null!==(o=a.BriefSchedule)&&void 0!==o&&o.Frequencies&&(null==a||null===(i=a.BriefSchedule)||void 0===i?void 0:i.Frequencies.length)>0){var d=1e3*a.BriefSchedule.Frequencies[0].value,p=a.BriefSchedule.Frequencies[0].begin?1e3*Number(a.BriefSchedule.Frequencies[0].begin.value):void 0,m=a.BriefSchedule.Frequencies[0].end?1e3*Number(a.BriefSchedule.Frequencies[0].end.value):void 0;return m&&m<t?-1/0:!p||p<t?d:p}return-1/0}const Rs={loadLayerRegions:function(e){return Cs||(Cs=(0,P.Z)("masstransit/getLayerRegions",{},e).catch((function(){return[]})))},getStopInfo:function(e,t){return(0,P.Z)("masstransit/getStopInfo",{query:{id:e.id,uri:e.uri,locale:t.locale,lang:t.lang,mode:"prognosis"}},t).then((function(e){if(!e)throw new Error("Stop no data");return e}))},getStopTimetable:function(e,t){return(0,P.Z)("masstransit/getStopTimetable",{query:{id:e.id,timestamp:e.timestamp,locale:t.locale,lang:t.lang}},t).then((function(e){if(!e)return null;var t=function(e){var t={id:e.id,name:e.name,type:e.type,currentTime:e.currentTime,region:e.region,tzOffset:e.tzOffset,transports:(0,_e.Z)(e.transports.map((function(e){return(0,_e.Z)(e.threads.map((function(t){var n=[],o=(0,r.Z)({},e,{description:t.description});return t.BriefSchedule&&t.BriefSchedule.Frequencies.length>0&&n.push.apply(n,t.BriefSchedule.Frequencies.map((function(e){var n;return(0,r.Z)({},o,{threads:[(0,r.Z)({},t,{BriefSchedule:{Frequencies:[e],Events:[],departureTime:null===(n=t.BriefSchedule)||void 0===n?void 0:n.departureTime}})]})}))),t.BriefSchedule&&t.BriefSchedule.Events.length>0&&n.push.apply(n,t.BriefSchedule.Events.map((function(e){var n;return(0,r.Z)({},o,{threads:[(0,r.Z)({},t,{BriefSchedule:{Frequencies:[],Events:[e],departureTime:null===(n=t.BriefSchedule)||void 0===n?void 0:n.departureTime}})]})}))),0===n.length&&n.push((0,r.Z)({},o,{threads:[(0,r.Z)({},t)]})),n})))})))};return t}(e);return t.transports=t.transports.filter((function(e){return Zs(e,t.currentTime)>0})).sort((function(e,n){return Zs(e,t.currentTime)-Zs(n,t.currentTime)})),t}))},getVehiclesInfo:function(e,t){return(0,P.Z)("masstransit/getVehiclesInfoWithRegion",{query:(0,r.Z)({locale:t.locale,lang:t.lang},e)},t)},getVehiclePredictionInfo:function(e,t){return(0,P.Z)("masstransit/getVehiclePredictionInfo",{query:(0,r.Z)({},e)},t)},getLine:function(e,t){return(0,P.Z)("masstransit/getLine",{query:(0,r.Z)({locale:t.locale,lang:t.lang},e)},t)},getDistance:function(e,t){return(0,P.Z)("masstransit/distance",{query:{startPoint:(0,$t.s)(e.coordinates),destinationPoints:e.stops.map((function(e){return(0,$t.s)(e.coordinates)})),locale:t.locale}},t)}};function Ps(e,t){var n=e.feature,o=n.properties,i=n.properties.uri;return function(e,t){return Rs.getStopInfo(e,t).then((function(t){return(0,r.Z)({},t,{coordinates:e.hotspotCoordinates||t.coordinates})}))}({id:O.QT(i),uri:i,hotspotProperties:o,hotspotCoordinates:e.coordinates,clearLine:!0},t).then((function(e){return{type:"masstransit-stop",data:{stop:e,coordinates:e.coordinates}}}))}const ks=function(e){var t=(0,I.ZR)(),n=e.poiData,r=e.updateContent;return i.useEffect((function(){var e;if(n){p.Z.cancel(e);var o=O.lB(n.feature.properties.uri)?Ps(n,t):function(e,t){var n,r,o,i=e.feature,a=i.properties,s=i.properties.uri,c={clientId:null===(n=t.mapWidget)||void 0===n?void 0:n.clientId,origin:null!==(r=null===(o=t.mapWidget)||void 0===o?void 0:o.origin)&&void 0!==r?r:"poi",from:"poi",coordinates:e.coordinates,hotspotProperties:a,uri:s};return Te.Z.fetchSearchResult(c,t).then((function(t){var n=null==t?void 0:t.items[0];return n?{type:"search",data:{result:n,coordinates:e.coordinates}}:null}))}(n,t);e=p.Z.create(o,{success:function(e){e&&r(e)}})}return function(){p.Z.cancel(e)}}),[n,r,t]),null};function Is(e,t,n){return void 0===n&&(n=0),(0,P.Z)("router/optimize/get",{query:e},t).then((function(r){var o;if(n>=15e3||!r||"failed"===r.status)return null;if("completed"===r.status)return r.points;var i=null!==(o=r.delay)&&void 0!==o?o:1e3;return v.Dc(i).then((function(){return Is(e,t,n+i)}))}))}const Ms={getSummary:function(e,t){return(0,P.Z)("router/getSummary",{query:(0,r.Z)({},e,{lang:t.lang,locale:t.locale})},t)},optimizeRoutePoints:function(e,t){return(0,P.Z)("router/optimize/add",{query:(0,r.Z)({},e,{lang:t.locale})},t).then((function(e){var n;return e?v.Dc(null!==(n=e.delay)&&void 0!==n?n:1e3).then((function(){return Is({id:e.id},t)})):null}))},buildRoute:function(e,t){return(0,P.Z)("router/buildRoute",{query:(0,r.Z)({},e,{locale:t.locale,lang:t.lang})},t)},restoreRoute:function(e,t){return(0,P.Z)("router/restoreRoute",{query:(0,r.Z)({},e,{locale:t.locale,lang:t.lang})},t)},pollIntercityPrice:function(e,t){return(0,P.Z)("router/poll-intercity-price",{query:e},t)}};var Ts=function(e){function t(t){var n;return(n=e.call(this,t)||this)._buildRouteAction=void 0,n._buildRouteDebounced=void 0,n._buildRoute=function(){var e=n.props,t=c.Ht(e.config,{travelMode:lr(e.config),routerResponse:null,routePoints:e.routePoints,activeRouteIndex:-1,viaIndexes:[],settings:{auto:{ignoreTrafficJams:cr(e.config),avoid:[],timeDependent:{type:"departure"}},masstransit:{avoidTypes:[],timeDependent:{type:"departure"}}}},{});p.Z.cancel(n._buildRouteAction),n._buildRouteAction=p.Z.create(Ms.buildRoute(t,e.config),{success:function(t){if(t){var n=c.NA(t);e.onLoad(n)}},fail:function(){e.onLoad(null)}})},n._buildRouteDebounced=(0,ht.Z)(n._buildRoute,100),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){e.routePoints!==this.props.routePoints&&this._buildRouteDebounced()},n.componentWillUnmount=function(){p.Z.cancel(this._buildRouteAction)},n.render=function(){return null},t}(i.Component);const xs=(0,I.ZP)(Ts);var Ls=n(267);const Ds=function(e,t){var n,r=(n=(0,i.useRef)(!0)).current?(n.current=!1,!0):n.current;(0,i.useEffect)((function(){if(!r)return e()}),t)};var Ns=n(9845),As=n(2151),zs=n(2362),Us=n(3812),Os=n(2447),Fs=n(3480),Bs=(0,ze.Z)("map-widget-search-result-list-item");const Hs=function(e){var t,n=(0,I.ZR)();return i.createElement("div",{className:Bs(),onClick:function(){e.onClick(e.item)}},"toponym"===e.item.type?(t=e.item,i.createElement(ss.Z,{title:t.title,subtitle:t.description})):function(t){var o,a=Os.lR(t,n);return i.createElement(i.Fragment,null,i.createElement(ss.Z,{title:e.item.title,subtitle:null===(o=t.categories)||void 0===o?void 0:o.slice(0,2).map((function(e){return e.name})).join(", ")}),i.createElement("div",{className:Bs("data")},i.createElement(Fs.Z,{result:t,disableLink:!0}),i.createElement("div",{className:Bs("time-label",(0,r.Z)({},a.state))},a.text)))}(e.item))};function qs(e,t){var n=t[0],r=t[1];return e.reduce((function(e,t){return"string"!=typeof t?e.push(t):t.split(n).forEach((function(t,n){n>0&&e.push(r),e.push(t)})),e}),[])}const Gs=function(e,t){return Object.entries(t).reduce(qs,[e]).filter((function(e){return e})).map((function(e,t){return i.createElement("span",{key:t},e)}))};var Ws=(0,ze.Z)("map-widget-search-result-list-view"),js={main:-4,side:4},Vs={top:10,right:10};const Ys=function(e){var t,n,r,o,a=(0,I.ZR)(),s=(null!==(t=null===(n=e.searchResults)||void 0===n?void 0:n.totalResultCount)&&void 0!==t?t:0)-(null!==(r=null===(o=e.searchResults)||void 0===o?void 0:o.items.length)&&void 0!==r?r:0),c=i.useMemo((function(){return e.mapSize.width<=460?"fullscreen":"balloon"}),[e.mapSize]),u=function(t){var n,r,o,c,u,d=(a.query["display-text"]||a.query.text||"").toString(),p=e.searchResults;return null!==(n=p.chain)&&void 0!==n&&n.name&&(d=p.chain.name),i.createElement(i.Fragment,null,d?i.createElement("div",{className:Ws("header")},"Результаты поиска «"+{query:d}.query+"»"):null,i.createElement("div",{style:{maxHeight:t-30}},i.createElement(zs.Z,{width:"dynamic"},e.searchResults?i.createElement("div",null,e.searchResults.items.map((function(t){return i.createElement(Hs,{item:t,key:t.id,onClick:e.onListItemClick})}))):null,e.isLoading?i.createElement("div",{className:Ws("spinner-container")},i.createElement(ga.Z,{view:"small"})):e.searchResults&&s>0?i.createElement("div",{className:Ws("more"),onClick:e.onLoadMoreClick},function(e){return"Показать ещё "+e.count+" "+(e.count%10==1&&e.count%100!=11?"результат":e.count%10>1&&e.count%10<5&&(e.count%100<10||e.count%100>20)?"результата":"результатов")}({count:Math.min(e.searchResults.requestResults,s)})):null,i.createElement("div",{className:Ws("footer")},i.createElement("div",{className:Ws("icon")},i.createElement(He.Z,{name:"super-search-24-flip",inline:!0})),i.createElement("span",{className:Ws("caption")},Gs("Не нашли, что искали, — измените масштаб или __refineSearch",{__refineSearch:(c=l.VJ(e.mapLocation,a.query.text,a.query.chain,null===(r=a.searchPreloadedResults)||void 0===r||null===(o=r.chain)||void 0===o?void 0:o.name,a.query.filter),u=l.e_("/?"+c,a),i.createElement("a",{className:Ws("link"),href:u,target:"_blank"},"уточните запрос"))}))))))};return"fullscreen"===c?i.createElement(Ns.Z,null,i.createElement("div",{className:Ws("fullscreen-container")},i.createElement(Us.Z,{offset:Vs,onClick:e.onListClose}),u(e.mapSize.height-10))):i.createElement(As.Z,{isShown:!0,getTarget:function(){var t;return(null===(t=e.targetRef)||void 0===t?void 0:t.current)||null},onClose:e.onListClose,type:"normal",position:["bottom-left"],offset:js},i.createElement("div",{className:Ws("balloon-container")},u(e.mapSize.height-110)))};var Ks=(0,ze.Z)("map-widget-search-control-view");const $s=(0,fa.Z)((function(e){return i.createElement("div",{className:Ks({checked:e.checked}),ref:e.forwardedRef},i.createElement(kn.Z,{size:"small",view:"air-alt",checked:e.checked,icon:i.createElement(He.Z,{name:"search-24",inline:!0,className:Ks("icon")}),onClick:e.onClick},(t={count:e.resultsCount}).count+" "+(t.count%10==1&&t.count%100!=11?"найден":"найдено")));var t}));const Xs=function(e){var t,n,r,o=i.useRef(null),a=i.useMemo((function(){return e.mapSize.width<295||e.mapSize.height<250}),[e.mapSize]);return i.createElement(i.Fragment,null,(r=null!==(t=null===(n=e.searchResults)||void 0===n?void 0:n.totalResultCount)&&void 0!==t?t:0,a?null:i.createElement($s,{resultsCount:r,checked:e.isResultsListShown,ref:o,onClick:e.onControlClick})),!a&&e.isResultsListShown&&e.searchResults?i.createElement(Ys,{searchResults:e.searchResults,mapSize:e.mapSize,isLoading:e.isLoading,targetRef:o,mapLocation:e.mapLocation,onListItemClick:e.onResultClick,onListClose:e.onListClose,onLoadMoreClick:e.onLoadMoreClick}):null)};var Qs=n(9413);const Js=function(e){var t=(0,I.ZR)(),n=Ls.Z((function(n,o){var i,a,s,c,l,u="search"===(null===(i=e.content)||void 0===i?void 0:i.type)?e.content.data.result.id:void 0,d=null==o?void 0:o.items.find((function(e){return e.id===u})),p=null!==(a=null==o?void 0:o.requestResults)&&void 0!==a?a:10,m=e.mapLocation,f={text:t.query.chain?"chain_id:("+t.query.chain+")":t.query.text,filters:t.query.filter?t.query.filter.split(";"):void 0,clientId:null===(s=t.mapWidget)||void 0===s?void 0:s.clientId,origin:null===(c=t.mapWidget)||void 0===c?void 0:c.origin,center:m.center,span:m.span,bounds:m.bounds,zoom:m.zoom,count:null==o?void 0:o.requestResults,type:["biz","geo"],context:null==o?void 0:o.requestContext,skip:n?Math.floor((null!==(l=null==o?void 0:o.items.length)&&void 0!==l?l:0)/p)*p:void 0};return Te.Z.fetch(f,t).then((function(e){var t=e.items;return!d||t.find((function(e){return e.id===d.id}))||n&&null!=o&&o.items.find((function(e){return e.id===d.id}))||t.push(d),(0,r.Z)({},e,{items:n&&o?[].concat(o.items,t):t})})).catch((function(){return o}))}),[e.mapLocation,t],{value:t.searchPreloadedResults,loading:!1}),o=n[0],a=n[1],s=Boolean(o.value);Ds((function(){s&&a(!1,o.value)}),[e.mapLocation,t]);var c,l=function(){a(!0,o.value)},u=function(){var t;e.setListContent("search-list"===(null===(t=e.content)||void 0===t?void 0:t.type)?null:{type:"search-list"})},d=function(){e.setListContent(null)},p=i.useMemo((function(){var n,r,o,i,a;return["search"===(null===(n=e.content)||void 0===n?void 0:n.type)?e.content.data.result:void 0,null===(r=t.mapWidget)||void 0===r||null===(o=r.activeObject)||void 0===o?void 0:o.items[0],null===(i=t.poiPreloadedResults)||void 0===i?void 0:i.items[0],null===(a=t.whatsherePreloadedResults)||void 0===a?void 0:a.items[0]].filter((function(e){return Boolean(e)}))}),[e.content,t]);return i.createElement(i.Fragment,null,o.value?i.createElement(Xs,{searchResults:o.value,mapSize:e.mapSize,isLoading:o.loading,mapLocation:e.mapLocation,isResultsListShown:"search-list"===(null===(c=e.content)||void 0===c?void 0:c.type),onResultClick:e.onResultClick,onLoadMoreClick:l,onControlClick:u,onListClose:d}):null,o.value?i.createElement(Qs.Z,{hiddenResults:p,results:o.value,onPlacemarkClick:e.onResultClick}):null)};var ec=n(1304),tc=n(5930),nc=n(283);function rc(e){return e[0][0]=Math.round(e[0][0]),e[0][1]=Math.round(e[0][1]),e[1][0]=Math.round(e[1][0]),e[1][1]=Math.round(e[1][1]),e}var oc=n(7806);var ic=n(8848);function ac(e){return e.isPoiEnabled&&Boolean(e.content&&["masstransit-stop","search"].includes(e.content.type))}function sc(e){return{params:{ll:(0,$t.s)(e.map.location.center),z:Math.round(100*e.map.location.zoom)/100}}}function cc(e){var t;return e.isPoiEnabled&&"masstransit-stop"===(null===(t=e.content)||void 0===t?void 0:t.type)?{params:{masstransit:{stopId:e.content.data.stop.id},mode:"stop"}}:{}}function lc(e,t){var n,r,o,i,a=null===(n=t.mapWidget)||void 0===n||null===(r=n.activeObject)||void 0===r?void 0:r.items[0];if(e.isPoiEnabled&&"search"===(null===(o=e.content)||void 0===o?void 0:o.type)){var s=e.content.data.result,c={};return"business"!==s.type||e.routes.routerResponse||t.searchPreloadedResults?c.poi={uri:s.uri,point:s.coordinates}:c.orgpage={id:s.id},{params:c}}return!ac(e)&&a&&"search"===(null===(i=t.mapWidget)||void 0===i?void 0:i.activeMode)?{params:{poi:{uri:a.uri,point:a.coordinates}}}:{}}function uc(e,t){var n,r,o,i;return"search"===(null===(n=t.mapWidget)||void 0===n?void 0:n.activeMode)?{params:{filter:t.query.filter,text:null===(r=t.searchPreloadedResults)||void 0===r?void 0:r.requestQuery,"display-text":null===(o=t.searchPreloadedResults)||void 0===o||null===(i=o.chain)||void 0===i?void 0:i.name}}:{}}function dc(e,t){var n,o,i,a,s,l=gc(e,t);if(l)return{textContent:"Как добраться",params:(0,r.Z)({},c.DP({routerResponse:null,travelMode:lr(t),detailedIndex:-1,activeRouteIndex:0,viaIndexes:[],routePoints:[c.Yo(),l]},t),{mode:"routes"})};if(e.routes.routePoints.length>0){var u,d,p,m,f=c.DP({routerResponse:null,travelMode:lr(t),detailedIndex:-1,activeRouteIndex:e.routes.activeRouteIndex,viaIndexes:(null===(u=e.routes.routerResponse)||void 0===u?void 0:u.viaIndexes)||[],routePoints:e.routes.routePoints},t),v=(0,r.Z)({},f,{rtm:t.query.rtm,mode:"routes"!==(null===(d=t.mapWidget)||void 0===d?void 0:d.activeMode)||ac(e)?void 0:"routes"}),h=null===(p=e.routes.routerResponse)||void 0===p?void 0:p.routes[e.routes.activeRouteIndex];return{params:v,textContent:ac(e)||t.searchPreloadedResults&&"routes"!==(null===(m=t.mapWidget)||void 0===m?void 0:m.activeMode)||null==h||!h.bounds||(n=e.map.location.bounds,o=h.bounds,i=(0,tc.Z)(oc.m6),a=(0,nc.C)((0,pr.n)(n,oc.m6),i),s=(0,nc.C)((0,pr.n)(o,oc.m6),i),!a.some((function(e){return s.some((function(t){return yr(rc(e),rc(t))}))})))?void 0:"Открыть маршрут"}}return{}}function pc(e,t){var n=e.ruler.points.slice(0,t.ruler.maxCount).map((function(e,t,n){var r=e.coordinates,o=n[t-1]&&n[t-1].coordinates,i=0===t?r:[r[0]-o[0],r[1]-o[1]];return(0,$t.s)(i)})).join("~");return{params:{rl:n||null}}}function mc(e,t){return{layers:{trf:e.traffic.isActive,trfe:e.traffic.isActive&&sr(t)}}}function fc(e,t){var n=t.userMap;return n?{params:{um:n.id}}:{}}function vc(e,t){var n,r,o,i,a,s,c,l,u,d=gc(e,t),p=e.content&&"data"in e.content&&e.content.data.coordinates,m=ac(e)||"search"!==(null===(n=t.mapWidget)||void 0===n?void 0:n.activeMode)?null===(r=t.mapWidget)||void 0===r||null===(o=r.activeObject)||void 0===o||null===(i=o.items[0])||void 0===i?void 0:i.coordinates:void 0,f=null===(a=t.poiPreloadedResults)||void 0===a||null===(s=a.items[0])||void 0===s?void 0:s.coordinates,v=null===(c=t.whatsherePreloadedResults)||void 0===c||null===(l=c.items[0])||void 0===l?void 0:l.coordinates,h=null===(u=t.masstransitStop)||void 0===u?void 0:u.coordinates,g=[].concat((e.placemarks||[]).map((function(e){return e.coordinates})),[m,f,v,h]).filter((function(e){return Boolean(e&&(!(null!=d&&d.coords)||!(0,Ie.J)(null==d?void 0:d.coords,e))&&(!p||!(0,Ie.J)(p,e)))}));return{params:{pt:g.length>0?g.map((function(e){return(0,$t.s)(e)})).join("~"):void 0}}}function hc(){return{params:{source:"mapframe",utm_source:"mapframe",from:"mapframe"}}}function gc(e,t){var n;if("search"!==(null===(n=t.mapWidget)||void 0===n?void 0:n.activeMode)&&!ac(e)){var r=[];return t.poiPreloadedResults&&t.poiPreloadedResults.items.length>0&&r.push({coords:t.poiPreloadedResults.items[0].coordinates,value:t.poiPreloadedResults.items[0].title}),t.whatsherePreloadedResults&&t.whatsherePreloadedResults.items.length>0&&r.push({coords:t.whatsherePreloadedResults.items[0].coordinates,value:t.whatsherePreloadedResults.items[0].title}),t.masstransitStop&&r.push({coords:t.masstransitStop.coordinates,value:t.masstransitStop.name}),r.find((function(t){return(0,ic.V)(e.map.location.bounds,t.coords)}))}}var yc=n(6043);const _c=function(e){var t=(0,I.ZR)(),n=function(e,t){var n=[sc,cc,lc,uc,dc,pc,mc,fc,vc,hc].reduce((function(n,o){var i=o(e,t);return{textContent:n.textContent||i.textContent,params:(0,r.Z)({},n.params||{},i.params||{}),layers:(0,r.Z)({},n.layers||{},i.layers||{})}}),{}),o=n.params,i=void 0===o?{}:o,a=n.layers,s=void 0===a?{}:a,c=n.textContent;i.l=Object.entries(s).reduce((function(e,t){var n=t[0],r=t[1];return[].concat(e.filter((function(e){return e!==n})),r?[n]:[])}),[]).join(",")||null;var u=Object.entries(i).reduce((function(e,t){var n=t[0],r=t[1];return null!==r&&(e[n]=r),e}),{});return{url:l.sY(t.hosts.maps,u),textContent:c}}(e.state,t),o=n.url,a=n.textContent,s=(0,yc.d)(e.state.map.size,t),c=i.createElement("div",{style:{marginLeft:s.toFixed(0)+"px"}},i.createElement(ec.Z,{url:o},function(){switch(e.size){case"tiny":return null;case"small":return"Открыть в Картах";case"medium":return a||"Открыть в Яндекс Картах"}return null}()));return"tiny"===e.size?i.createElement(In.Z,{text:"Открыть в Яндекс Картах",position:"right",isAir:!0},c):c};var bc=n(9730),Ec=[50,70,72,50],wc={passive:!1},Sc=function(e){function t(t){var n,o,f;(f=e.call(this,t)||this)._getLocationAction=void 0,f._asyncRoadEventAction=void 0,f._getRoutePointAction=void 0,f._getInitialContent=function(){var e,t,n,r,o=f.props,i=null===(e=o.config.mapWidget)||void 0===e?void 0:e.activeMode,a=null===(t=f.props.config.poiPreloadedResults)||void 0===t?void 0:t.items[0];if("routes"===i&&f.props.config.routerResponse)return{type:"route",data:{}};if("poi"===i&&a){return{type:"search",data:{result:a,coordinates:a.coordinates}}}if("stop"===i&&o.config.masstransitStop)return{type:"masstransit-stop",data:{stop:o.config.masstransitStop,coordinates:o.config.masstransitStop.coordinates}};if("whatshere"===i&&null!==(n=f.props.config.whatsherePreloadedResults)&&void 0!==n&&n.items[0]){var s=f.props.config.whatsherePreloadedResults.items[0];return{type:"search",data:{result:s,coordinates:s.coordinates}}}if("search"===i&&(f.props.config.searchPreloadedResults||null!==(r=f.props.config.mapWidget)&&void 0!==r&&r.activeObject)){var c,l,u,d,p=null===(c=f.props.config.mapWidget)||void 0===c||null===(l=c.activeObject)||void 0===l?void 0:l.items[0],m=1===(null===(u=f.props.config.searchPreloadedResults)||void 0===u?void 0:u.items.length)?f.props.config.searchPreloadedResults.items[0]:void 0,v=p||(null===(d=f.props.config.searchPreloadedResults)||void 0===d?void 0:d.exactResult)||m;if("business"===(null==v?void 0:v.type)||"toponym"===(null==v?void 0:v.type))return{type:"search",data:{result:v,coordinates:v.coordinates}};if(!v&&o.mapSize.width>460)return{type:"search-list"}}return null},f._onRouterResponseLoad=function(e){f._deepSetState({routes:{routerResponse:e,activeRouteIndex:0}}),f._updateContentData({type:"route",data:{}})},f._getIsPoiEnabled=function(e,t){return e>=295&&t>=400},f._deepSetState=function(e,t){f.setState((function(t){return(0,m.Z)(t,e)}),t)},f._onGeolocationControlClick=function(){f._makeGeolocationRequest()},f._makeGeolocationRequest=function(){var e=f.props.config;f.setState({geolocation:{isStarted:!0}}),f._getLocationAction=p.Z.create(Z.getCurrentPosition(e,1500),{success:f._onGeolocationSuccess,fail:f._onGeolocationFail})},f._onGeolocationSuccess=function(e){f._updateLocationRequest({center:[e.longitude,e.latitude],duration:1e3,zoom:e.accuracy<=200?16:void 0}),f._deepSetState({geolocation:{isStarted:!1,accuracy:e.accuracy,currentPosition:[e.longitude,e.latitude]}})},f._onGeolocationFail=function(){var e;null!==(e=f.props.config.mapWidget)&&void 0!==e&&e.userCoordinates&&(f._updateLocationRequest({center:f.props.config.mapWidget.userCoordinates,duration:1e3}),f._deepSetState({geolocation:{isStarted:!1,currentPosition:f.props.config.mapWidget.userCoordinates,accuracy:1e3}}))},f._updateLocation=function(e){f._deepSetState({map:{location:e}})},f._updateLocationRequest=function(e){f.setState((function(t){return{map:(0,r.Z)({},t.map,{locationRequest:e})}}))},f._onRoutesBoundsChange=function(e){var t=s.$Y({bounds:e},Ec,f.state.map.size);f._updateLocationRequest(t)},f._updateRuler=function(e){f._deepSetState({ruler:e})},f._onTrafficLevelChange=function(e){f._deepSetState({traffic:{level:e}})},f._onTrafficControlClick=function(){var e=f._getContentData("traffic");f._deepSetState({traffic:{isActive:!f.state.traffic.isActive},content:e?void 0:f.state.content})},f._setMapSize=function(e){f._deepSetState({map:{size:e}})},f._updateContentData=function(e){f.setState({content:e})},f._processMapObjectClick=function(e,t){var n=f._getEmptyRoutePointIndex();-1!==n?f._updateRoutePoint(e,n):t()},f._onTrafficLayerClick=function(e,t){var n,r=f.props;if(e){var o=e.properties,i=o.HotspotMetaData,a=o.vectorMetadata,s=(null==a?void 0:a.get("objectId"))||(null==i?void 0:i.id);if(s){var c=null===(n=e.geometry)||void 0===n?void 0:n.coordinates;f._processMapObjectClick({value:"",coords:c&&2===c.length?c:t.coordinates},(function(){c&&2===c.length&&(p.Z.cancel(f._asyncRoadEventAction),f._asyncRoadEventAction=p.Z.create(k.getRoadEvent(s,r.config),{success:function(e){e&&e.position&&f._updateContentData({type:"traffic",data:{event:e,coordinates:e.position}})},fail:function(){return f._resetContentData()}}))}))}}},f._onRouteClick=function(e,t){var n,r=((null===(n=f.state.routes.routerResponse)||void 0===n?void 0:n.routes)||[]).indexOf(e);f._updateContentData({type:"route",data:{coordinates:t}}),f._deepSetState({routes:{activeRouteIndex:-1!==r?r:0}})},f._onUserMapsFeatureClick=function(e,t){var n={coords:t,value:""};f._processMapObjectClick(n,(function(){var n,r=null===(n=f.props.config.userMap)||void 0===n?void 0:n.features[e];r&&f._updateContentData({type:"user-maps",data:{feature:r,coordinates:t}})}))},f._onPlacemarkClick=function(e){var t={coords:e.coordinates,value:e.title,uri:e.uri};f._processMapObjectClick(t,(function(){if(f.state.isPoiEnabled)f._updateContentData({type:"search",data:{result:e,coordinates:e.coordinates}});else{var t="business"===e.type?l.S$({id:e.id,seoname:e.seoname}):l.hL(e,e.region,{skipPointCheck:!0});if(t){var n=(0,u._)(l.e_("/"+t,f.props.config));window.open(n,"_blank")}}}))},f._onMasstransitPlacemarkClick=function(e){var t,n={coords:e.coordinates,value:e.name,uri:null===(t=e.searchResult)||void 0===t?void 0:t.uri};f._processMapObjectClick(n,(function(){if(f.state.isPoiEnabled)f._updateContentData({type:"masstransit-stop",data:{stop:e,coordinates:e.coordinates}});else{var t=e.region?l.uf(e,e.region):"";if(t){var n=(0,u._)(l.e_("/"+t,f.props.config));window.open(n,"_blank")}}}))},f._resetContentData=function(){f._deepSetState({content:null})},f._updateRoutePointDragging=function(e){a.flushSync((function(){var t;f._deepSetState({routes:{isPointDragging:e},content:"route"===(null===(t=f.state.content)||void 0===t?void 0:t.type)?null:f.state.content})}))},f._updateRoutePoint=function(e,t){if(f.state.routes.isPointDragging){var n=[].concat(f.state.routes.routePoints);n[t]=e,f._deepSetState({routes:{routePoints:n}})}else f._getRoutePointAction=p.Z.create(Le(e,f.props.config,"router"),{success:function(n){e.value=(null==n?void 0:n.title)||"",e.input=(null==n?void 0:n.title)||"",e.searchResult=n;var r=[].concat(f.state.routes.routePoints);r[t]=e,f._deepSetState({routes:{routePoints:r}})},fail:function(){var n=[].concat(f.state.routes.routePoints);n[t]=e,f._deepSetState({routes:{routePoints:n}})}})},f._getEmptyRoutePointIndex=function(){return f.state.routes.routePoints.findIndex((function(e){return!e.coords}))},f._getRoutePointsDraggableIndexes=function(){var e;return(null===(e=f.props.config.routePoints)||void 0===e?void 0:e.reduce((function(e,t,n){return t.coords||e.push(n),e}),[]))||[]},f._onPoiClick=function(e,t){var n=e.properties.uri,r=e.geometry&&e.geometry.coordinates||t.coordinates;f._processMapObjectClick({coords:r,value:e.properties.name||"",uri:n},(function(){f.setState({poiData:{coordinates:r,feature:e}})}))},f._getCursor=function(){var e=f._getEmptyRoutePointIndex();if(-1!==e&&!f.props.config.uatraits.isPhone&&!f.state.ruler.isEnabled)return c.Bq(e,f.state.routes.routePoints)+"_"+e},f._getContentData=function(e){var t;if((null===(t=f.state.content)||void 0===t?void 0:t.type)===e)return f.state.content},f._preventZoomByPinching=function(e){"scale"in e&&1!==e.scale&&e.touches.length>1&&e.preventDefault()},f._renderInMapsControl=function(e){return D.md(f.props.config)?null:i.createElement(_c,{state:f.state,size:e})},f._renderGeolocationPin=function(){return f.state.geolocation.currentPosition&&f.state.geolocation.accuracy?i.createElement(je,{currentPosition:f.state.geolocation.currentPosition,accuracy:f.state.geolocation.accuracy}):null},f._renderTrafficLayer=function(){return f.state.traffic.isActive?i.createElement(Lr,{mapLocation:f.state.map.location,mapSize:f.state.map.size,updateLocationRequest:f._updateLocationRequest,onClick:f._onTrafficLayerClick,onTrafficLevelChange:f._onTrafficLevelChange,resetContentData:f._resetContentData,content:f._getContentData("traffic")}):null},f._renderUserMaps=function(){return f.props.config.userMap?i.createElement(rs,{userMap:f.props.config.userMap,mapLocation:f.state.map.location,mapSize:f.state.map.size,updateLocationRequest:f._updateLocationRequest,onFeatureClick:f._onUserMapsFeatureClick,cursor:f._getCursor(),resetContentData:f._resetContentData,content:f._getContentData("user-maps")}):null},f._renderSearchResult=function(){return i.createElement(os.Z,{mapSize:f.state.map.size,mapLocation:f.state.map.location,isTrafficLayerEnabled:f.state.traffic.isActive,updateLocationRequest:f._updateLocationRequest,content:f.state.isPoiEnabled?f._getContentData("search"):void 0,onContentClose:f._resetContentData,onStaticPlacemarkClick:f._onPlacemarkClick})},f._renderSearchComponentWithControl=function(){return i.createElement(Js,{mapLocation:f.state.map.location,mapSize:f.state.map.size,content:f._getContentData("search")||f._getContentData("search-list"),onResultClick:f._onPlacemarkClick,setListContent:f._updateContentData})},f._renderBanner=function(){var e;if(null===(e=f.props.config.banner)||void 0===e||!e.blockIds.widget)return null;var t=f.props.config.banner.blockIds.widget,n=f.props.config.banner.blockIds.largeWidget;return i.createElement(bc.default,{id:t,largeBannerId:n,mapSize:f.state.map.size,usePortal:!0})};var v,h=s.$Y(f.props.config.mapLocation,Ec,{width:t.mapSize.width,height:t.mapSize.height}),g=f._getIsPoiEnabled(t.mapSize.width,t.mapSize.height);return f.state={placemarks:t.config.query.pt?(v=t.config.query.pt,v.split("~").reduce((function(e,t){var n=t.split(","),r=n[0],o=n[1],i=n[2],a=n.slice(3),s=(0,d.P)(r+","+o);return!o||a.length>0||!s||e.push({coordinates:s,color:i}),e}),[])):void 0,map:{location:h,size:t.mapSize},geolocation:{isStarted:!1},ruler:Me(t.config),traffic:{isActive:(null===(n=t.config.query.l)||void 0===n?void 0:n.includes("trf"))||(null===(o=t.config.userMap)||void 0===o?void 0:o.isTrafficShown),level:null},routes:{activeRouteIndex:Number(t.config.query.rtn)||0,routerResponse:t.config.routerResponse?c.NA(t.config.routerResponse):null,routePoints:t.config.routePoints||[],isPointDragging:!1},content:f._getInitialContent(),isPoiEnabled:g},f}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.document.body.classList.add("_app_ready"),document.addEventListener("touchmove",this._preventZoomByPinching,wc)},n.componentDidUpdate=function(e,t){if(t.map.size!==this.state.map.size){var n=this._getIsPoiEnabled(this.state.map.size.width,this.state.map.size.height);this._deepSetState({isPoiEnabled:n})}},n.componentWillUnmount=function(){p.Z.cancel(this._getLocationAction),p.Z.cancel(this._getRoutePointAction)},n.render=function(){var e,t=this.state,n=Boolean(null===(e=this.props.config.flyover)||void 0===e?void 0:e.isEnabled),r=D.md(this.props.config);return i.createElement(fn,{location:t.map.location,locationRequest:t.map.locationRequest,margin:Ec,onLocationChange:this._updateLocation,onSizeChange:this._setMapSize,isPoiEnabled:!n&&!r&&this.state.isPoiEnabled,onPoiClick:n||r?void 0:this._onPoiClick},i.createElement(vn.ZP,{mapSize:t.map.size,geolocation:{isStarted:t.geolocation.isStarted,onClick:this._onGeolocationControlClick},location:t.map.location,ruler:{isEnabled:t.ruler.isEnabled,updateRuler:this._updateRuler},traffic:{isActive:t.traffic.isActive,level:t.traffic.level,onClick:this._onTrafficControlClick},search:{render:this._renderSearchComponentWithControl},inMaps:{render:this._renderInMapsControl}}),this._renderBanner(),this._renderUserMaps(),this._renderGeolocationPin(),i.createElement(er,{ruler:t.ruler,updateRuler:this._updateRuler}),this._renderTrafficLayer(),i.createElement(ot,{points:t.placemarks}),i.createElement(Va,{routerResponse:t.routes.routerResponse,activeRouteIndex:t.routes.activeRouteIndex,routePoints:t.routes.routePoints,mapLocation:t.map.location,mapSize:t.map.size,emptyPointIndex:this._getEmptyRoutePointIndex(),isTrafficLayerEnabled:t.traffic.isActive,isRoutePointDragging:t.routes.isPointDragging,cursor:this._getCursor(),setDragging:this._updateRoutePointDragging,draggablePointIndexes:this._getRoutePointsDraggableIndexes(),updateRoutePoint:this._updateRoutePoint,onRouteClick:this._onRouteClick,onBoundsChange:this._onRoutesBoundsChange,resetContentData:this._resetContentData,content:this._getContentData("route")}),i.createElement(xs,{routePoints:t.routes.routePoints,onLoad:this._onRouterResponseLoad}),this._renderSearchResult(),i.createElement(Ss,{content:t.isPoiEnabled?this._getContentData("masstransit-stop"):void 0,mapSize:t.map.size,mapLocation:t.map.location,updateLocationRequest:this._updateLocationRequest,onContentClose:this._resetContentData,onStaticPlacemarkClick:this._onMasstransitPlacemarkClick}),i.createElement(ks,{poiData:t.poiData,updateContent:this._updateContentData}))},t}(i.Component);const Cc=(0,I.ZP)(Sc)},9730:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});var r,o=n(7363),i=n(834),a=n(4578),s=n(1847),c="yaContextCb",l=!1;const u={load:function(e){return l||(r=function(e){return new Promise((function(t,n){Array.isArray(window[c])||(window[c]=[]),window[c].push((function(){return t(window.Ya.Context.AdvManager)})),(0,s.Z)(e).catch(n)}))}(e),r.then((function(){l=!0}))),r}};var d,p=n(6667),m=n(4467),f=function(e){function t(t){var n;return(n=e.call(this,t)||this)._loadAction=void 0,n._onLoadEnd=function(e){n.props.onLoadEnd&&n.props.onLoadEnd(e)},n.state={advertManager:d,isLoadingFailed:!1},n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.props.config.hosts.advertLoader;!d&&t&&(this._loadAction=p.Z.create(u.load(t),{success:function(t){d=t,e.setState({advertManager:d},(function(){return e._onLoadEnd(d)}))},fail:function(){e.setState({isLoadingFailed:!0},(function(){return e._onLoadEnd()}))}}))},n.componentWillUnmount=function(){p.Z.cancel(this._loadAction)},n.render=function(){return this.state.advertManager?this.props.children(this.state.advertManager):this.state.isLoadingFailed&&this.props.renderFallback?this.props.renderFallback():null},t}(o.Component);const v=(0,m.ZP)(f);var h=n(7462),g=n(5877),y=n.n(g),_=n(9790),b=n(7734),E=n(6021),w=n(2801),S=n(150);const C=function(e){var t=(0,w.Y)({threshold:.5,triggerOnce:!0}),n=t[0],r=t[2];return o.createElement(o.Fragment,null,e.children(n),void 0!==r?o.createElement(S.ZP,{name:"advert_visible",nodeState:{visible_part:r.intersectionRatio}}):null)};var Z=n(4675),R=n(2326),P=(0,i.Z)("banner-view");function k(e){return Math.floor(e.getTime()/1e3)}const I=(0,_.Z)(m.ZP,b.ZP,R.ZP)(function(e){function t(t){var n;return(n=e.call(this,t)||this)._isWindowActive=!1,n._refreshBannerIntervalId=void 0,n._refreshCount=0,n._lastShowSeconds=0,n._isVisibleEnough=!1,n._bannerContainerId=void 0,n._setWindowActive=function(){n._isWindowActive=!0},n._setWindowInactive=function(){n._isWindowActive=!1},n._getElementId=function(){return String(n._bannerContainerId)+n.props.id},n._init=function(){n._refreshCount=0,n._refresh(),n.props.config.experiments.ui.noRefreshBanner||(n._refreshBannerIntervalId&&window.clearInterval(n._refreshBannerIntervalId),n._refreshBannerIntervalId=window.setInterval(n._clockTick,1e3))},n._refresh=function(){var e,t=n.props,r=null===(e=t.id)||void 0===e?void 0:e.trim();if(r){n._lastShowSeconds=k(t.getToday()),n._refreshCount++;var o=(0,h.Z)({},t.extParams,{"test-ids":t.testIds});t.advertManager.render({blockId:r,renderTo:n._getElementId(),cspNonce:t.cspNonce,extParams:o,format:t.format,position:t.position,darkTheme:"dark"===t.theme,allowRepeatAds:{screen:-1},onError:n._onError,onRender:n._onRender,onHide:t.onHide},t.altCallback)}},n._onError=function(e){var t,r,o=n.props,i=o.config;null===(t=o.onDisplay)||void 0===t||t.call(o),null===(r=o.onError)||void 0===r||r.call(o),"VIDEO_ERROR"!==e.code&&(0,Z.H)(new Error("AdvertManager "+e.type+" ("+e.code+"): "+e.text),{config:i,additional:{component:"BannerView",id:o.id,format:o.format,position:o.position}})},n._onRender=function(e){var t,r,o,i;n.state.isAdvertRendered||n.setState({isAdvertRendered:!0}),null===(t=(r=n.props).onRender)||void 0===t||t.call(r,e),null===(o=(i=n.props).onDisplay)||void 0===o||o.call(i)},n._clockTick=function(){n._refreshCount>20||!n._isWindowActive||!n._isVisibleEnough||k(n.props.getToday())-n._lastShowSeconds>=35&&n._refresh()},n._onIntersectionChange=function(e){n._isVisibleEnough=e},n._bannerContainerId=y().v4().replace(/-/g,""),n.state={isAdvertRendered:!1},n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._isWindowActive=!0,window.document.addEventListener("keydown",this._setWindowActive),this._init()},n.componentDidUpdate=function(e){e.id!==this.props.id&&this._init()},n.componentWillUnmount=function(){window.document.removeEventListener("keydown",this._setWindowActive),window.clearInterval(this._refreshBannerIntervalId)},n.render=function(){var e=this,t=[P(),this.props.className].filter(Boolean).join(" ");return o.createElement("div",{"aria-hidden":!0,"aria-live":"polite"},o.createElement(w.Z,{as:"div",threshold:.3,onChange:this._onIntersectionChange},o.createElement(C,null,(function(n){return o.createElement("div",{ref:e.state.isAdvertRendered?n:void 0,className:t,id:e._getElementId(),style:{maxHeight:e.props.maxHeight}})}))),o.createElement(E.Z,{type:"focus",listener:this._setWindowActive}),o.createElement(E.Z,{type:"blur",listener:this._setWindowInactive}))},t}(o.Component));var M=n(3128),T=(0,i.Z)("map-widget-banner-component");const x=function(e){var t=(0,m.ZR)(),n=o.useState(!1),r=n[0],i=n[1],a=o.useState(!1),s=a[0],c=a[1],l=o.useState(!1),u=l[0],d=l[1],p=o.useState(!1),f=p[0],h=p[1],g=e.mapSize,y=t.uatraits.isMobile;o.useEffect((function(){var e=y?g.height>=250&&g.width>=250:g.height>=200&&g.width>=250;h(!e),d(g.height>600&&!t.uatraits.isMobile)}),[g,h,y,t]);var _=u?e.largeBannerId:e.id,b="string"==typeof _?_:void 0;if(r||f||!b)return null;var E=e.usePortal?M.v7:o.Fragment;return o.createElement(E,null,o.createElement("div",{className:T({displayed:s,large:u})},o.createElement("div",{className:T("content")},o.createElement(v,{onLoadEnd:function(e){return i(!e)},renderFallback:function(){return null}},(function(e){return o.createElement(I,{id:b,maxHeight:u?"90px":y?"50px":"56px",advertManager:e,cspNonce:t.cspNonce,onError:function(){return i(!0)},onDisplay:function(){return c(!0)}})})))))}},4403:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var r=n(7462),o=n(4578),i=n(7363),a=n.n(i),s=n(4467),c=n(550),l=n(566),u=n(1596),d=n(8072),p=n(4402),m=n(2976),f=n(3769),v=n(583),h=(0,v.Z)({resolved:{},chunkName:function(){return"flyover"},isReady:function(e){var t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("flyover").then(n.bind(n,9655))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then((function(e){return t.resolved[n]=!0,e}))},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 9655}}),g=460,y={advert:void 0,brandingId:void 0},_=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this)._getDisplayType=function(){return t.props.mapSize.width>=g?"balloon":"panel"},t._renderStaticSearchResult=function(e){var n;if(!e||e.id===(null===(n=t.props.content)||void 0===n?void 0:n.data.result.id))return null;var o={requestId:"",requestResults:1,totalResultCount:1,items:[e]};return i.createElement(i.Fragment,null,i.createElement(c.Z,{searchResults:o,mapLocation:t.props.mapLocation}),i.createElement(p.Z,{result:(0,r.Z)({},e,y),coordinates:e.coordinates,mode:"active",onClick:t.props.onStaticPlacemarkClick}),i.createElement(m.Z,{uri:e.uri}))},t._renderContentSearchResult=function(){var e=t.props.content,n=t._getDisplayType();if(!e)return null;var o=e.data.result,a={requestId:"",requestResults:1,totalResultCount:1,items:[o]};return i.createElement(i.Fragment,null,i.createElement(u.Z,{coordinates:e.data.coordinates,mapLocation:t.props.mapLocation,displayType:n,updateLocationRequest:t.props.updateLocationRequest,onClose:t.props.onContentClose,mapSize:t.props.mapSize},"business"===o.type?i.createElement(l.Z,{result:o}):i.createElement(d.Z,{result:o,isTrafficLayerEnabled:t.props.isTrafficLayerEnabled})),i.createElement(c.Z,{searchResults:a,mapLocation:t.props.mapLocation}),"panel"===n?i.createElement(i.Fragment,null,i.createElement(p.Z,{result:(0,r.Z)({},o,y),coordinates:o.displayCoordinates,mode:"active"}),i.createElement(m.Z,{uri:o.uri})):null)},t._renderBusinessGeometry=function(e){return e&&"business"===e.type?i.createElement(f.Z,{result:e}):null},t._renderFlyover=function(){var e,n=null===(e=t.props.content)||void 0===e?void 0:e.data.result;return n&&"business"===n.type?i.createElement(h,{result:n,zoom:t.props.mapLocation.zoom}):null},t}return(0,o.Z)(t,e),t.prototype.render=function(){var e,t,n,r,o,a=this.props.config,s=null===(e=a.whatsherePreloadedResults)||void 0===e?void 0:e.items[0],c=null===(t=a.poiPreloadedResults)||void 0===t?void 0:t.items[0],l=null===(n=a.mapWidget)||void 0===n||null===(r=n.activeObject)||void 0===r?void 0:r.items[0],u=Boolean(null===(o=a.flyover)||void 0===o?void 0:o.isEnabled);return i.createElement(i.Fragment,null,this._renderStaticSearchResult(s),this._renderStaticSearchResult(c),this._renderStaticSearchResult(l),this._renderBusinessGeometry(l),this._renderBusinessGeometry(c),u?this._renderFlyover():this._renderContentSearchResult())},t}(i.Component);const b=(0,s.ZP)(_)},6043:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});var r=function(e,t){var n,r=t.uatraits.isMobile?620:e.height>600?1014:814;return null===(n=t.banner)||void 0===n||!n.blockIds.widget||e.width<=r?0:Math.ceil((e.width-r)/2)}},9740:(e,t,n)=>{"use strict";n.d(t,{V:()=>d,_:()=>l});var r=n(7462),o=n(129),i=n.n(o),a=n(9705),s=n(2824),c=n(2332);function l(e){var t=e.split("?"),n=t[0],o=t[1],a=void 0===o?"":o;return n+"?"+i().stringify((0,r.Z)({},i().parse(a),{from:"mapframe"}))}var u=14;function d(e,t,n){var o,i=c.DP({routePoints:e,viaIndexes:[],travelMode:t.travelMode||"auto",activeRouteIndex:0,routerResponse:null,detailedIndex:0,settings:{auto:{ignoreTrafficJams:!1,avoid:[],timeDependent:{type:"departure"}},masstransit:{avoidTypes:[],timeDependent:{type:"departure"}}},startNavigationInApp:!0},n),d=e.some((function(e){return!e.coords}))?null===(o=e.find((function(e){return e.coords})))||void 0===o?void 0:o.coords:void 0;return l(s.e_(s.sY("/",(0,r.Z)({ll:d?(0,a.s)(d):void 0,z:d?u:void 0},i)),n))}},566:(e,t,n)=>{"use strict";n.d(t,{Z:()=>z});var r=n(4578),o=n(7363),i=n(834),a=n(4467),s=n(2824),c=n(8926),l=n(9740),u=n(3480),d=n(7462),p=n(2447),m=n(348),f=(0,i.Z)("flip-icon");const v=function(e){var t=e.isFlipped;return o.createElement(m.Z,{name:"arrow-down-8",className:f({flipped:t}),inline:!0})};var h=n(1745),g=(0,i.Z)("map-widget-business-working-intervals-view");const y=function(e){var t=(0,a.ZR)(),n=o.useState(!1),r=n[0],i=n[1],s=p.lR(e.result,t),c=p.bL(e.result,t)||[],l=c.length>0;return o.createElement("div",{className:g()},o.createElement("div",{className:g("labels")},e.children?o.createElement("div",{className:g("extra-label")},e.children):null,o.createElement("div",{className:g("time-label",(0,d.Z)({},s.state,{clickable:l})),onClick:l?function(){i(!r)}:void 0},o.createElement("span",{className:g("label-text")},s.text),l?o.createElement("div",{className:g("working-status-control")},o.createElement(v,{isFlipped:r})):null)),r?o.createElement("div",{className:g("intervals")},c.map((function(e,t){var n=e.changedDate?o.createElement(o.Fragment,null,e.dayName,", ",o.createElement("span",{className:g("date")},e.changedDate)):e.dayName;return o.createElement(h.Z,{key:t,isDisabled:!e.changedDate,position:["right"],text:"Праздничный день"},o.createElement("div",{className:g("interval")},o.createElement("div",{className:g("day")},n),o.createElement("span",{className:g("time")},Array.isArray(e.text)?e.text.join(", "):e.text)))}))):null)};var _=n(5481),b=(0,i.Z)("map-widget-business-contacts-view");const E=function(e){var t,n,r=(0,a.ZR)(),i=o.useState(!1),c=i[0],l=i[1],u=function(){l(!c)},d=(0,_.Po)(e.result,r),p=d[0],f=d.slice(1),h=null===(t=e.result.urls)||void 0===t?void 0:t[0];return o.createElement("div",{className:b()},e.result.fullAddress?o.createElement("div",{className:b("item")},o.createElement(m.Z,{inline:!0,name:"logo-24",className:b("icon")}),e.result.fullAddress):null,p?o.createElement("div",{className:b("item")},o.createElement("div",null,p?o.createElement("div",{className:b("phone-container")},o.createElement("a",{className:b("main-phone"),href:"tel:"+(null!==(n=p.value)&&void 0!==n?n:p.number)},o.createElement(m.Z,{inline:!0,name:"call-24",className:b("icon")}),p.number),f.length>0?o.createElement("div",{className:b("flip"),onClick:u},f.length,o.createElement(v,{isFlipped:c})):null):null,c?f.map((function(e){var t;return o.createElement("a",{key:e.number,className:b("phone"),href:"tel:"+(null!==(t=e.value)&&void 0!==t?t:e.number)},e.number)})):null)):null,h?o.createElement("div",{className:b("item")},o.createElement(m.Z,{inline:!0,name:"web-24",className:b("icon")}),o.createElement("a",{className:b("url"),href:h,target:"_blank"},s.DJ(h,!0))):null)};var w=n(7062),S=n(8696),C=(0,i.Z)("map-widget-business-buttons-view"),Z=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this)._renderGetToButton=function(){if(c.Wv(t.props.result))return null;var e={coords:t.props.result.coordinates,value:"",uri:t.props.result.uri},n=(0,l._)((0,l.V)([{coords:null,value:""},e],{},t.props.config));return o.createElement("div",{className:C("button-container")},o.createElement(S.Z,{view:"secondary-blue",size:"small",isStretched:!0,url:n,target:"_blank"},"Как добраться"))},t._renderAboutButton=function(){return o.createElement("div",{className:C("button-container")},o.createElement(S.Z,{view:"primary",size:"small",isStretched:!0,url:t.props.businessUrl,target:"_blank"},"Об организации"))},t}return(0,r.Z)(t,e),t.prototype.render=function(){return o.createElement("div",{className:C()},this._renderGetToButton(),this._renderAboutButton())},t}(o.Component);const R=(0,a.ZP)(Z);var P=n(267),k=n(7238),I=n(9705),M={};const T={getRoute:function(e,t){var n=e.points.map((function(e){return e?(0,I.s)(e):""})).join("~");return M[n]||(M[n]=(0,k.Z)("taxi/getRoute",{query:{rll:n,lang:t.locale}},t)),M[n]},checkCoverage:function(e,t){return(0,k.Z)("taxi/checkCoverage",{query:{ll:(0,I.s)(e.center),lang:t.locale}},t)},launch:function(e,t){return(0,k.Z)("taxi/launch",{body:{lang:e.locale,id:t}},e).then((function(e){if(!e)throw new Error("The taxi launch response don't include userId");return e}))}};var x=(0,i.Z)("map-widget-taxi-link-view");const L=function(e){var t=(0,a.ZR)(),n=P.Z((function(){return T.checkCoverage({center:e.endPoint},t)}),[e.endPoint,t],{value:null,loading:!1}),r=n[0],i=n[1];o.useEffect((function(){i()}),[e.endPoint,i]);return r.value||r.loading?o.createElement("div",{className:x()},o.createElement(m.Z,{name:"yndx-taxi-16",className:x("icon")}),o.createElement("a",{className:x("link"),href:function(){var n,r,o,i=null===(n=t.mapWidget)||void 0===n?void 0:n.taxi,a=t.uatraits.isMobile;if(i){var c=(null===(r=e.startPoint)||void 0===r?void 0:r.map(String))||[],l=c[0],u=void 0===l?"":l,d=c[1],p=void 0===d?"":d,m=e.endPoint.map(String),f=m[0],v=void 0===f?"":f,h=m[1],g=void 0===h?"":h;return s.Ow({urlTemplate:a?i.mobileUrlTemplate:i.urlTemplate,domain:i.domain,startLat:p,startLon:u,endLat:g,endLon:v,tariffClass:"",lang:null!==(o=i.lang)&&void 0!==o?o:"ru"})}}(),target:"_blank"},"Вызвать такси")):null};var D=n(999),N=(0,i.Z)("map-widget-business-content-view"),A=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this)._getCategories=function(){if(t.props.result.categories&&0!==t.props.result.categories.length)return t.props.result.categories.map((function(e){return e.name})).join(", ")},t._renderFeedbackUrl=function(){var e=t.props,n=s.ne(e.result.id),r=(0,l._)(s.e_(n,e.config));return o.createElement("a",{className:N("feedback-link"),href:r,target:"_blank"},"Сообщить об ошибке")},t._renderTaxiUrl=function(){var e=t.props;return c.Wv(e.result)?null:o.createElement(L,{endPoint:e.result.coordinates,startPoint:e.userCoordinates})},t}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props,t=s.S$({id:e.result.id,seoname:e.result.seoname}),n=(0,l._)(s.e_("/"+t,e.config));return o.createElement("div",{className:N()},o.createElement(D.Z,{title:e.result.title,titleUrl:n,subtitle:this._getCategories()}),o.createElement(y,{result:this.props.result},o.createElement(u.Z,{result:e.result})),o.createElement(E,{result:e.result}),o.createElement("div",{className:N("stops")},o.createElement(w.Z,{result:e.result})),o.createElement("div",{className:N("business-buttons")},o.createElement(R,{businessUrl:n,result:e.result})),o.createElement("div",{className:N("bottom-links")},this._renderTaxiUrl(),this._renderFeedbackUrl()))},t}(o.Component);const z=(0,a.ZP)(A)},3480:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var r=n(4578),o=n(7363),i=n(834),a=n(4467),s=n(2824),c=n(9740),l=n(9790),u=n(348),d=n(150),p=n(8657),m=(0,i.Z)("a11y-hidden");const f=function(e){var t=e.children,n=e.tag,r=void 0===n?"span":n;return t?o.createElement(r,{className:m()},t):null};var v=n(2326),h=(0,i.Z)("business-rating-badge-view"),g=(0,l.Z)(a.ZP,v.ZP);const y=g((function(e){var t=Math.round(2*e.ratingValue),n=Math.floor(t/2),r=!1;2*n!==t&&(r=!0);var i=e.size||"m",a=e.collapseStars?1:5;return o.createElement(d.ZP,{name:"business_rating"},o.createElement("div",{className:h({size:i})},o.createElement("div",{className:h("stars")},new Array(a).fill(null).map((function(t,a){var s=r&&a===n,c=a>=(r?n+1:n),l=!c&&!s,d=s?"half-star-12-flip":"empty-star-12";return o.createElement(u.Z,{name:d,className:h("star",{full:l,half:s,empty:c,size:i}),theme:s?e.theme:void 0,key:a,inline:!0})}))),e.onlyStars?null:o.createElement("div",{className:h("rating")},o.createElement(f,null,"Рейтинг"," "),o.createElement("span",{className:h("rating-text",{size:i,white:e.whiteText})},p.D$(e.ratingValue,e.config.lang,{min:1,max:1})))))}));var _=n(1745),b=(0,i.Z)("map-widget-business-rating-view"),E=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this)._getReviewUrl=function(){if(!t.props.disableLink){var e=s.S$(t.props.result,{sublanding:"reviews"},{},{"add-review":""});return(0,c._)(s.e_("/"+e,t.props.config))}},t._renderContent=function(){var e,n=t.props;return n.result.ratingData?n.result.ratingData.ratingValue?o.createElement(y,{ratingValue:n.result.ratingData.ratingValue}):(e={count:n.result.ratingData.reviewCount}).count?e.count+" "+(e.count%10==1&&e.count%100!=11?"отзыв":e.count%10>1&&e.count%10<5&&(e.count%100<10||e.count%100>20)?"отзыва":"отзывов"):"Ещё нет отзывов":null},t}return(0,r.Z)(t,e),t.prototype.render=function(){return o.createElement(_.Z,{text:"Оценить место",position:"bottom",isAir:!0},o.createElement("a",{className:b(),href:this._getReviewUrl(),target:"_blank"},this._renderContent()))},t}(o.Component);const w=(0,a.ZP)(E)},999:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(7363),o=(0,n(834).Z)("map-widget-content-title-view");const i=function(e){return r.createElement(r.Fragment,null,r.createElement("a",{href:e.titleUrl,target:"_blank",className:o("title",{disabled:!e.titleUrl})},e.title),e.subtitle?r.createElement("div",{className:o("subtitle")},e.subtitle):null)}},1596:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(4578),o=n(7363),i=n(834),a=n(576),s=n(8848),c=n(5900),l=n(309);var u=n(7225),d=n(2362),p=n(3812),m=n(3128),f=(0,i.Z)("map-widget-content-view"),v={top:10,right:8};const h=function(e){function t(t){var n;return(n=e.call(this,t)||this)._containerRef=null,n._updateMapLocation=function(){var e;if(n.props.updateLocationRequest){var t=n.state.maxHeight||n.state.height,r=null===(e=n._containerRef)||void 0===e?void 0:e.offsetWidth;if(t&&r){var o,i,a,u="panel"===n.props.displayType?(o=n.props.mapLocation,i=n.props.coordinates,(a=(0,c.f)(i,o.zoom))[1]+=32,(0,l.W)(a,o.zoom)):function(e,t,n,r){var o,i=e.bounds,a=(0,s.V)(i,t)?e.center:t,u=(0,s.V)(i,t)?t:e.center,d=(0,c.f)(a,e.zoom),p=(0,c.f)(u,e.zoom),m=i.map((function(t){return(0,c.f)(t,e.zoom)})),f=p[0]-m[0][0],v=m[1][0]-p[0],h=p[1]-m[1][1],g=Math.min(f,v),y=[].concat(d),_=Math.ceil(n.width/2);if(g<_){var b=_-g;f>=v?y[0]+=b:y[0]-=b}var E=n.height+(null!==(o=null==r?void 0:r.main)&&void 0!==o?o:0);return h<E&&(y[1]-=E-h+10),(0,l.W)(y,e.zoom)}(n.props.mapLocation,n.props.coordinates,{width:r,height:t},n.props.offset);n.props.updateLocationRequest({center:u,duration:300})}}},n._updateWidthHeight=function(){var e,t,r,o;n._containerRef&&n.setState({height:n._containerRef.clientHeight,width:"balloon"===n.props.displayType?n._containerRef.clientWidth+20:void 0,maxHeight:"balloon"===n.props.displayType?(e=n.props.mapLocation,t=n._containerRef.clientHeight,r=e.bounds.map((function(t){return(0,c.f)(t,e.zoom)})),o=r[0][1]-r[1][1]+22,o<t?o:t):Math.ceil(n.props.mapSize.height/2),ready:!0},(function(){return n._updateMapLocation()}))},n._setContainerRef=function(e){n._containerRef=e,n._updateWidthHeight()},n._renderContainer=function(){return o.createElement("div",{className:f("container",{ready:n.state.ready}),ref:n._setContainerRef,style:{height:n.state.height,maxHeight:n.state.maxHeight,width:n.state.width}},o.createElement(d.Z,{width:"dynamic"},o.createElement("div",{className:f("frame")},n.props.children)))},n.state={},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this;e.coordinates===this.props.coordinates&&e.displayType===this.props.displayType&&(0,a.Z)(this.props.mapSize,e.mapSize)||this.setState({height:void 0,width:void 0,maxHeight:void 0,ready:void 0},(function(){t._updateWidthHeight()}))},n.render=function(){var e=this.props;return"balloon"===e.displayType?o.createElement(u.Z,{coordinates:e.coordinates,key:e.coordinates.join(),position:"top",restrictPosition:!0,type:"normal",skipMaxHeight:!0,offset:e.offset,isShown:!0},o.createElement("div",{className:f("balloon")},o.createElement(p.Z,{offset:v,onClick:e.onClose}),this._renderContainer())):o.createElement(m.v7,null,o.createElement("div",{className:f("panel"),key:e.coordinates.join()},o.createElement(p.Z,{offset:v,onClick:e.onClose}),this._renderContainer()))},t}(o.Component)},1304:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(7363),o=n(834),i=n(8696),a=n(348),s=(0,o.Z)("map-widget-in-maps-button");const c=function(e){var t=r.createElement(a.Z,{name:"logo-24",inline:!0,className:s("icon")});return r.createElement(i.Z,{view:"air",size:"small",icon:t,url:e.url,target:"_blank"},e.children)}},3128:(e,t,n)=>{"use strict";n.d(t,{v7:()=>ce,oQ:()=>se,ZP:()=>le});var r=n(7462),o=n(3144),i=n(4578),a=n(7363),s=n(834);const c=function(e){var t=null,n=null,r=!1,o=!1,i=-1;function a(){for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];if(o)return r=!0,t=c,void(n=this);e.apply(this,c),o=!0,i=window.requestAnimationFrame((function(){o=!1,r&&(r=!1,n=null,t=null,a.apply(n,t))}))}return a.scheduled=o,Object.defineProperty(a,"scheduled",{get:function(){return o}}),a.cancel=function(){window.cancelAnimationFrame(i),i=-1,o=!1,r=!1,n=null,t=null},a};var l=n(576),u=n(4467),d=n(4787),p=n(9845),m=n(4100),f=n(4479),v=n(9249),h=(0,m.ZP)();const g=h(function(e){function t(t){var n;return(n=e.call(this,t)||this)._targetZoom=void 0,n._getState=function(){var e=n.props.map;if(!e)return{zoomOutIsEnabled:!1,zoomInIsEnabled:!1};var t=Math.round(100*e.zoom)/100;return{zoomOutIsEnabled:t>e.zoomRange.min,zoomInIsEnabled:t<e.zoomRange.max}},n._updateButtons=function(){n.setState(n._getState())},n._changeZoom=function(e){var t=n.props.map;if(t){var r,o=null!==(r=n._targetZoom)&&void 0!==r?r:t.zoom;n._targetZoom=o+e;var i=n._targetZoom;t.animateCenterAndZoom(t.center,n._targetZoom,200).then((function(){i===n._targetZoom&&(n._targetZoom=void 0)}))}},n._onZoomIn=function(e){e.preventDefault(),n._changeZoom(1)},n._onZoomOut=function(e){e.preventDefault(),n._changeZoom(-1)},n.state=n._getState(),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){!e.map&&this.props.map&&this._updateButtons()},n.render=function(){return a.createElement(a.Fragment,null,a.createElement(v.Z,{onUpdate:this._updateButtons,onZoomRangeChange:this._updateButtons}),a.createElement(f.Z,{onZoomIn:this._onZoomIn,onZoomOut:this._onZoomOut,disabledZoomIn:!this.state.zoomInIsEnabled,disabledZoomOut:!this.state.zoomOutIsEnabled,size:this.props.size}))},t}(a.PureComponent));var y=n(6692),_=n(7688),b=n(150),E=n(8696),w=n(1745),S=n(4916);var C=n(1784),Z=(0,s.Z)("map-geolocation-control"),R=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._onClick=function(e){e.preventDefault(),t.props.onClick()},t._renderIcon=function(){var e=t.props;if(e.isLoading)return a.createElement("div",{className:Z("spinner")},a.createElement(S.Z,{view:"small",withoutMargin:!0}));var n=Boolean(e.config.mapWidget);return a.createElement("div",{className:Z("icon"),dangerouslySetInnerHTML:{__html:e.config.uatraits.isMobile&&!n?C.location48Icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.385 12.42l16.01-7.614a.6.6 0 0 1 .8.8l-7.616 16.009a.6.6 0 0 1-1.11-.068l-2.005-6.012-6.01-2.003a.6.6 0 0 1-.069-1.111z" fill="currentColor"/></svg>'}})},t}return(0,i.Z)(t,e),t.prototype.render=function(){var e,t=this.props,n=null!==(e=t.size)&&void 0!==e?e:t.config.uatraits.isMobile?"large":"medium",r=Boolean(t.config.mapWidget);return a.createElement("div",{className:Z({noprint:!0})},a.createElement(w.Z,{text:"Моё местоположение",position:"left",isAir:!0},a.createElement(b.ZP,{name:"geolocation",logClick:!0},a.createElement(E.Z,{view:t.config.uatraits.isMobile&&!r?"air-round":"air",size:n,icon:this._renderIcon(),onClick:this._onClick,disabled:t.isLoading,checked:t.isChecked,ariaLabel:"Моё местоположение"}))))},t}(a.Component);const P=(0,u.ZP)(R);var k=n(2328),I=(0,s.Z)("map-widget-map-scale-line-view");const M=function(e){return a.createElement("div",{className:I()},a.createElement(k.default,{center:e.location.center,zoom:e.location.zoom}))};var T=(0,s.Z)("map-widget-ruler-control-view");const x=function(e){return a.createElement("div",{className:T()},a.createElement(w.Z,{text:"Линейка",position:"left",isAir:!0},a.createElement(E.Z,{ariaHidden:!0,icon:a.createElement("div",{className:T("icon"),dangerouslySetInnerHTML:{__html:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.56 14.363L14.363 3.56a1.91 1.91 0 0 1 2.7 0l3.377 3.376a1.91 1.91 0 0 1 0 2.7L9.636 20.442a1.91 1.91 0 0 1-2.7 0l-3.377-3.377a1.91 1.91 0 0 1 0-2.7zm4.12-.743l1.282-1.282 1.823 1.824a.764.764 0 1 0 1.08-1.082l-1.824-1.822 1.216-1.215 1.148 1.145a.763.763 0 0 0 1.318-.534.765.765 0 0 0-.237-.545l-1.148-1.147 1.282-1.283 1.824 1.824a.764.764 0 0 0 1.08-1.082l-1.825-1.824 1.014-1.012a.478.478 0 1 0-.676-.675L4.91 15.038a.478.478 0 0 0 .675.675l1.012-1.012 1.15 1.146a.764.764 0 1 0 1.08-1.079L7.679 13.62v.001z" fill="currentColor"/></svg>'}}),view:"air",size:"small",onClick:function(){return e.updateRuler({isEnabled:!e.isEnabled})},checked:e.isEnabled})))};var L=n(8769);var D=(0,s.Z)("traffic-raw-icon");const N=(0,u.ZP)((function(e){var t=e.checked?L.ZU(e.level):"none";return a.createElement("div",{className:D({color:t})},a.createElement("div",{className:D("icon"),dangerouslySetInnerHTML:{__html:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 12c0 5.523 4.477 10 10 10s10-4.477 10-10-4.477-10-10-10-10 4.477-10 10z" fill="#CCC"/><path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 12c0 5.523 4.477 10 10 10s10-4.477 10-10-4.477-10-10-10-10 4.477-10 10zm18.333 0a8.333 8.333 0 1 1-16.666 0 8.333 8.333 0 0 1 16.666 0z" fill="#4D4D4D"/><path d="M9.75 2h2.5c5.514 0 10 4.486 10 10a5.605 5.605 0 0 1-3.976-1.65c-1.018-1.018-1.68-2.104-3.22-3.906C13.694 4.857 11.818 3.25 9.75 3.25c-4.136 0-7.5 3.926-7.5 8.75C1.456 11.059 1 10.005 1 8.875 1 5.085 3.547 2 9.75 2z" fill="#4D4D4D"/></svg>'}}),a.createElement("div",{className:D("text")},e.checked?e.level:null))}));var A=(0,s.Z)("map-widget-traffic-control-view");const z=function(e){var t=a.createElement(N,{checked:e.isActive,level:e.level});return a.createElement("div",{className:A()},a.createElement(E.Z,{onClick:e.onClick,icon:t,size:"small",view:"air"},e.hasText?"Пробки":null))};var U=(0,s.Z)("layout-control-group");const O=function(e){function t(t){var n;return(n=e.call(this,t)||this)._root=a.createRef(),n._onResizeThrottled=void 0,n._onUpdate=function(){var e=n.props,t=n._root.current.clientHeight,r=n._root.current.clientWidth;e.height>0&&t>0&&e.height===t||e.onUpdate(e.type,{height:t,width:r})},n._onResize=function(){n._onUpdate()},n._onResizeThrottled=c(n._onResize),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=this._root.current.clientHeight,n=this._root.current.clientWidth;e.onUpdate(e.type,{position:e.position,height:t,width:n})},n.componentDidUpdate=function(e){this.props.position!==e.position&&this.props.onUpdate(this.props.type,{position:this.props.position})},n.render=function(){var e=this.props,t=!e.visible,n="left"===e.side?[e.sideLeftMargin+"px",void 0]:"right"===e.side?[void 0,e.sideRightMargin+"px"]:[e.sideLeftMargin+"px",e.sideRightMargin+"px"],r=n[0],o=n[1];return a.createElement(b.ZP,{group:!0,hidden:t},a.createElement("div",{ref:this._root,className:U({side:e.side||"right",hidden:t,animated:e.animated}),"data-type":e.type,style:{transform:"translateY("+e.top+"px)",left:r,right:o}},e.children,a.createElement(d.Z,{onResize:this._onResizeThrottled})))},t}(a.Component);var F=n(5196);function B(e){for(var t,n={},o=0,i=(0,F.Z)(e.controlsOrder);!(t=i()).done;){var a=t.value[0],s=0,c=e.controlGroups[a];if(c&&0!==c[e.dimension]){var l=!n[c.type];l&&(s+=c[e.dimension]+e.betweenMargin);var u=o+s;if(u>e.viewport+e.betweenMargin)break;l&&(n[a]=(0,r.Z)({},c)),o=u}}return{controlGroups:n}}var H=function(e,t,n){var o={top:q(n.betweenMargin),center:q(n.betweenMargin),bottom:q(n.betweenMargin)};e.forEach((function(e){o[e.position].height+=e.height+n.betweenMargin})),o.top.height=Math.max(o.top.height,0),o.center.height=Math.max(o.center.height,0),o.bottom.height=Math.max(o.bottom.height,0),o.top.top=n.topSizes.minTop;var i=o.top.top+o.top.height+n.betweenMargin;return o.bottom.top=W(n.topSizes.maxTop-o.bottom.height,i,n.topSizes.maxTop),o.center.top=W(n.topSizes.middle-Math.round(o.center.height/2),i,o.bottom.top-n.betweenMargin-o.center.height),e.reduce((function(e,i){var a,s=o[i.position],c=s.top,l=Math.abs(i.top-c),u=l>20&&l<300&&n.enableAnimation,d=(0,r.Z)({},t[i.type],{animated:u,top:c});return s.top+=i.height+n.betweenMargin,(0,r.Z)({},e,((a={})[i.type]=d,a))}),{})};function q(e){return{top:0,height:-e,width:-e}}function G(e,t){return Object.values(e).filter((function(e){return Boolean(e)})).sort((function(e,n){return t.indexOf(e.type)-t.indexOf(n.type)}))}function W(e,t,n){return Math.max(Math.min(e,n),t)}var j=n(6043),V=(0,s.Z)("map-widget-layout-view"),Y=12,K=["zoom","rulers","top-controls","geolocation"],$=["zoom","3D"],X=["open-in-maps-medium","open-in-maps-small","open-in-maps-tiny"],Q=["open-in-maps-medium","open-in-maps-small","open-in-maps-tiny"],J=[["zoom"],["top-controls"],["geolocation"],["3D"]],ee=[["zoom"],["3D"]],te=[["open-in-maps-medium"],["open-in-maps-small"],["open-in-maps-tiny"],["search"]],ne=[["open-in-maps-small"]],re=[["open-in-maps-medium"]],oe=V("top-panel"),ie=V("bottom-panel"),ae=function(e){function t(t){var n;return(n=e.call(this,t)||this)._repositionThrottled=void 0,n._root=a.createRef(),n._getFittingBottomLayout=function(){var e,t=n.state,r=((null===(e=n._root.current)||void 0===e?void 0:e.clientWidth)||0)-305,o=Object.keys(B({controlsOrder:re,viewport:r,controlGroups:t.controlGroups,betweenMargin:Y,dimension:"width"}).controlGroups),i=Object.keys(B({controlsOrder:ne,viewport:r,controlGroups:t.controlGroups,betweenMargin:Y,dimension:"width"}).controlGroups);return 1===o.length?["open-in-maps-medium"]:1===i.length?["open-in-maps-small"]:["open-in-maps-tiny","rulers"]},n._reposition=function(){var e,t=n.state,o=(null===(e=n._root.current)||void 0===e?void 0:e.clientHeight)||0,i=10+o,a=W(i,10,o),s=Math.round((i+10)/2),c=n._getFittingBottomLayout(),u=B({controlsOrder:te.filter((function(e){var t=e[0];return!Q.includes(t)||c.includes(t)})),viewport:o,controlGroups:t.controlGroups,betweenMargin:Y,dimension:"height"}),d=B({controlsOrder:n._isFlyover?ee:J,viewport:o,controlGroups:t.controlGroups,betweenMargin:Y,dimension:"height"}),p=G(u.controlGroups,X),m=G(d.controlGroups,n._isFlyover?$:K),f=H(m,n.state.controlGroups,{betweenMargin:Y,topSizes:{maxTop:a,minTop:10,middle:s},enableAnimation:!0}),v=H(p,n.state.controlGroups,{betweenMargin:Y,topSizes:{maxTop:a,minTop:10,middle:s},enableAnimation:!0}),h=[].concat(Object.keys(f),Object.keys(v)),g=(0,r.Z)({},t.controlGroups,f,v);(0,l.Z)(t.controlGroups,g)&&(0,l.Z)(t.visibleControlGroups,h)||n.setState({visibleControlGroups:h,controlGroups:g})},n._onControlGroupUpdate=function(e,t){n.setState((function(n){var o;return(0,r.Z)({},n,{controlGroups:(0,r.Z)({},n.controlGroups,(o={},o[e]=(0,r.Z)({type:e},n.controlGroups[e],t),o))})}),n._reposition)},n._getControlGroups=function(){return[{type:"top-controls",position:"top",side:"right",children:n._renderTopControls()},{type:"zoom",position:n.state.visibleControlGroups.length<=2?"top":"center",side:"right",children:n._renderZoomControls("small")},{type:"geolocation",position:"center",side:"right",children:n._renderGeolocationControl()},{type:"open-in-maps-medium",position:"bottom",side:"left",children:n._renderInMaps("medium")},{type:"open-in-maps-small",position:"bottom",side:"left",children:n._renderInMaps("small")},{type:"open-in-maps-tiny",position:"bottom",side:"left",children:n._renderInMaps("tiny")},{type:"search",position:"top",side:"left",children:n.props.search.render()}]},n._getFlyoverControlGroups=function(){return[{type:"zoom",position:"center",side:"right",sideRightMargin:12,children:n._renderZoomControls()},{type:"3D",position:"center",side:"right",sideRightMargin:12,children:n._render3DControl()}]},n._renderGeolocationControl=function(){return a.createElement("div",{className:V("geolocation")},a.createElement(P,{onClick:n.props.geolocation.onClick,isLoading:n.props.geolocation.isStarted,size:"small"}))},n._render3DControl=function(){return a.createElement("div",{className:V("3d")},a.createElement(y.Z,null))},n._renderTopControls=function(){return a.createElement("div",{className:V("top-controls")},n._renderRuler(),n._renderTrafficControl())},n._renderTrafficControl=function(){return a.createElement(z,(0,r.Z)({},n.props.traffic,{hasText:!0}))},n._renderRuler=function(){return a.createElement("div",{className:V("ruler")},a.createElement(x,(0,r.Z)({},n.props.ruler)))},n._renderInMaps=function(e){return a.createElement("div",{className:V("maps-links")},n.props.inMaps.render(e))},n._renderZoomControls=function(e){return a.createElement("div",{className:V("zoom-controls")},a.createElement(g,{size:e}))},n.state={visibleControlGroups:[],controlGroups:{}},n._repositionThrottled=c(n._reposition),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._repositionThrottled()},n.render=function(){var e=this,t=this._isFlyover?this._getFlyoverControlGroups():this._getControlGroups(),n=(0,j.d)(this.props.mapSize,this.props.config);return a.createElement("div",{className:V()},a.createElement("div",{className:V("layout")},a.createElement("div",{ref:this._root,className:V("controls")},t.map((function(t){var n,o,i,s,c;return a.createElement(O,(0,r.Z)({},t,{key:t.type,sideLeftMargin:t.sideLeftMargin||8,sideRightMargin:t.sideRightMargin||8,visible:e.state.visibleControlGroups.includes(t.type),animated:null===(n=e.state.controlGroups[t.type])||void 0===n?void 0:n.animated,height:null!==(o=null===(i=e.state.controlGroups[t.type])||void 0===i?void 0:i.height)&&void 0!==o?o:0,top:null!==(s=null===(c=e.state.controlGroups[t.type])||void 0===c?void 0:c.top)&&void 0!==s?s:0,onUpdate:e._onControlGroupUpdate}))}))),a.createElement("div",{className:V("bottom-layout"),style:{marginRight:n.toFixed(0)+"px"}},a.createElement("div",{className:V("copyrights")},a.createElement(_.Z,{right:100,copyrightOnly:!0})),a.createElement("div",{className:V("scale-line")},a.createElement(M,{location:this.props.location}))),a.createElement(d.Z,{onResize:this._repositionThrottled})),a.createElement("div",{className:oe}),a.createElement("div",{className:ie}))},(0,o.Z)(t,[{key:"_isFlyover",get:function(){var e;return Boolean(null===(e=this.props.config.flyover)||void 0===e?void 0:e.isEnabled)}}]),t}(a.Component),se=function(e){return a.createElement(p.Z,{selector:"."+oe},e.children)},ce=function(e){return a.createElement(p.Z,{selector:"."+ie},e.children)};const le=(0,u.ZP)(ae)},7062:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(4578),o=n(7363),i=n(834),a=n(4467),s=n(9740),c=n(348),l=(0,i.Z)("map-widget-nearest-stops-view"),u=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this)._renderFromStopDistance=function(e){var n={coords:t.props.result.coordinates,value:"",uri:t.props.result.uri},r={coords:e.coordinates,value:""},i=(0,s._)((0,s.V)([r,n],{travelMode:"pedestrian"},t.props.config));return o.createElement("a",{className:l("distance"),href:i,target:"_blank"},o.createElement("div",{className:l("distance-icon")},o.createElement(c.Z,{name:"pedestrian-24-flip",inline:!0,className:l("distance-icon-inner")})),o.createElement("div",{className:l("distance-text")},e.distance))},t._renderStop=function(e){var n="metro"===e.type?e.color:void 0;return o.createElement("div",{className:l("stop"),key:e.id},o.createElement("div",{className:l("metro-icon")},o.createElement(c.Z,{name:"metro-stop-24",style:{color:n},inline:!0})),o.createElement("div",null,e.name),t._renderFromStopDistance(e))},t}return(0,r.Z)(t,e),t.prototype.render=function(){return this.props.result.metro?this.props.result.metro.map(this._renderStop):null},t}(o.Component);const d=(0,a.ZP)(u)},9413:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c,x:()=>s});var r=n(7462),o=n(7363),i=n(4402),a=n(2976),s={advert:void 0,brandingId:void 0};const c=function(e){var t,n=1===e.results.items.length?e.results.items[0]:void 0,c=e.results.exactResult||n;return o.createElement(o.Fragment,null,!c||null!==(t=e.hiddenResults)&&void 0!==t&&t.find((function(e){return e.id===c.id}))?null:o.createElement(o.Fragment,null,o.createElement(i.Z,{key:c.id,result:(0,r.Z)({},c,s),coordinates:c.coordinates,mode:"subtitle",onClick:e.onPlacemarkClick}),c.uri?o.createElement(a.Z,{uri:c.uri}):null),e.results.items.filter((function(t){var n;return t.id!==(null==c?void 0:c.id)&&!(null!==(n=e.hiddenResults)&&void 0!==n&&n.find((function(e){return e.id===t.id})))})).map((function(t){var n=(0,r.Z)({},t,s);return o.createElement(i.Z,{key:t.id,result:n,coordinates:n.coordinates,mode:"base",onClick:e.onPlacemarkClick})})))}},8072:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(4578),o=n(7363),i=n(129),a=n(9705),s=n(834),c=n(4467),l=n(2824),u=n(9740),d=n(8696),p=n(7062),m=n(999),f=(0,s.Z)("map-widget-toponym-content-view"),v=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this)._getUrl=function(){var e,n=l.hL(t.props.result,t.props.result.region,{skipPointCheck:!0});n||(n="?"+i.stringify({poi:{uri:null===(e=t.props.result)||void 0===e?void 0:e.uri,point:(0,a.s)(t.props.result.coordinates)}}));var r=(0,u._)(l.e_("/"+n,t.props.config));return t.props.isTrafficLayerEnabled&&(r+="&l="+(t.props.config.query.l||"trf")),r},t._getInsideUrl=function(){var e=t.props.result.businesses&&t.props.result.businesses.totalResultCount>0,n=l.hL(t.props.result,t.props.result.region,{skipPointCheck:!0},e?{sublanding:"inside"}:{});return(0,u._)(l.e_("/"+n,t.props.config))},t._renderContent=function(){return"house"===t.props.result.kind?o.createElement(o.Fragment,null,o.createElement("div",{className:f("nearest-stops")},o.createElement(p.Z,{result:t.props.result})),o.createElement("div",{className:f("button-wrapper")},o.createElement(d.Z,{view:"primary",size:"small",isStretched:!0,url:t._getInsideUrl(),target:"_blank"},"Организации в доме"))):o.createElement("div",{className:f("button-wrapper")},o.createElement(d.Z,{view:"primary",size:"small",isStretched:!0,url:t._getUrl(),target:"_blank"},"Открыть в Картах"))},t._renderFeedbackUrl=function(){if(!t.props.result.uri)return null;var e=l.zN(t.props.result.uri),n=l.e_(e,t.props.config);return o.createElement("div",{className:f("button-wrapper")},o.createElement(d.Z,{view:"secondary-blue",size:"small",isStretched:!0,url:n,target:"_blank"},"Сообщить об ошибке"))},t}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props;return o.createElement("div",{className:f()},o.createElement("div",{className:f("title-wrapper")},o.createElement(m.Z,{title:e.result.title,titleUrl:this._getUrl(),subtitle:this.props.result.description})),this._renderContent(),this._renderFeedbackUrl())},t}(o.Component);const h=(0,c.ZP)(v)},366:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f,Y:()=>p});var r=n(7462),o=n(4578),i=n(7363),a=n(4467),s=n(7151),c=n(4100),l=n(1170),u=n(9790),d=n(2326),p="tile3d",m=function(e){function t(t){var r;return(r=e.call(this,t)||this)._dataSource=void 0,r._shouldHover=function(e){return(r.props.shouldHover?r.props.shouldHover(e):Boolean(r.props.onClick))&&function(e){var t;return Boolean(null===(t=e.properties.vectorMetadata)||void 0===t?void 0:t.has("uri"))}(e)},r._dataSource={type:"tile3d",priority:"high",theme:(0,l.gh)(t.theme),workerUrl:r.props.config.baseUrl+new URL(n(1367),n.b).pathname},r}(0,o.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){this._addLayer()},a.componentDidUpdate=function(e){this.props.theme!==e.theme&&(this._dataSource=(0,r.Z)({},this._dataSource,{theme:(0,l.gh)(this.props.theme)}),this.props.map.updateTile3dDataSource(p,this._dataSource))},a.componentWillUnmount=function(){this._removeLayer()},a._getMapLayers=function(){var e=this.props.map.getLayers(),t=e.mainLayers,n=e.topRasterLayers;return[].concat(t,n)},a._setMapLayers=function(e){this.props.map.setLayers((0,l.c8)(e,this.props.ymaps3.EventBlockerLayer,this.props.config))},a._addLayer=function(){this.props.map.addDataSource(p,this._dataSource);var e=this._getMapLayers();e.push.apply(e,(0,l.se)(p)),this._setMapLayers(e)},a._removeLayer=function(){var e=(0,l.se)(p),t=this._getMapLayers().filter((function(t){return!e.includes(t)}));this._setMapLayers(t),this.props.map.getDataSource(p)&&this.props.map.removeDataSource(p)},a.render=function(){return i.createElement(s.Z,(0,r.Z)({layer:p},this.props,{shouldHover:this._shouldHover}))},t}(i.Component);const f=(0,u.Z)(a.ZP,(0,c.ZP)({shouldWait:!0}),d.ZP)(m)},1170:(e,t,n)=>{"use strict";n.d(t,{mt:()=>_,pr:()=>b,c8:()=>Z,Hi:()=>d,UZ:()=>l,Il:()=>u,se:()=>k,_I:()=>x,Iw:()=>y,pp:()=>T,x8:()=>M,gh:()=>N,c1:()=>E});var r=n(7462),o=n(129),i=n.n(o),a=n(6955),s=n(2446),c=n(1480),l={DEFAULT_MARKERS:"defaultMarkers",DEFAULT_GRAPHICS:"defaultGraphics",DEFAULT_GRAPHICS_UNDER_BUILDINGS:"defaultGraphicsUnderBuildings",NIGHT_CIVIL_GRAPHICS:"nightCivilGraphics",NIGHT_NAVI_GRAPHICS:"nightNaviGraphics",NIGHT_ASTRO_GRAPHICS:"nightAstroGraphics",NIGHT_GRAPHICS:"nightGraphics",RASTER_GRAPHICS:"rasterGraphics",EDITOR_MARKERS:"editorMarkers",EDITOR_GRAPHICS:"editorGraphics"},u=":__customEventBlockerLayer",d=["map","sat","skl"],p=["map","sat"],m=["map","trf","trfe","trfa","stv","pht","indoor","carparks","mrc","mrcpe","personalizedPoi","tile3d",l.DEFAULT_GRAPHICS,l.DEFAULT_GRAPHICS_UNDER_BUILDINGS],f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",v={map:function(e){var t=e.mapTiles,n=e.mapjTiles;return{url:C(t),hotspotsUrl:C(n)}},sat:function(e){return{url:C(e.satTiles)}},skl:function(e){var t=e.sklTiles,n=e.skljTiles;return{url:C(t),hotspotsUrl:C(n)}},stv:function(e){return{url:e.stvTiles.replace("l=stv","l=stv,sta")}},sta:function(e){return{hotspotsUrl:e.staHotspotTiles}},pht:function(e){var t=e.phtRenderer;return{url:t+"tiles?l=pht&%c&v=%v&%l&format=png",hotspotsUrl:t+"tiles?l=phj&%c&v=%v&%l&format=json"}},mrc:function(e){return{url:e.mrcTiles+"&camera-direction=front",hotspotsUrl:e.mrcHotspotTiles+"&camera-direction=front"}},mrcpe:function(e){return{url:e.mrcpeTiles+"&camera-direction=front",hotspotsUrl:e.mrcpeHotspotTiles+"&camera-direction=front"}},carparks:function(e){return{url:e.carparksTiles}},personalizedPoi:function(){return{}}},h=["map:ground","sat:ground","skl:ground","personalizedPoi:ground","trf:ground","trfe:ground","trfa:ground","carparks:ground","mrc:ground","mrcpe:ground","stv:ground","indoor:ground",l.DEFAULT_GRAPHICS_UNDER_BUILDINGS,"map:buildings","tile3d:buildings",l.DEFAULT_GRAPHICS,"map:icons","map:labels","personalizedPoi:icons","personalizedPoi:labels","trfe:icons","trfe:labels","carparks:icons","indoor:icons","indoor:labels","stv:icons","pht:icons","sta:ground","pht:ground",l.NIGHT_CIVIL_GRAPHICS,l.NIGHT_NAVI_GRAPHICS,l.NIGHT_ASTRO_GRAPHICS,l.NIGHT_GRAPHICS,l.RASTER_GRAPHICS,l.DEFAULT_MARKERS,u,l.EDITOR_GRAPHICS,l.EDITOR_MARKERS];function g(e){var t=e&&function(e){var t=e.uatraits.isMobile,n=e.experiments.ui.vectorExtendTaps;return t&&n?{field:10,minSize:40}:void 0}(e),n={vector:{iconsInteractiveArea:t}};return{"map:buildings":{vector:{modelsAppearingAnimation:{duration:250}}},"tile3d:buildings":{vector:{parentLayerId:"map:buildings",modelsAppearingAnimation:{duration:250}}},"map:icons":n,"indoor:icons":n,"trfe:icons":n,"stv:icons":n,"pht:icons":{vector:(0,r.Z)({},n.vector,{isolateObjectsColliding:!0})},"carparks:icons":n,"personalizedPoi:icons":n}}var y=["map","sat"];function _(e,t){var n=Object.keys(v).reduce((function(n,r){var o=e.layers["sta"===r?"stv":r],i=o&&o.zoomRange;return n[r]={type:"tile",raster:S(r,o,e,t),vector:P(r,o,e,t),clampMapZoom:d.includes(r),zoomRange:i?{min:i[0],max:i[1]}:void 0},n}),{}),r=e.hosts,o=e.locale,i=e.uatraits.isMobile;return n.indoor={type:"tile",vector:M({collisionPriority:"low",priority:"low",requestTileSize:i?"X1":"X4",glyphRangeUrl:r.vectorIndoorGlyphs.replace("{{lang}}",o),imageUrl:r.vectorIndoorImages,meshUrl:r.vectorIndoorMeshes,tileUrl:L(r.vectorIndoorTiles.replace("{{lang}}",o),e),indoorPlanUrl:r.vectorIndoorPlans,theme:N(t)},e),zoomRange:{min:16.5,max:21}},Object.keys(l).forEach((function(e){n[l[e]]={type:"geojson"}})),n}function b(e,t,n){return e.replace("%l","lang="+t).replace(/(v|tm)=%v/,n?"$1="+n:"").replace(/%d\|\d+/,(function(e){return"{{"+e+"}}"})).replace(/%d/,"{{d|4}}").replace("%c","x={{x}}&y={{y}}&z={{z}}&scale={{scale}}")}function E(e,t){var n;return e+(null!==(n=t.mocks)&&void 0!==n&&n.version?"&mocks%5Bversion%5D="+t.mocks.version:"")}function w(e,t){return(t.authorization||t.experiments.ui.personalizedPoiNoAuth)&&t.experiments.ui.poiVectorAuthExperimentalData?e+"&experimental_data_poi="+t.experiments.ui.poiVectorAuthExperimentalData:e}function S(e,t,n,r){var o=v[e];if(!t||!o)return{type:"ground",fetchTile:f};var i=o(n.hosts),a=function(e){return b(e,n.locale,t.version)},c=["map","skl","carparks","stv","sta","mrc","mrcpe"].includes(e)?I(n):"",l=["map","stv","sta","pht","mrc","mrcpe","carparks"].includes(e)&&"dark"===r?"&theme=dark":"",u=i.url?D(a(i.url),c+l):f;return{type:"ground",fetchTile:"map"===e?L(u,n):u,fetchHotspots:i.hotspotsUrl?(0,s.R)(a(i.hotspotsUrl)+c):void 0,transparent:!p.includes(e),hotspotPadding:n.uatraits.isMobile?12:0}}function C(e){return e.replace("%c","v=%v&%c")}function Z(e,t,n){for(var r=e.filter((function(e,t,n){return n.indexOf(e)===t})).sort((function(t,n){var r=h.indexOf(t)-h.indexOf(n);return 0===r?e.indexOf(t)-e.indexOf(n):r})).reverse(),o=[],i=r.length-1;i>=0;i--){var a=r[i],s=a.split(":")[0];if(!m.includes(s))break;o.push(a),r.splice(i,1)}return r.reverse(),{topRasterLayers:R(r,n).map((function(e){return e===u?{id:u,type:"custom",implementation:function(e){return"raster"===e.effectiveMode&&t}}:e===l.DEFAULT_MARKERS||e===l.EDITOR_MARKERS?{id:e,type:"markers",source:e}:e})),mainLayers:R(o,n)}}function R(e,t){var n=g(t);return e.map((function(e){return e in n?(0,c.F7)(e,n[e]):e}))}function P(e,t,n,r){if(t){var o=n.locale,i=n.hosts,a=n.experiments,c=n.uatraits.isMobile;if("personalizedPoi"===e){var l="&service="+(c?"touch-maps":"desktop-maps");return M({priority:a.ui.vectorPpoiLoadingPriority||"medium",collisionPriority:a.ui.vectorPpoiCollisionPriority||"medium",tileUrl:L(b(i.tilesApi+"personalized_poi/tiles?l=personalized_poi&%l&v=%v&x={{x}}&y={{y}}&z={{z}}&zmin={{zmin}}&zmax={{zmax}}"+l,n.lang,t.version),n),requestTileSize:"X4",imageUrl:i.tilesApi+"personalized_poi/icons?id={{id}}&scale={{scale}}",glyphRangeUrl:i.tilesApi+"personalized_poi/glyphs?font_id={{fontId}}&range={{range}}",theme:N(r),tileRequestWithCredentials:!0},n)}if("carparks"===e){var u,d=null!==(u=n.mocks)&&void 0!==u&&u.version?"":"&v=%v";return M({priority:"medium",tileUrl:E(b(i.carparksTileRenderer+"tiles?version=2&l=carparks&%l"+d+"&x={{x}}&y={{y}}&z={{z}}",n.lang,t.version),n),imageUrl:i.carparksTileRenderer+"icons?id={{id}}&scale={{scale}}",theme:N(r)},n)}if("stv"===e)return M({priority:"medium",tileUrl:b(i.stvTileRenderer+"tiles?l=sta,stv&x={{x}}&y={{y}}&z={{z}}&%l&v=%v&format=protobuf",n.lang,t.version),imageUrl:i.stvTileRenderer+"icons?id={{id}}&scale={{scale}}",theme:N(r)},n);if("pht"===e)return M({priority:"medium",tileUrl:b(i.phtRenderer+"tiles?l=pht&x={{x}}&y={{y}}&z={{z}}&%l&v=%v&format=protobuf",n.lang,t.version),imageUrl:i.phtRenderer+"icons?id={{id}}&scale={{scale}}",theme:N(r),iconsOnlyTiles:!0,lowPrecisionBeltTiles:!1,tileBeltSize:0,tileCacheSize:100},n);if("mrc"===e||"mrcpe"===e){var p="mrc"===e?i.mrcTiles:i.mrcpeTiles,m="mrc"===e?i.mrcHotspotTiles:i.mrcpeHotspotTiles;return M({priority:"medium",tileUrl:p.replace("%c","x={{x}}&y={{y}}&z={{z}}")+"&camera-direction=front&format=protobuf",hotspots:{ground:(0,s.R)(m.replace("%c","x={{x}}&y={{y}}&z={{z}}")+"&camera-direction=front")},theme:N(r)},n)}if("map"===e){var f=i.vectorTiles.replace("{{lang}}",o).replace("v={{version}}",t.version?"v="+t.version:""),v=n.experiments.ui,h=v.vectorRichModelsEnabled,g=v.vectorRichModelsCacheSize;return M({collisionPriority:"low",priority:"high",tileBeltSize:1,requestTileSize:c?"X1":"X4",imageUrl:i.vectorImages,tileUrl:w(E(L(f,n),n),n),meshUrl:i.vectorMeshes,glyphRangeUrl:i.vectorGlyphs.replace("{{lang}}",o),richModelUrl:i.vectorRichModels,richModelEnabled:h,richModelCacheSize:g,hotspots:{buildings:{minZoom:16.5}},theme:N(r)},n)}}}function k(e){return h.filter((function(t){return t.startsWith(e+":")}))}function I(e){var t=(0,r.Z)({},e.experiments.rendererParams||{});return Object.keys(e.query).forEach((function(n){n.startsWith("renderer_")&&(t[n.replace(/^renderer_/,"")]=e.query[n])})),Object.keys(t).length>0?"&"+i().stringify(t,{indices:!1}):""}function M(e,t){return(0,r.Z)({},e,{imageUrl:T(e.imageUrl,t),tileUrl:T(e.tileUrl,t),meshUrl:T(e.meshUrl,t),richModelUrl:T(e.richModelUrl,t),indoorPlanUrl:T(e.indoorPlanUrl,t),glyphRangeUrl:T(e.glyphRangeUrl,t)})}function T(e,t){return e?e+I(t):e}function x(e,t){var n=(0,a.wo)(e);return n.raster&&"string"==typeof n.raster.fetchTile&&(n.raster.fetchTile=function(e,t){var n=e.split("?"),r=n[0],o=n[1],a=i().parse(o);if(r.includes(";base64"))return r;t?a.style=t:delete a.style;return Object.values(a).length>0?[r,i().stringify(a,{encode:!1})].join("?"):r}(n.raster.fetchTile,t.raster)),n.vector&&(n.vector.customization=t.vector),n}function L(e,t){return D(e,t.bunker.disableAdsMapTiles?"":"&ads=enabled")}function D(e,t){return e.includes(";base64")?e:e+t}function N(e){return"dark"===e?"dark":void 0}},2446:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});var r=n(7462),o=n(4086);function i(e){var t=function(t,n,r,i){var l=e.replace("{{x}}",String(t)).replace("{{y}}",String(n)).replace("{{z}}",String(r)).replace("{{scale}}","1").replace(/\{\{d\|(\d+)\}\}/,(function(e,o){return String((t+n+r)%Number(o)+1)}));return(0,o.Z)({url:l,signal:i}).then((function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){return[]}return!e||e.error&&404===e.error.code?[]:e.data.features.map((function(e){var t=e.properties.HotspotMetaData.RenderedGeometry;return{type:"rendered",feature:c(e),geometry:"Polygon"===t.type?a(t):s(t)}}))}))};return t.template=e,t}function a(e){return{type:"Polygon",coordinates:e.coordinates.map((function(e){return e.map((function(e){return{x:e[0],y:e[1]}}))}))}}function s(e){return{type:"MultiPolygon",coordinates:e.coordinates.map((function(e){return e.map((function(e){return e.map((function(e){return{x:e[0],y:e[1]}}))}))}))}}function c(e){var t,n=e.properties.URIMetaData,o=null===(t=e.properties.HotspotMetaData)||void 0===t?void 0:t.id;return{type:"Feature",id:o?String(o):"",geometry:e.geometry,properties:(0,r.Z)({},e.properties,{uri:(n&&n.URIs[0]||{}).uri})}}},4100:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>c,Ib:()=>a,Sx:()=>s});var r=n(7462),o=n(7363),i=o.createContext({});i.displayName="mapContext";var a=i.Provider;function s(){return o.useContext(i)}const c=function(e){return void 0===e&&(e={}),function(t){var n=function(n){return o.createElement(i.Consumer,null,(function(i){var a=i.map,s=i.ymaps3;return e.shouldWait&&!a?null:o.createElement(t,(0,r.Z)({},n,{map:a,ymaps3:s}))}))};return n.displayName="mapContext("+t.displayName+")",n}}},8623:(e,t,n)=>{"use strict";function r(e){if(0===e.length)return[];for(var t=[e[0]],n=0,r=e[0],o=1;o<e.length;o++){var i=e[o],a=i[0]+n-r[0];if(a>360||a<-360){var s=360*Math.floor(a/360);n-=s,a-=s}a>180?n-=360:a<-180&&(n+=360);var c=[i[0]+n,i[1]];t.push(c),r=c}return t}n.d(t,{g:()=>r})},7225:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(7462),o=n(3366),i=n(4578),a=n(7363),s=n(1243),c=n(9249),l=n(2151),u=["coordinates"];const d=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._ref=a.createRef(),t._onMapUpdate=function(){t.forceUpdate()},t}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.coordinates,i=(0,o.Z)(t,u);return a.createElement(a.Fragment,null,a.createElement(s.Z,{coordinates:n,nonInteractive:!0},a.createElement("div",{ref:this._ref}),a.createElement(l.Z,(0,r.Z)({type:"balloon"},i,{getTarget:function(){return e._ref.current}}),i.children)),a.createElement(c.Z,{onUpdate:i.isShown?this._onMapUpdate:void 0}))},t}(a.PureComponent)},636:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(4578),o=n(7363),i=n(5877),a=n.n(i),s=n(4100),c=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._uuid=a().v4(),t._getCollidingPrimitiveId=function(e){return t._uuid+":"+e.id},t._getCollidingPrimitives=function(e){var n=new Map;return e.forEach((function(e){n.set(t._getCollidingPrimitiveId(e),{anchor:e.anchor,rect:{minX:e.pixelSize[0][0],minY:e.pixelSize[0][1],maxX:e.pixelSize[1][0],maxY:e.pixelSize[1][1]}})})),n},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=this._getCollidingPrimitives(e.placemarks);e.map.addInvisibleCollidingPrimitives(t)},n.shouldComponentUpdate=function(){return!this.props.preventUpdates},n.componentDidUpdate=function(){var e=this,t=this.props,n=t.map.getInvisibleCollidingPrimitives(),r=[],o=this._getCollidingPrimitives(t.placemarks);n.forEach((function(t,n){n.startsWith(e._uuid+":")&&r.push(n)})),t.map.removeInvisibleCollidingPrimitives(r),t.map.addInvisibleCollidingPrimitives(o)},n.componentWillUnmount=function(){var e=this.props;e.map.removeInvisibleCollidingPrimitives(e.placemarks.map(this._getCollidingPrimitiveId))},n.render=function(){return null},t}(o.Component);const l=(0,s.ZP)({shouldWait:!0})(c)},7688:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var r=n(4578),o=n(7363),i=n.n(o),a=n(834),s=n(9790),c=n(4467),l=n(4100),u=n(4056),d=n(8586),p=n(150),m=n(9249),f=n(583),v=n(6922),h=n(6204),g=(0,v.Z)((0,f.Z)({resolved:{},chunkName:function(){return"lang-switcher"},isReady:function(e){var t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("lang-switcher").then(n.bind(n,5658))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then((function(e){return t.resolved[n]=!0,e}))},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 5658}}),(function(e){return e.config.availableLangs.length>1})),y=(0,f.Z)({resolved:{},chunkName:function(){return"scale-line"},isReady:function(e){var t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:function(){return Promise.resolve().then(n.bind(n,2328))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then((function(e){return t.resolved[n]=!0,e}))},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 2328}}),_=(0,f.Z)({resolved:{},chunkName:function(){return"logo-view"},isReady:function(e){var t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("logo-view").then(n.bind(n,2609))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then((function(e){return t.resolved[n]=!0,e}))},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 2609}}),b=(0,s.Z)(c.ZP,(0,l.ZP)({shouldWait:!0})),E=12,w=(0,a.Z)("map-copyrights"),S=function(e){function t(t){var n;return(n=e.call(this,t)||this)._update=function(){n.setState({maxWidth:n.props.map.container.offsetWidth-n._getRightOffset(),copyrights:(0,u.h)(n.props.map)})},n._getRightOffset=function(){return n.props.right-E},n._getPrivacyItem=function(){var e=n.props.config;return e.isYango?{type:"privacy",text:"Конфиденциальность",href:e.confidentialPolicyUrl+"?lang="+e.lang}:null},n._getTermsItem=function(e){var t=n.props.config;return{type:e?"terms_short":"terms",text:e?"Условия":"Условия использования",href:t.agreementUrl+"?lang="+t.lang}},n._getCopyrightsItem=function(){return{type:"copyrights",text:n.state.copyrights,shrink:!0}},n._getRightHoldersItem=function(){var e=n.props.config;return{type:"right_holders",text:"Правообладатели",href:e.rightHoldersUrl+"?lang="+e.lang}},n._getSupportItem=function(){var e=n.props.config;return(0,d.md)(e)?null:{type:"support",text:"Справка",href:e.feedback.helpUrl+"?lang="+e.lang}},n._getLocalizationItem=function(){return 1===n.props.config.availableLangs.length?null:{type:"lang",text:o.createElement(g,null)}},n._renderBlock=function(e,t){var n=t.filter((function(e){return Boolean(e)}));return o.createElement("div",{className:w("block",{type:e})},n.map((function(e){var t=e.href?"a":"div";return o.createElement(p.ZP,{name:e.type,logClick:Boolean(e.href),key:e.type},o.createElement(t,{className:w("item",{shrink:e.shrink,noprint:e.noprint,type:e.type}),href:e.href,target:"_blank"},e.text))})))},n._renderBlocks=function(){var e=n.props;e.config;return e.copyrightOnly?n._renderBlock("copyrights-only",[n._getCopyrightsItem(),n._getTermsItem(),n._getPrivacyItem()]):o.createElement(o.Fragment,null,n._renderBlock("copyrights",[n._getCopyrightsItem(),n._getRightHoldersItem()]),n._renderBlock("links",[{type:"service",text:"© Яндекс"},n._getLocalizationItem(),n._getSupportItem(),n._getTermsItem(),n._getTermsItem(!0),n._getPrivacyItem()]))},n.state={maxWidth:0,copyrights:(0,u.h)(n.props.map)},n}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.copyrightOnly?"copyrights-only":"map"===e.layer?"scheme":"satellite";return o.createElement("footer",null,o.createElement(p.ZP,{name:"map_copyrights"},o.createElement("div",{className:w({type:t}),style:(0,h.cq)(e.config,{maxWidth:this.state.maxWidth,right:this._getRightOffset()})},this._renderBlocks(),o.createElement(m.Z,{onResize:this._update,onCopyrightsChange:this._update}))),e.copyrightOnly?null:o.createElement("div",{className:w("logo-layout")},o.createElement(_,{view:"map",isNegative:"map"!==e.config.mapType})),!e.copyrightOnly&&e.location?o.createElement("div",{className:w("scale-line")},o.createElement(y,{center:e.location.center,zoom:e.location.zoom})):null)},t}(o.PureComponent);const C=b(S)},6169:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(4578),o=n(7363),i=n(4100),a=n(4467),s=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._key="",t._applyCursor=function(){var e=t._getCursor();!t.props.src&&e&&e.startsWith("url(")||(t.props.map.container.style.cursor=function(e){if(e.src&&e.basePoint)return'url("'+e.src+'") '+e.basePoint.join(" ")+', url("'+e.src+'"), auto';return e.cursor||"default"}(t.props),t._key=t._getCursor())},t._getCursor=function(){return t.props.map.container.style.cursor||""},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._applyCursor()},n.componentDidUpdate=function(){this._applyCursor()},n.componentWillUnmount=function(){this._getCursor()===this._key&&(this.props.map.container.style.cursor="")},n.render=function(){return null},t}(o.Component);const c=(0,i.ZP)({shouldWait:!0})((0,a.ZP)(s))},4025:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var r=n(4578),o=n(7363),i=n(4960),a=n(9705),s=n(348),c=n(834),l=n(4100),u=n(9249),d=n(1243),p=n(150),m=n(8033),f=n(636),v=n(4467),h=n(9790),g=n(2326),y=(0,c.Z)("map-entrances-view"),_=(0,h.Z)(v.ZP,(0,l.ZP)({shouldWait:!0}),g.ZP),b=[[-5,-5],[5,5]];function E(e){return e>=18?"large":e>=17?"normal":e>=16?"small":void 0}const w=_(function(e){function t(t){var n;return(n=e.call(this,t)||this)._onMapMainEngineChanged=function(){var e="vector"===n.props.map.getEffectiveMode();e!==n.state.isVector&&n.setState({isVector:e})},n._onMapUpdate=function(){var e=n.props,t=n.state,r=e.map.zoom,o=e.map.azimuth;r===t.mapZoom&&o===t.mapAzimuth||n.setState({mapZoom:r,mapAzimuth:o})},n._renderEntrance=function(e,t){var r=n.props,c=n.state,l=E(c.mapZoom),u=((e.azimuth||0)+(0,i.Z)(c.mapAzimuth))%360,f=r.isMetro?16:0,v="large"===l?"entrance-arrow-red-13":"entrance-arrow-red-10";return o.createElement(p.ZP,{key:t,name:"entrance",nodeState:{name:e.name,coords:(0,a.s)(e.coordinates)}},o.createElement(d.Z,{coordinates:e.coordinates,nonInteractive:!r.onEntranceClick,onClick:function(){var t;return null===(t=r.onEntranceClick)||void 0===t?void 0:t.call(r,e)},zIndex:m.I.search.base},o.createElement("div",{className:y({size:l,animated:r.animated})},o.createElement("div",{style:{transform:"rotate("+u+"deg)",paddingTop:f}},void 0!==e.azimuth&&"small"!==l?o.createElement("div",{className:y("arrow-container")},o.createElement(s.Z,{name:v,theme:r.theme,className:y("arrow",{large:"large"===l}),inline:!0})):void 0,r.isMetro?null:o.createElement("div",{className:y("dot")})),c.isVector&&e.name&&c.mapZoom>=18.5?o.createElement("div",{className:y("title",{position:u>45&&u<135?"left":"right"})},e.name):null)))},n._renderEntrances=function(){var e=n.props,t=n.state,r=E(t.mapZoom);return e.result.entrances&&r?o.createElement(o.Fragment,null,e.result.entrances.map(n._renderEntrance),t.mapZoom>=18.5&&!e.isMetro?o.createElement(f.Z,{placemarks:e.result.entrances.map((function(e){return{anchor:e.coordinates,id:e.coordinates.join(","),pixelSize:b}}))}):null):null},n.state={mapZoom:t.map.zoom,mapAzimuth:t.map.azimuth,isVector:"vector"===t.map.getEffectiveMode()},n}return(0,r.Z)(t,e),t.prototype.render=function(){return o.createElement(o.Fragment,null,this._renderEntrances(),o.createElement(u.Z,{onUpdate:this._onMapUpdate,onMainEngineChanged:this._onMapMainEngineChanged}))},t}(o.PureComponent))},5113:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a,Q:()=>i});var r=(0,n(5369).Z)("mapFeatureGroup",{}),o=r.connect,i=r.Provider;const a=o},555:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(3144),o=n(4578),i=n(7363),a=n(5877),s=n.n(a),c=n(4100),l=n(111),u=n(576),d=n(1170),p=n(5113),m=n(9790),f=n(284),v={onClick:"click",onFastClick:"fastclick",onTouchEnd:"touchend",onDoubleClick:"dblclick",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseUp:"mouseup",onMouseDown:"mousedown",onMouseMove:"mousemove"};const h=(0,m.Z)(p.Z,(0,c.ZP)({shouldWait:!0}))(function(e){function t(t){var n;return(n=e.call(this,t)||this)._id=void 0,n._handlers={},n._dragMoveThrottled=void 0,n._getFeature=function(){return{type:"Feature",id:n._id,geometry:n.props.geometry,draggable:n.props.draggable}},n._addHandler=function(e,t,r){n._handlers[e]=function(e,t,o){"feature"===(null==e?void 0:e.type)&&e.feature.id===n._id&&r(o,t)},n.props.map.events.on(v[e],t,n._handlers[e])},n._removeHandler=function(e,t){n.props.map.events.off(v[e],t,n._handlers[e]),delete n._handlers[e]},n._dragStart=function(e){var t=e.object,r=e.newGeometry;if("Feature"===t.type&&t.id===n._id){var o,i,a=(0,f.ZE)(r,(function(e){return n.props.map.projection.fromWorldCoordinates(e)}));if(a.coordinates)null===(o=(i=n.props).onDragStart)||void 0===o||o.call(i,{coordinates:a.coordinates})}},n._dragMove=function(e){var t=e.object,r=e.newGeometry;if(n.props.onDragMove&&"Feature"===t.type&&t.id===n._id){var o,i,a=(0,f.ZE)(r,(function(e){return n.props.map.projection.fromWorldCoordinates(e)}));if(a.coordinates)null===(o=(i=n.props).onDragMove)||void 0===o||o.call(i,{coordinates:a.coordinates});return!1}},n._dragEnd=function(e){var t=e.newGeometry,r=e.object;if(n._dragMoveThrottled.cancel(),"Feature"===r.type&&r.id===n._id){var o,i,a=(0,f.ZE)(t,(function(e){return n.props.map.projection.fromWorldCoordinates(e)}));if(a.coordinates)null===(o=(i=n.props).onDragEnd)||void 0===o||o.call(i,{coordinates:a.coordinates});return!1}},n._id=t.id||s().v4(),n._dragMoveThrottled=(0,l.Z)(n._dragMove,50),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.props;t.map.addFeature(this._dataSourceId,this._getFeature(),t.drawingStyle,t.parentGroupId),Object.keys(v).forEach((function(n){t[n]&&e._addHandler(n,e._dataSourceId,t[n])})),t.draggable&&(t.map.dragger.on("dragStart",this._dragStart),t.map.dragger.on("dragMove",this._dragMoveThrottled),t.map.dragger.on("dragEnd",this._dragEnd))},n.componentDidUpdate=function(e){var t=this,n=this.props,r=e.dataSourceId?e.dataSourceId:d.UZ.DEFAULT_GRAPHICS;r!==this._dataSourceId?(n.map.removeFeatureById(r,this._id),n.map.addFeature(this._dataSourceId,this._getFeature(),n.drawingStyle,n.parentGroupId)):((!(0,u.Z)(e.drawingStyle,n.drawingStyle)||!(0,u.Z)(e.geometry,n.geometry)||e.draggable!==n.draggable)&&n.map.updateFeature(this._dataSourceId,this._getFeature(),n.drawingStyle),e.parentGroupId!==n.parentGroupId&&n.map.moveFeatureToGroup(this._dataSourceId,this._getFeature().id,n.parentGroupId));Object.keys(v).forEach((function(o){n[o]===e[o]&&r===t._dataSourceId||(e[o]&&t._removeHandler(o,r),n[o]&&t._addHandler(o,t._dataSourceId,n[o]))})),!e.draggable&&n.draggable?(n.map.dragger.on("dragStart",this._dragStart),n.map.dragger.on("dragMove",this._dragMoveThrottled),n.map.dragger.on("dragEnd",this._dragEnd)):e.draggable&&!n.draggable&&(n.map.dragger.offSingle("dragStart",this._dragStart),n.map.dragger.offSingle("dragMove",this._dragMoveThrottled),n.map.dragger.offSingle("dragEnd",this._dragEnd))},n.componentWillUnmount=function(){var e=this;this.props.map.dragger.offSingle("dragStart",this._dragStart),this.props.map.dragger.offSingle("dragMove",this._dragMoveThrottled),this.props.map.dragger.offSingle("dragEnd",this._dragEnd),Object.keys(this._handlers).forEach((function(t){return e._removeHandler(t,e._dataSourceId)})),this.props.map.removeFeatureById(this._dataSourceId,this._id)},n.render=function(){return null},(0,r.Z)(t,[{key:"_dataSourceId",get:function(){return this.props.dataSourceId||d.UZ.DEFAULT_GRAPHICS}}]),t}(i.PureComponent))},7151:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var r=n(7462),o=n(4578),i=n(7363),a=n(4467),s=n(4100),c=n(6169),l=n(1170),u=(n(2446),n(9249));function d(e){var t;return Boolean(null===(t=e.properties.tags)||void 0===t?void 0:t.includes("building"))}var p={color:{r:1,g:68/255,b:.2,a:1}},m={lightness:-.1,saturation:1};var f=n(8574).Z.getLogger("map-objects"),v=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handlers={},n.state={isHover:!1},Object.keys(u.h).forEach((function(e){return n._handlers[e]=n._getHandler(e)})),n}(0,o.Z)(t,e);var n=t.prototype;return n._getHandler=function(e){var t=this;return function(n,r){var o=t.props,i=n.feature;"onMouseEnter"===e&&f(i.id,n);var a=!o.config.uatraits.isTouch&&!o.disableHighlight;(o.shouldHover?o.shouldHover(i):Boolean(o.onClick))&&("onMouseEnter"===e&&(a&&o.map.setObjectHighlight(function(e){return{object:e,color:d(e)?m:p}}(i)),t.setState({isHover:!0})),"onMouseLeave"===e&&(a&&o.map.setObjectHighlight(void 0),t.setState({isHover:!1})));var s=o[e];s&&s(i,r)}},n.render=function(){var e=this,t=(0,l.se)(this.props.layer);return i.createElement(i.Fragment,null,this.state.isHover?i.createElement(c.Z,{cursor:"pointer"}):null,t.map((function(t){return i.createElement(u.Z,(0,r.Z)({key:t,layer:t},e._handlers))})))},t}(i.Component);const h=(0,a.ZP)((0,s.ZP)({shouldWait:!0})(v))},9249:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u,h:()=>a});var r=n(4578),o=n(7363),i=n(4100),a={onTouchStart:"touchstart",onTouchMove:"touchmove",onTouchEnd:"touchend",onFastClick:"fastclick",onTouchCancel:"touchcancel",onPointerDown:"pointerdown",onPointerMove:"pointermove",onPointerUp:"pointerup",onPointerCancel:"pointercancel",onClick:"click",onDoubleClick:"dblclick",onMouseUp:"mouseup",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove"},s={onUpdate:"update",onCopyrightsChange:"copyrightsChange",onResize:"resize",onZoomRangeChange:"zoomRangeChange",onReady:"ready",onTile3dChanged:"tile3dChanged",onTile3dVisibilityChange:"tile3dVisibilityChange",onVisibleObjectsChanged:"visibleObjectsChanged",onIndoorPlansChanged:"indoorPlansChanged",onVectorError:"vectorError",onVectorStart:"vectorStart",onZoomRoundingChanged:"zoomRoundingChanged",onMainEngineChanged:"mainEngineChanged"},c=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._applyMapHandlers=function(e,t,n){Object.keys(s).forEach((function(r){n&&t&&n[r]===t[r]||(n&&n[r]&&e.offSingle(s[r],n[r]),t&&t[r]&&e.on(s[r],t[r]))}))},t._applyDomHandlers=function(e,t,n){Object.keys(a).forEach((function(r){n&&t&&n[r]===t[r]&&n.layer===t.layer||(n&&n[r]&&e.events.off(a[r],n.layer||"none",n[r]),t&&t[r]&&e.events.on(a[r],t.layer||"none",t[r]))}))},t._onInertiaStart=function(e){t.props.onInertiaStart&&t.props.onInertiaStart(t.props.map.calculateCenter(e.targetPositionWcs))},t._onDragStart=function(){t.props.onDragStart&&t.props.onDragStart()},t._onDragEnd=function(){t.props.onDragEnd&&t.props.onDragEnd()},t._onContainerTouchMove=function(e){t.props.onContainerTouchMove&&t.props.onContainerTouchMove(l(e))},t._onContainerPointerMove=function(e){t.props.onContainerPointerMove&&t.props.onContainerPointerMove(l(e))},t._onActionStart=function(e){t.props.onActionStart&&t.props.onActionStart(e)},t._onActionEnd=function(e){t.props.onActionEnd&&t.props.onActionEnd(e)},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props.map;this._applyMapHandlers(e,this.props),this._applyDomHandlers(e,this.props),e.behaviors.on("actionStart",this._onActionStart),e.behaviors.on("actionEnd",this._onActionEnd),e.behaviors.drag&&(e.behaviors.drag.on("inertiaStart",this._onInertiaStart),e.behaviors.drag.on("dragStart",this._onDragStart),e.behaviors.drag.on("dragEnd",this._onDragEnd)),e.container.addEventListener("touchmove",this._onContainerTouchMove),e.container.addEventListener("pointermove",this._onContainerPointerMove)},n.componentDidUpdate=function(e){this._applyMapHandlers(this.props.map,this.props,e),this._applyDomHandlers(this.props.map,this.props,e)},n.componentWillUnmount=function(){var e=this.props.map;this._applyMapHandlers(e,void 0,this.props),this._applyDomHandlers(e,void 0,this.props),e.behaviors.offSingle("actionStart",this._onActionStart),e.behaviors.offSingle("actionEnd",this._onActionEnd),e.behaviors.drag&&(e.behaviors.drag.offSingle("inertiaStart",this._onInertiaStart),e.behaviors.drag.offSingle("dragStart",this._onDragStart),e.behaviors.drag.offSingle("dragEnd",this._onDragEnd)),e.container.removeEventListener("touchmove",this._onContainerTouchMove),e.container.removeEventListener("pointermove",this._onContainerPointerMove)},n.render=function(){return null},t}(o.PureComponent);function l(e){if("touches"in e){var t=e.touches[0]||e.changedTouches[0];return[t.clientX,t.clientY]}return[e.clientX,e.clientY]}const u=(0,i.ZP)({shouldWait:!0})(c)},1243:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var r=n(7462),o=n(3144),i=n(4578),a=n(7363),s=n(1533),c=n(5877),l=n.n(c),u=n(834),d=n(4100),p=n(8033),m=n(1170);var f=n(724),v=n(4467),h=(0,u.Z)("map-placemark"),g=function(){},y=function(e){function t(t){var n;return(n=e.call(this,t)||this)._container=document.createElement("div"),n._mapEventHandlers=void 0,n._clickTimer=void 0,n._marker=void 0,n._onDragStart=function(){n.setState({isDragging:!0}),n._fireInteractionEvent()},n._fireInteractionEvent=function(){var e,t,n,r;e=window,t="map-placemark-interaction",void 0===n&&(n={bubbles:!0,cancelable:!0}),"function"==typeof Event?r=new Event(t,n):(r=document.createEvent("Event")).initEvent(t,n.bubbles,n.cancelable),e.dispatchEvent(r)},n._updateCursor=function(){var e=n.state.isDragging?"grabbing":n.props.cursor?n.props.cursor:n.props.onClick||n.props.onMouseEnter||n.props.draggable?"pointer":"default";n._container.style.cursor=e},n._addMapEventHandlers=function(e){var t={dragStart:e.onDragStart,dragMove:e.onDragMove,dragEnd:e.onDragEnd};Object.keys(t).forEach((function(e){t[e]&&n._mapEventHandlers.on(e,(function(r){var o=r.object,i=r.newGeometry;if(o&&"Feature"===o.type&&o.id===n._marker.feature.id){var a=n.props.map.projection.fromWorldCoordinates(i.coordinates);t[e]({coordinates:a})}}))}))},n._onDragEnd=function(e){var t=e.object,r=e.newGeometry;n.setState({isDragging:!1}),t&&"Feature"===t.type&&t.id===n._marker.feature.id&&(n._marker.feature.geometry.coordinates=n.props.map.projection.fromWorldCoordinates(r.coordinates))},n._onClick=function(e){e.stopPropagation(),n._fireInteractionEvent();var t=n.props,r=t.onClick||g,o=t.onFastClick||g,i=t.onDoubleClick||g;n._clickTimer?(i(),window.clearTimeout(n._clickTimer),n._clickTimer=void 0):(o(),n._clickTimer=window.setTimeout((function(){r(),n._clickTimer=void 0}),300))},n.state={isDragging:!1},n._container.className=h(),n._marker={feature:{type:"Feature",id:l().v4(),draggable:t.draggable,disableRoundCoordinates:t.disableRoundCoordinates,blockEvents:t.blockEvents,geometry:{type:"Point",coordinates:t.coordinates}},style:{zIndex:t.zIndex||p.I.default,element:n._container}},n._mapEventHandlers=n.props.map.dragger.group(),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props;this._updateCursor(),this._addMapEventHandlers(e),e.map.addFeature(this._dataSourceId,this._marker.feature,this._marker.style),this._mapEventHandlers.on("dragStart",this._onDragStart),this._mapEventHandlers.on("dragEnd",this._onDragEnd)},n.componentWillUnmount=function(){this.props.map.destroyed||(this._mapEventHandlers.offAll(),this.props.map.removeFeatureById(this._dataSourceId,this._marker.feature.id)),window.clearTimeout(this._clickTimer)},n.componentDidUpdate=function(e,t){var n=e.dataSourceId?e.dataSourceId:m.UZ.DEFAULT_MARKERS;n!==this._dataSourceId&&(this.props.map.removeFeatureById(n,this._marker.feature.id),this.props.map.addFeature(this._dataSourceId,this._marker.feature,this._marker.style));var o=this.props,i=!1;o.coordinates!==e.coordinates&&(i=!0,this._marker.feature.geometry.coordinates=o.coordinates),e.draggable!==o.draggable&&(i=!0,this._marker.feature.draggable=o.draggable),e.zIndex!==o.zIndex&&(i=!0,this._marker.style.zIndex=o.zIndex||p.I.default),e.disableRoundCoordinates!==o.disableRoundCoordinates&&(i=!0,this._marker.feature.disableRoundCoordinates=o.disableRoundCoordinates||!1),i&&this.props.map.upsertFeature(this._dataSourceId,(0,r.Z)({},this._marker.feature),(0,r.Z)({},this._marker.style)),o.onDragStart===e.onDragStart&&o.onDragMove===e.onDragMove&&o.onDragEnd===e.onDragEnd||(this._mapEventHandlers.offAll(),this._addMapEventHandlers(o)),e.draggable===o.draggable&&e.cursor===o.cursor&&e.onClick===o.onClick&&t.isDragging===this.state.isDragging||this._updateCursor()},n.render=function(){var e=this,t=this.props,n=a.createElement("div",{dir:t.config.isRtl?"rtl":"ltr","aria-hidden":!0,className:h("wrapper",{"non-interactive":t.nonInteractive}),onClick:this._onClick,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave,onMouseMove:t.onMouseMove},this.props.onMouseLeave&&this.props.shoulTrackOutsideClick?a.createElement(f.Z,{callback:function(){var t,n;return null===(t=(n=e.props).onMouseLeave)||void 0===t?void 0:t.call(n)}},t.children):t.children);return s.createPortal(n,this._container)},(0,o.Z)(t,[{key:"_dataSourceId",get:function(){return this.props.dataSourceId||m.UZ.DEFAULT_MARKERS}}]),t}(a.PureComponent);const _=(0,v.ZP)((0,d.ZP)({shouldWait:!0})(y))},6304:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var r=n(4578),o=n(7363),i=n(7806),a=n(9657),s=n(1421),c=n(8067),l=n(5900),u=n(2690),d=n(309),p=n(6897),m=n(555),f=n(8623);i.d3,Math.PI;const v=function(e){function t(t){var n;return(n=e.call(this,t)||this)._getGeodesicGeometry=function(){for(var e=n.props,t=[],r=0;r<=2*Math.PI;r+=Math.PI/40){var o=(0,a.S)(e.center,[Math.cos(r),Math.sin(r)],e.radius).endPoint;t.push(o)}var i=t[0],l=t.slice(1),u=[].concat(l,[i]).reduce((function(e,t){return[].concat(e,(0,s.b)([e.pop(),t]))}),[i]),d=u.reduce((function(e,t){return e[t[0]>90||t[0]<-90?Math.round(t[0]/360):0]++,e}),{"-1":0,0:0,1:0}),p=0;d[-1]>d[0]&&(p=360),d[1]>d[0]&&(p=-360),p&&(u=u.map((function(e){return[e[0]+p,e[1]]})));var m=[u[0][0],e.center[1]>0?90:-90];return(0,c.t)(m,e.center)<=e.radius&&(u.unshift(m),u.push(m)),u},n._getPixelGeometry=function(){for(var e=n.props,t=(0,l.f)(e.center,2),r=(0,a.S)(e.center,[-1,0],e.radius).endPoint,o=(0,u.g)((0,l.f)(r,2),t),i=[],s=0;s<=2*Math.PI;s+=Math.PI/40){var c=[t[0]+Math.cos(s)*o,t[1]+Math.sin(s)*o];i.push((0,d.W)(c,2))}return i},n._getGeometry=function(){var e=n.props;e.radius;var t=e.geodesic?n._getGeodesicGeometry():n._getPixelGeometry();return{type:"Polygon",coordinates:[(0,f.g)(t)]}},n.state={geometry:n._getGeometry()},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=this.props;(0,p.J)(t.center,e.center)&&t.radius===e.radius||this.setState({geometry:this._getGeometry()})},n.render=function(){return o.createElement(m.Z,{geometry:this.state.geometry,drawingStyle:this.props.drawingStyle,dataSourceId:this.props.dataSourceId})},t}(o.PureComponent)},2328:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(4578),o=n(7363),i=n(834),a=n(4467),s=n(5900),c=n(309),l=n(8067),u=n(7937);var d=n(1091),p=(0,i.Z)("map-scale-line"),m=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.config.uatraits.isMobile,n=t?"height":"width",r=t?80:75,i=function(e){var t=(0,s.f)(e.center,e.zoom),n=t[0],r=t[1],o="width"===e.dimension?1:0,i="height"===e.dimension?1:0,a=(0,c.W)([n-o*e.maxSize/2,r-i*e.maxSize/2],e.zoom),d=(0,c.W)([n+o*e.maxSize/2,r+i*e.maxSize/2],e.zoom),p=(0,l.t)(a,d),m=u.Lr(p,1);return{size:Math.abs(p)>1e-7?Math.round(m*e.maxSize/p):e.maxSize,distance:m}}({center:e.center,zoom:e.zoom,dimension:n,maxSize:r}),a=i.size,d=i.distance,m={};return t?m.height=r+"px":m.width=a+"px",o.createElement("div",{ref:this.props.forwardedRef,className:p(),style:m,"aria-hidden":!0},o.createElement("div",{className:p("label")},u.Bb(d)),o.createElement("div",{className:p("line")}))},t}(o.PureComponent);const f=(0,d.Z)((0,a.ZP)(m))},6692:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var r=n(4578),o=n(7363),i=n.n(o),a=n(834),s=n(583),c=n(9249),l=n(4100),u=n(1170),d=n(1745),p=n(3055),m=n(150),f=n(4960),v=n(4467),h=n(9111),g=(0,s.Z)({resolved:{},chunkName:function(){return"tooltip"},isReady:function(e){var t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("tooltip").then(n.bind(n,7928))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then((function(e){return t.resolved[n]=!0,e}))},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 7928}}),y=3,_=(0,a.Z)("map-tilt-rotate-control"),b=function(e){function t(t){var n;return(n=e.call(this,t)||this)._controlRef=o.createRef(),n._tooltipTargetRef=o.createRef(),n._analyticsCompassRef=o.createRef(),n._analyticsTiltRef=o.createRef(),n._controlCenterPosition=void 0,n._startMovePosition=void 0,n._startTilt=p.eQ,n._isClick=!1,n._prevZoom=void 0,n._startAzimuth=0,n._isMovementEnabled=!0,n._prevTilt=0,n._onMapTiltDebounced=void 0,n._recalculateCenter=function(){if(n._controlRef.current){var e=n._controlRef.current.getBoundingClientRect(),t=e.x,r=e.y,o=e.height,i=e.width;n._controlCenterPosition={x:t+i/2,y:r+o/2}}},n._onMapTilt=function(){var e=n.props.map.tilt;e!==n._prevTilt&&(n._prevTilt=e,n.setState({showTooltip:!0}))},n._onMapUpdate=function(){var e;(n._onMapTiltDebounced(),n._isClick||n.props.map.tilt===n.state.tilt&&n.props.map.azimuth===n.state.azimuth)||(null===(e=n._tooltipTargetRef.current)||void 0===e||e.click());var t=n._prevZoom,r=n.props.map.zoom,o=n.state.tilt;r<p.Hm&&t&&t>=p.Hm&&o!==p.eQ&&(0,p.AK)(n.props.map),n._prevZoom=n.props.map.zoom,n.setState({azimuth:n.props.map.azimuth,tilt:n.props.map.tilt,isTiltDisabled:n.props.map.zoom<p.Hm})},n._onMapMainEngineChanged=function(){var e="vector"===n.props.map.getEffectiveMode();e!==n.state.isVector&&n.setState({isVector:e})},n._addRotateEventListeners=function(){window.addEventListener("mousemove",n._onRotateMove),window.addEventListener("mouseup",n._onRotateEnd)},n._removeRotateEventListeners=function(){window.removeEventListener("mousemove",n._onRotateMove),window.removeEventListener("mouseup",n._onRotateEnd)},n._addTiltEventListeners=function(){window.addEventListener("mousemove",n._onTiltMove),window.addEventListener("mouseup",n._onTiltEnd)},n._removeTiltEventListeners=function(){window.removeEventListener("mousemove",n._onTiltMove),window.removeEventListener("mouseup",n._onTiltEnd)},n._onRotateStart=function(e){if(0===e.button&&n._isMovementEnabled){n._isClick=!0,n.setState({isMove:!0});var t=n._controlRef.current.getBoundingClientRect(),r=t.x,o=t.y,i=t.height,a=t.width;n._controlCenterPosition={x:r+a/2,y:o+i/2},n._startMovePosition={x:e.clientX,y:e.clientY},n._startAzimuth=n.state.azimuth,n._recalculateCenter(),n._addRotateEventListeners()}},n._onRotateMove=function(e){var t=n._controlCenterPosition,r=t.x,o=t.y,i=n._startMovePosition,a=Math.atan2(e.pageY-o,e.pageX-r)-Math.atan2(i.y-o,i.x-r);n._isClick=!1,n.props.map.setCamera({worldCenter:n.props.map.worldCenter,zoom:n.props.map.zoom,azimuth:n._startAzimuth+a,tilt:n.props.map.tilt})},n._onRotateEnd=function(){var e;(n.setState({showTooltip:!0,isMove:!1}),n._removeRotateEventListeners(),n._isClick)||(null===(e=n._analyticsCompassRef.current)||void 0===e||e.changeState({action_type:"drag",rotation_angle_state:(0,f.Z)(n.props.map.azimuth),rotation_angle_diff:(0,f.Z)(n.props.map.azimuth-n._startAzimuth)}))},n._toggleMapRotate=function(){n._isClick&&n._isMovementEnabled&&(n._isMovementEnabled=!1,(0,p.fL)(n.props.map,{cb:function(){var e;n._isClick=!1,n._isMovementEnabled=!0,null===(e=n._analyticsCompassRef.current)||void 0===e||e.changeState({action_type:"click",rotation_angle_state:(0,f.Z)(n.props.map.azimuth),rotation_angle_diff:(0,f.Z)(n.props.map.azimuth-n._startAzimuth)})}}))},n._onTiltStart=function(e){0===e.button&&n._isMovementEnabled&&(n._isClick=!0,n.setState({isMove:!0}),n._startMovePosition={x:e.clientX,y:e.clientY},n._startTilt=n.props.map.tilt,n._addTiltEventListeners())},n._onTiltMove=function(e){var t=n._startMovePosition.y-e.clientY;if(!(Math.abs(t)<y)){var r=Math.PI*t/n.props.map.size.y;n._isClick=!1,n.props.map.setCamera({worldCenter:n.props.map.worldCenter,zoom:n.props.map.zoom,azimuth:n.props.map.azimuth,tilt:n._startTilt+r})}},n._onTiltEnd=function(){var e;(n.setState({showTooltip:!0,isMove:!1}),n._removeTiltEventListeners(),n._isClick)||(null===(e=n._analyticsTiltRef.current)||void 0===e||e.changeState({action_type:"drag",rotation_angle_state:(0,f.Z)(n.props.map.tilt),rotation_angle_diff:(0,f.Z)(n.props.map.tilt-n._startTilt)}))},n._toggleMapTilt=function(){n._isClick&&n._isMovementEnabled&&(n._isMovementEnabled=!1,(0,p.AK)(n.props.map,{cb:function(){var e;n._isClick=!1,n._isMovementEnabled=!0,null===(e=n._analyticsTiltRef.current)||void 0===e||e.changeState({action_type:"click",rotation_angle_state:(0,f.Z)(n.props.map.tilt),rotation_angle_diff:(0,f.Z)(n.props.map.tilt-n._startTilt)})}}))},n._isTiltRotateAllowed=function(){var e=n.state.isVector,t=n.props.map.getLayers().topRasterLayers;return e&&t.every((function(e){return!u.Iw.includes(e.split(":")[0])}))},n._renderTooltip=function(){if(!n.state.showTooltip)return null;return o.createElement(g,{id:"tilt-rotate",targetRef:n._tooltipTargetRef,title:"Наклон карты",text:"Нажмите 2D, чтобы изменить угол обзора",showArrow:!0,position:"left",offset:{main:10,side:0},hideForeverOnTargetClick:!0,ignoreCloseButtonClick:!0,closeOnOutsideClick:!0,renderControls:function(e){return o.createElement("div",{"aria-hidden":!0,className:_("tooltip-button"),onClick:e},"Понятно")},checkTargetVisibility:!1})},n.state={azimuth:t.map.azimuth,tilt:t.map.tilt,isMove:!1,showTooltip:!1,isTiltDisabled:t.map.zoom<p.Hm,isVector:"vector"===t.map.getEffectiveMode()},n._onMapTiltDebounced=(0,h.Z)(n._onMapTilt,p.zn),n}(0,r.Z)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){this._removeRotateEventListeners(),this._removeTiltEventListeners(),this._onMapTiltDebounced.cancel()},n.render=function(){var e,t=this.state,n=this._isTiltRotateAllowed(),r=t.azimuth,i=t.tilt,a=t.isMove,s=t.isTiltDisabled;return e=s?"Увеличьте масштаб, чтобы наклонить карту":i!==p.eQ?"Убрать наклон карты":"Наклонить карту",o.createElement(o.Fragment,null,n?o.createElement(o.Fragment,null,o.createElement("div",{className:_({"in-action":a}),ref:this._controlRef,"aria-hidden":!0},o.createElement(m.ZP,{name:"compass",nodeRef:this._analyticsCompassRef},o.createElement(d.Z,{text:0!==r?"Вернуть север сверху":"Повернуть карту",position:"left",isAir:!0,delay:500,isDisabled:a},o.createElement("div",null,o.createElement("div",{"aria-hidden":!0,className:_("ring"),style:{transform:"rotate("+r+"rad)"},onClick:this._toggleMapRotate,onMouseDown:this._onRotateStart})))),o.createElement(m.ZP,{name:"tilt_control",nodeRef:this._analyticsTiltRef},o.createElement(d.Z,{text:e,position:"left",isAir:!0,delay:500,isDisabled:a,offset:{main:12,side:0}},o.createElement("div",{className:_("tilt-wrapper"),ref:this._tooltipTargetRef},o.createElement("div",{"aria-hidden":!0,className:_("tilt",{tilted:i!==p.eQ,disabled:s}),style:{transform:"rotateX("+i+"rad)"},onClick:s?void 0:this._toggleMapTilt,onMouseDown:s?void 0:this._onTiltStart},i===p.eQ?"3D":"2D"))))),this._renderTooltip()):null,o.createElement(c.Z,{onUpdate:this._onMapUpdate,onMainEngineChanged:this._onMapMainEngineChanged}))},t}(o.Component);const E=(0,l.ZP)({shouldWait:!0})((0,v.ZP)(b))},2976:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r,o=n(4578),i=n(7363),a=n(4100),s=function(e){function t(){return e.apply(this,arguments)||this}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props;if(!r){var t=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._uris=[],t}(0,o.Z)(t,e);var n=t.prototype;return n.test=function(e){var t=e.metadata,n=t&&t.get("uri");return!n||!this._uris.includes(n)},n.add=function(e){this._uris.push(e),this._emit("update")},n.remove=function(e){this._uris=this._uris.filter((function(t){return t!==e})),this._emit("update")},t}(e.ymaps3.eventify().with());r=new t,e.map.addObjectFilter(r)}r.add(this.props.uri)},n.componentDidUpdate=function(e){this.props.uri!==e.uri&&(r.remove(e.uri),r.add(this.props.uri))},n.componentWillUnmount=function(){r.remove(this.props.uri)},n.render=function(){return null},t}(i.Component);const c=(0,a.ZP)({shouldWait:!0})(s)},1074:(e,t,n)=>{"use strict";n.d(t,{Yu:()=>s,xP:()=>c,sN:()=>l,Fz:()=>u});var r=n(7462),o=n(7238),i=n(9705),a={cameraDirection:"front"};function s(e,t){var n=e.type,i=e.featureId,s=e.graphType,c=(0,r.Z)({featureId:i,types:"data"===n?["path","similar"]:[n],graphType:s},a);return(0,o.Z)("mrc",{query:c},t)}function c(e,t){return(0,o.Z)("mrc/near",{query:{ll:(0,i.s)(e.ll),z:e.z,graphType:e.graphType}},t)}function l(e,t){var n=e.ll,s=e.dir,c=e.graphType;return(0,o.Z)("mrc/directions",{query:(0,r.Z)({},a,{ll:(0,i.s)(n),dir:s,graphType:c})},t).catch((function(){return null}))}function u(e,t){return(0,o.Z)("mrc/feature/batch",{body:{ids:e}},t).then((function(e){return e||[]})).catch((function(){return[]}))}},3769:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var r,o=n(4578),i=n(7363),a=n(4467),s=n(555),c=n(8033),l=n(6304),u=n(150),d=n(6667),p=n(7462),m=n(7238),f=n(4086),v=n(1847),h=n(4270),g="https://yandex.ru/captchapgrd",y=function(){return window.PGreed.safeGet().then((function(e){return JSON.stringify(e)}))};function _(){if(r)return r;var e=window.PGreed?Promise.resolve():(0,v.Z)(g);return r=e.then(y)}var b=n(7047);const E={sendAnswer:function(e,t){return(0,m.Z)("business/sendAnswer",{body:(0,p.Z)({},e,{locale:t.locale}),query:{ugc_params:t.query.ugc_params}},t)},logEmptyPhotoPolls:function(e,t){return(0,m.Z)("business/logEmptyPhotoPolls",{body:e},t)},fetchUserReview:function(e,t){return(0,m.Z)("business/fetchUserReview",{query:(0,p.Z)({},e,{locale:t.locale,ugc_params:t.query.ugc_params})},t)},fetchUserReviews:function(e,t){return(0,m.Z)("business/fetchUserReviews",{query:(0,p.Z)({},e,{locale:t.locale,ugc_params:t.query.ugc_params})},t)},fetchUserPhotos:function(e,t){return(0,m.Z)("business/fetchUserPhotos",{query:(0,p.Z)({},e,{locale:t.locale,ugc_params:t.query.ugc_params})},t)},deleteBusinessPhotos:function(e,t){return(0,m.Z)("business/deleteUserPhotos",{query:(0,p.Z)({},e,{locale:t.locale,ugc_params:t.query.ugc_params})},t)},sendUserReview:function(e,t){var n,r,o,i="service"in e?e.service:(0,b.Qg)(t,e.origin);return(r=(void 0===n?{}:n).timeout,o=void 0===r?2e3:r,Promise.race([_(),h.Vs(o)]).catch((function(){}))).then((function(n){return function(e){(0,f.Z)({url:"https://adfstat.yandex.ru/maps-front-maps",query:{reqid:e.reqId}})}(e),(0,m.Z)("business/sendUserReview",{body:(0,p.Z)({},e,{fingerprint:n,locale:t.locale,service:i}),query:{ugc_params:t.query.ugc_params}},t)}))},addUserReaction:function(e,t){return(0,m.Z)("business/addUserReaction",{body:(0,p.Z)({},e,{locale:t.locale}),query:{ugc_params:t.query.ugc_params}},t)},fetchReviews:function(e,t){return(0,m.Z)("business/fetchReviews",{query:(0,p.Z)({},e,{locale:t.locale,ugc_params:t.query.ugc_params})},t)},fetchReviewPollData:function(e,t){return(0,m.Z)("business/fetchReviewPollData",{query:(0,p.Z)({},e,{locale:t.locale,ugc_params:t.query.ugc_params})},t)},fetchServiceZone:function(e,t){return(0,m.Z)("business/fetchServiceZone",{query:{businessId:e,lang:t.lang,locale:t.locale,ugc_params:t.query.ugc_params}},t)},fetchUserImpressions:function(e,t){return(0,m.Z)("business/fetchUserImpressions",{query:(0,p.Z)({},e,{locale:t.locale,ugc_params:t.query.ugc_params})},t)},fetchUserImpressionsGroups:function(e,t){return(0,m.Z)("business/fetchUserImpressionsGroups",{query:(0,p.Z)({},e,{ugc_params:t.query.ugc_params})},t)},answerSbsQuestionImpression:function(e,t){return(0,m.Z)("business/answerSbsQuestionImpression",{query:(0,p.Z)({},e,{ugc_params:t.query.ugc_params})},t)},skipImpression:function(e,t){return(0,m.Z)("business/skipImpression",{query:(0,p.Z)({},e,{ugc_params:t.query.ugc_params})},t)},fetchPotentialCompany:function(e){return(0,m.Z)("business/fetchPotentialCompany",{},e)},answerIsOrganizationOwner:function(e,t){return(0,m.Z)("business/answerIsOrganizationOwner",{query:(0,p.Z)({},e,{ugc_params:t.query.ugc_params})},t)},answerIsSomeCompanyOwner:function(e,t){return(0,m.Z)("business/answerIsSomeCompanyOwner",{query:{isSomeCompanyOwner:e,ugc_params:t.query.ugc_params}},t)}};var w={fill:"#3cb300",fillOpacity:.15,stroke:[{color:"#3cb300",opacity:1,width:2}],interactive:!1,zIndex:c.I.minimum,simplificationRate:0},S=function(e){function t(t){var n;return(n=e.call(this,t)||this)._loadAction=void 0,n._loadGeometry=function(){n.setState({geometry:void 0});var e=n.props.result.onlineProperties;if(e&&e.toponymIds&&!e.serviceGeometry){var t;null===(t=n._loadAction)||void 0===t||t.cancel();var r=n.props;n._loadAction=d.Z.create(E.fetchServiceZone(r.result.id,r.config),{success:function(e){n.setState({geometry:e})}})}},n._renderPolygon=function(e,t){return i.createElement(s.Z,{key:t,geometry:{type:"Polygon",coordinates:e},drawingStyle:w})},n._renderRadius=function(e){var t=n.props.result.coordinates;return i.createElement(u.ZP,{name:"zone"},i.createElement(l.Z,{center:t,radius:e,drawingStyle:w}))},n.state={},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._loadGeometry()},n.componentDidUpdate=function(e){e.result.id!==this.props.result.id&&this._loadGeometry()},n.render=function(){var e=this.props.result.onlineProperties||{},t=e.serviceGeometry,n=e.radius,r=this.state.geometry||t;return n?this._renderRadius(1e3*n):r&&r.length>0?r.map(this._renderPolygon):null},t}(i.Component);const C=(0,a.ZP)(S)},5778:(e,t,n)=>{"use strict";n.d(t,{Z:()=>k});var r=n(3366),o=n(7462),i=n(7855),a=n(106),s=n(585),c=n(6009),l=n(7226);const u=function(e,t,n){if(!(0,l.Z)(n))return!1;var r=typeof t;return!!("number"==r?(0,s.Z)(n)&&(0,c.Z)(t,n.length):"string"==r&&t in n)&&(0,a.Z)(n[t],e)};var d=n(9651),p=Math.ceil,m=Math.max;const f=function(e,t,n){t=(n?u(e,t,n):void 0===t)?1:m((0,d.Z)(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];for(var o=0,a=0,s=Array(p(r/t));o<r;)s[a++]=(0,i.Z)(e,o,o+=t);return s};var v=n(7619),h=n(3841),g=n(4960);var y=n(9705),_=n(8848),b=n(7238),E=n(8926),w=n(9749),S=["origin"],C="",Z={fetch:function(e,t,n){void 0===n&&(n={});var r=n.useSlowHandler?"slow/search":"search",o=P(e,t);return(0,b.Z)(r,{query:o},t).then((function(e){C=e.requestId;var t=(0,w.W)();return t&&t.createChild("search_response",{origin:o.origin,reqid:e.requestId,serpid:e.requestSerpId}).attach().detach(),e}))},batchFetch:function(e,t){return f(e,15).reduce((function(e,n){return e.then((function(e){var r={requestQueries:n.map((function(e){return P(e,t)}))};return(0,b.Z)("search/batch",{body:r},t).then((function(e){var t,n=null===(t=e.find((function(e){return Boolean(e)})))||void 0===t?void 0:t.requestId;return n&&(C=n),e})).catch((function(){return n.map((function(){return null}))})).then((function(t){return[].concat(e,[t])}))}))}),Promise.resolve([])).then((function(e){return(0,v.Z)(e)}))},fetchSearchResult:function(e,t,n){if("poi"===e.from){if(e.uri)return Z.loadPoiByUri(e.uri,t,(0,o.Z)({},n||{},{origin:e.origin})).then((function(t){return(0,o.Z)({},t,{items:t.items.map((function(t,n){return(0,o.Z)({},t,{hotspotProperties:e.hotspotProperties,displayCoordinates:e.coordinates&&0===n?e.coordinates:t.displayCoordinates})}))})}));if(e.coordinates)return Z.loadPoiByCoordinates(e.coordinates,t,(0,o.Z)({},n||{},{origin:e.origin})).then((function(t){if(E.br(e.hotspotProperties)){var n=t.items[0],r={title:"Парковка",description:n.address,hotspotProperties:e.hotspotProperties,id:n.id,type:n.type,kind:n.kind,requestId:n.requestId,analyticsId:n.analyticsId,address:n.address,coordinates:n.coordinates,displayCoordinates:n.displayCoordinates,encodedCoordinates:n.encodedCoordinates,stops:n.stops,panorama:n.panorama,photos:n.photos,uri:n.uri};t.items=[r]}return t}))}if("whatshere"===e.from)return Z.loadWhatshere(e,t);var r=(0,o.Z)({},e,{count:1,searchType:"TEXT"});return r.uri&&(r.mode="uri"),Z.fetch(r,t)},fetchCategoryIcons:function(e,t){var n={ll:e.ll,lang:t.lang,priorityOrder:e.priorityOrder,extendedParams:t.experiments.menuParams};return(0,b.Z)("search/categoryIcons",{query:n},t)},prepareChainSearchRequest:function(e,t){return Z.fetch({count:1,kind:"locality",text:(0,y.s)(e.center,{reverse:!0}),origin:"chain-city"},t).then((function(t){var n={searchType:"TEXT",displayText:e.chain.name,text:"chain_id:("+e.chain.id+")",origin:e.origin||"chain"},r=t.bounds;if(r){var o=function(e){var t=e[0][1],n=[e[1][0]-e[0][0],e[1][1]-t],r=Math.tan((0,h.I)(t+90)/2),o=Math.tan((0,h.I)(n[1])/2),i=Math.max((-r*r-r*o)/(r*o-1),0),a=.5*Math.log(i),s=2*(Math.atan(Math.exp(a))-.25*Math.PI);return{center:[(e[0][0]+e[1][0])/2,(0,g.Z)(s)],span:n}}(r);n.center=o.center,n.span=o.span}return n}))},loadPoiByCoordinates:function(e,t,n){return Z.fetch({text:(0,y.s)(e,{reverse:!0}),count:1,origin:n.origin,clientId:n.clientId,snippets:R(t)},t)},loadPoiByUri:function(e,t,n){return Z.fetch({mode:"uri",uri:e,count:1,origin:n.origin,clientId:n.clientId,snippets:R(t)},t)},loadWhatshere:function(e,t){var n=e.origin,o=(0,r.Z)(e,S);return Z.fetch({pin:!0,text:(0,y.s)(o.coordinates,{reverse:!0}),zoom:o.zoom,span:[.001,.001],count:1,origin:n||"whatshere",addBuildingGeometry:e.addGeometry},t).then((function(e){var r,o=e.items[0];return o?("poi"!==n||t.uatraits.isMobile||(o.displayCoordinates=o.coordinates),t.uatraits.isMobile&&"house"===(null===(r=e.exactResult)||void 0===r?void 0:r.kind)&&(o.displayCoordinates=e.exactResult.coordinates),e):null})).catch((function(){return null}))}};function R(e){return e.search.snippets.filter((function(e){return"related_adverts/1.x"!==e&&"related_adverts_1org/1.x"!==e}))}function P(e,t){var n=e.clientId||(t.uatraits.isMobile?"maps-m":"maps"),r=e.origin?n+"-"+e.origin:n,i={text:e.text,lang:t.locale,yandex_gid:t.userRegion.id,client_id:e.clientId,origin:r,results:e.count,ctx:e.context,mode:e.mode,lr:e.lr,uri:e.uri,business_oid:Array.isArray(e.id)?e.id.join(","):e.id,z:e.zoom,sort:e.sort,business_filter:e.filters,autoscale:e.autoscale,distinguish_layers:e.distinguishLayers,correct_misspell:e.correctMisspell,geocoder_kind:e.kind,skip:e.skip,rspn:e.restrictSpan,rearr:e.rearr,groupchains_advert:e.groupchains_advert,relev_ranking_formula:e.relev_ranking_formula,maxadv:e.maxadv,eventsBranch:t.query.eventsBranch,menuParams:t.experiments.menuParams,advert_page_id:e.advert_page_id,pron:e.pron};return e.addBuildingGeometry&&(i.search_geometry="2"),e.sortOrigin&&(i.sort_origin=(0,y.s)(e.sortOrigin)),e.center&&(i.ll=(0,y.s)(e.center)),e.span&&(i.spn=(0,y.s)(e.span)),e.bbox&&(i.bbox=e.bbox.join("~")),e.snippets?i.snippets=e.snippets:i.snippets=t.search.snippets,t.experiments.ui.groupSameCompanies&&(i.snippets=i.snippets.concat("collapsed_orgs/1.x")),t.experiments.ui.geosearchPinPriority&&(i.snippets=i.snippets.concat("pin_priority/1.x")),t.experiments.ui.orgSimilarRequests&&(i.snippets=i.snippets.concat("similar_queries_smart_rubric/1.x")),t.experiments.ui.showRelatedPlacesAdvertOnMap&&(i.snippets=i.snippets.filter((function(e){return"related_adverts/1.x"!==e&&"related_adverts_1org/1.x"!==e})),i.snippets=i.snippets.concat("related_places/1.x")),t.experiments.ui.businessDiscovery&&(i.snippets=i.snippets.concat("media_flow_stories/1.x")),i.snippets=i.snippets.join(),e.direct&&(i=(0,o.Z)({},i,t.advert.direct.searchParams)),e.pin&&(i.geocoder_pin=1),e.type&&(i.type=e.type.join()),e.routeCoordinates&&e.bounds&&e.routeCoordinates.some((function(t){return(0,_.V)(e.bounds,t)}))&&(i.business_rll=e.routeCoordinates.map((function(e){return(0,y.s)(e,{fractionDigits:5})})).join("~")),e.clientUsecase&&(i.client_usecase=e.clientUsecase),e.suggestReqid&&"form"===e.origin&&(i.suggest_reqid=e.suggestReqid),e.serpId&&(i.serpid=e.serpId),(e.parentReqId||C||t.searchPreloadedResults)&&(i.parent_reqid=e.parentReqId||C||t.searchPreloadedResults.requestId),e.geoWhere&&(i.geowhere=(0,y.s)(e.geoWhere,{reverse:!0})),e.businessMode&&(i.business_mode=e.businessMode),"boolean"==typeof e.businessShowClosed&&(i.business_show_closed=e.businessShowClosed?1:0),e.ull&&(i.ull=(0,y.s)(e.ull)),(0,o.Z)({},i,e.rawParams,E.DB(t.query,t.experiments))}const k=Z},1881:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r,o,i=n(4578),a=n(7363),s=n(745),c=n(4467),l={offsetWidth:0,offsetHeight:0},u=function(e){function t(t){var n;return(n=e.call(this,t)||this)._ref=a.createRef(),n._calcSizes=function(e){return new Promise((function(t){n.setState({render:e},(function(){var e,r,o,i=null!==(e=null===(r=n._ref.current)||void 0===r||null===(o=r.children)||void 0===o?void 0:o[0])&&void 0!==e?e:l,a=i.offsetWidth,s=i.offsetHeight;t({width:a,height:s})}))}))},n.state={render:function(){return null}},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.setCalcSizes(this._calcSizes)},n.render=function(){return a.createElement("div",{ref:this._ref},this.state.render())},t}(a.PureComponent);const d=function(e,t){var n=function(){return o||(o=function(e){var t=window.document.createElement("div");t.setAttribute("style","position: absolute; top: -1000px; left: -1000px"),window.document.body.appendChild(t);var n=(0,s.s)(t);return new Promise((function(t){n.render(a.createElement(c.iV,{value:e},a.createElement(u,{setCalcSizes:t})))}))}(t)),o.then((function(t){return t(e)}))};return r=r?r.then(n):n()}},5481:(e,t,n)=>{"use strict";n.d(t,{Po:()=>r});function r(e,t,n){var r=(void 0===n?{}:n).useRealty,o=void 0===r||r,i=e.realty;return null!=i&&i.company.phone&&o&&!e.advert?[{number:i.company.phone,counter:i.company.phoneCounter?i.company.phoneCounter+"&source=map&crc="+t.xscriptCsrfToken:void 0,type:"phone",info:"Офис продаж"}]:e.phones||[]}},2447:(e,t,n)=>{"use strict";n.d(t,{bL:()=>M,lR:()=>k});var r=n(2967),o=n(5311),i=n(2394),a=n(6600);function s(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}var c=6e4;function l(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();t.setSeconds(0,0);var r=t.getTime()%c;return n*c+r}var u=36e5,d=6e4,p=2,m={dateTimeDelimeter:/[T ]/,plainTime:/:/,timeZoneDelimeter:/[Z ]/i,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-])(\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function f(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);var n=t||{},r=null==n.additionalDigits?p:s(n.additionalDigits);if(2!==r&&1!==r&&0!==r)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e))return new Date(e.getTime());if("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))return new Date(e);if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var o=function(e){var t,n={},r=e.split(m.dateTimeDelimeter);m.plainTime.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1],m.timeZoneDelimeter.test(n.date)&&(n.date=e.split(m.timeZoneDelimeter)[0],t=e.substr(n.date.length,e.length)));if(t){var o=m.timezone.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),i=function(e,t){var n,r=m.YYY[t],o=m.YYYYY[t];if(n=m.YYYY.exec(e)||o.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=m.YY.exec(e)||r.exec(e)){var a=n[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(o.date,r),a=i.year,c=function(e,t){if(null===t)return null;var n,r,o,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.MM.exec(e))return r=new Date(0),_(t,o=parseInt(n[1],10)-1)?(r.setUTCFullYear(t,o),r):new Date(NaN);if(n=m.DDD.exec(e)){r=new Date(0);var a=parseInt(n[1],10);return function(e,t){if(t<1)return!1;var n=y(e);if(n&&t>366)return!1;if(!n&&t>365)return!1;return!0}(t,a)?(r.setUTCFullYear(t,0,a),r):new Date(NaN)}if(n=m.MMDD.exec(e)){r=new Date(0),o=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return _(t,o,s)?(r.setUTCFullYear(t,o,s),r):new Date(NaN)}if(n=m.Www.exec(e))return b(t,i=parseInt(n[1],10)-1)?v(t,i):new Date(NaN);if(n=m.WwwD.exec(e)){i=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return b(t,i,c)?v(t,i,c):new Date(NaN)}return null}(i.restDateString,a);if(isNaN(c))return new Date(NaN);if(c){var f,h=c.getTime(),g=0;if(o.time&&(g=function(e){var t,n,r;if(t=m.HH.exec(e))return E(n=parseFloat(t[1].replace(",",".")))?n%24*u:NaN;if(t=m.HHMM.exec(e))return E(n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")))?n%24*u+r*d:NaN;if(t=m.HHMMSS.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return E(n,r,o)?n%24*u+r*d+1e3*o:NaN}return null}(o.time),isNaN(g)))return new Date(NaN);if(o.timezone){if(f=function(e){var t,n,r;if(t=m.timezoneZ.exec(e))return 0;if(t=m.timezoneHH.exec(e))return w(r=parseInt(t[2],10))?(n=r*u,"+"===t[1]?-n:n):NaN;if(t=m.timezoneHHMM.exec(e)){r=parseInt(t[2],10);var o=parseInt(t[3],10);return w(r,o)?(n=r*u+o*d,"+"===t[1]?-n:n):NaN}return 0}(o.timezone),isNaN(f))return new Date(NaN)}else f=l(new Date(h+g)),f=l(new Date(h+g+f));return new Date(h+g+f)}return new Date(NaN)}function v(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var o=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+o),r}var h=[31,28,31,30,31,30,31,31,30,31,30,31],g=[31,29,31,30,31,30,31,31,30,31,30,31];function y(e){return e%400==0||e%4==0&&e%100!=0}function _(e,t,n){if(t<0||t>11)return!1;if(null!=n){if(n<1)return!1;var r=y(e);if(r&&n>g[t])return!1;if(!r&&n>h[t])return!1}return!0}function b(e,t,n){return!(t<0||t>52)&&(null==n||!(n<0||n>6))}function E(e,t,n){return(null==e||!(e<0||e>=25))&&((null==t||!(t<0||t>=60))&&(null==n||!(n<0||n>=60)))}function w(e,t){return null==t||!(t<0||t>59)}function S(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=t||{},r=n.locale,o=r&&r.options&&r.options.weekStartsOn,i=null==o?0:s(o),a=null==n.weekStartsOn?i:s(n.weekStartsOn);if(!(a>=0&&a<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var c=f(e,n),l=c.getDay(),u=(l<a?7:0)+l-a;return c.setDate(c.getDate()-u),c.setHours(0,0,0,0),c}function C(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=t||{},r=n.locale,o=r&&r.options&&r.options.firstWeekContainsDate,i=null==o?1:s(o),a=null==n.firstWeekContainsDate?i:s(n.firstWeekContainsDate),c=function(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=f(e,t),r=n.getFullYear(),o=t||{},i=o.locale,a=i&&i.options&&i.options.firstWeekContainsDate,c=null==a?1:s(a),l=null==o.firstWeekContainsDate?c:s(o.firstWeekContainsDate);if(!(l>=1&&l<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var u=new Date(0);u.setFullYear(r+1,0,l),u.setHours(0,0,0,0);var d=S(u,t),p=new Date(0);p.setFullYear(r,0,l),p.setHours(0,0,0,0);var m=S(p,t);return n.getTime()>=d.getTime()?r+1:n.getTime()>=m.getTime()?r:r-1}(e,t),l=new Date(0);return l.setFullYear(c,0,a),l.setHours(0,0,0,0),S(l,t)}var Z=6048e5;function R(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=f(e,t),r=S(n,t).getTime()-C(n,t).getTime();return Math.round(r/Z)+1}var P=["break","opening_soon","closing_soon"];function k(e,t,n){var r;void 0===n&&(n={});var o,i=e.status,a=e.currentWorkingStatus,s=n.short?null==a?void 0:a.shortText:null==a?void 0:a.text;return{text:n.showMoved&&null!==(r=e.businessProperties)&&void 0!==r&&r.moved_to?"Организация переехала":"open"===i?null!=s?s:"График работы не указан":(o=i,{"possible-closed":"Возможно, больше не работает","temporary-closed":"Временно не работает","permanent-closed":"Больше не работает"}[o]),state:{closed:"open"!==i||Boolean(a&&!a.isOpenNow),"changing-soon":!(!a||!a.tag)&&a.tag.some((function(e){return P.includes(e)})),"no-data":!s}}}function I(e,t){if(!e)return{};var n=[];e.unusual_hours&&(n=n.concat(e.unusual_hours)),e.valid_schedule&&(n=n.concat(e.valid_schedule));var r=i.x2(i.$_(t));return n.reduce((function(e,n){var o=function(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");return f(e,t).getDay()}(n),i=R(n,{weekStartsOn:1})===R(r,{weekStartsOn:1});if(!e[o]&&i){var s=f(n);e[o]=(0,a.p6)(s,t)}return e}),{})}function M(e,t){if(e.workingTime){var n=i.x2(i.$_(t)).getDay(),a=I(e.businessProperties,t);return[].concat(e.workingTime.slice(1),[e.workingTime[0]]).map((function(e,s){var c,l=(s+1)%7,u=(0,r.Z)(o.sb[l].slice(0,2));return e?1===e.length&&0===i.Hg(e[0].to,e[0].from)?(c="Круглосуточно",u+=" 00:00-23:59"):(c=e.map((function(e){var t=e.from,n=e.to;return i.BB(t)+" – "+i.BB(n)})),u+=" "+e.map((function(e){var t=e.from,n=e.to;return i.BB(t)+"-"+i.BB(n)})).join(",")):(c="Выходной",u=""),{dayName:(0,o.G7)(t,o.sb[l]),text:c,isWeekend:!e,isToday:n===l,changedDate:a[l],meta:u}}))}}},550:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var r=n(4578),o=n(7363),i=n(4467),a=n(7734),s=n(555),c=n(7048);var l=n(1886),u=n(8926),d=n(4100),p={Polygon:.165,MultiLineString:.05},m=function(e){function t(t){var n;return(n=e.call(this,t)||this)._timestamp=0,n._intensityRaf=-1,n._calculateIntensity=function(){if(n._stopAnimateIntensity(),n._getGeometry()){var e=n._getTargetIntensity();n.state.intensity!==e&&(n._stopAnimateIntensity(),n._startAnimateIntensity())}},n._startAnimateIntensity=function(){n._intensityRaf=window.requestAnimationFrame(n._animateIntensity)},n._stopAnimateIntensity=function(){window.cancelAnimationFrame(n._intensityRaf),n._timestamp=0},n._animateIntensity=function(){var e=n._getGeometry();if(e){var t=n._timestamp?(n.props.getToday().getTime()-n._timestamp)/(1e3/30):1,r=p[e.type]*t,o=n._getTargetIntensity(),i=n.state.intensity,a=i<o?Math.min(o,i+r):Math.max(o,i-r);n.props.config.query["no-animation"]&&(a=o),n.setState({intensity:a}),a!==o?(n._timestamp=n.props.getToday().getTime(),n._startAnimateIntensity()):n._timestamp=0}},n._getTargetIntensity=function(){var e,t=n._getGeometry();if(!t)return 0;var r=n.props.searchResults.items[0],o="MultiLineString"===t.type&&r&&v(r);if("Polygon"!==t.type&&!o)return 1;var i,a,s,u=(0,l.o)((e=[]).concat.apply(e,t.coordinates));return i=u,a=n.props.mapLocation.bounds,s=n.props.mapLocation.zoom,function(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}((0,c.n)(i,s),(0,c.n)(a,s))?0:1},n._getDrawingStyle=function(e,t){var r=n.state.intensity;switch(e.type){case"MultiLineString":return v(t)?{stroke:[{color:"#a3a8a8",opacity:r,width:3}],interactive:!1}:{stroke:[{color:"#000000",opacity:.18,width:6}],interactive:!1};case"Polygon":return{fill:h(t)?"#00ff00":"#ff4141",fillOpacity:.05*r,stroke:[{color:h(t)?"#359400":"#d54747",opacity:.7*r,width:2}],interactive:!1};default:return}},n._getGeometry=function(){var e=n.props.searchResults,t=e.requestDisplayGeometry;if(!t){var r=e.items[0];r&&"displayGeometry"in r&&(t=r.displayGeometry)}return(0,u.UI)(t)},n.state={intensity:0},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._calculateIntensity()},n.componentDidUpdate=function(e){var t=this.props;e.mapLocation===t.mapLocation&&e.searchResults===t.searchResults||this._calculateIntensity()},n.componentWillUnmount=function(){this._stopAnimateIntensity()},n.render=function(){var e=this.props.searchResults.items[0];if(!e)return null;var t=this._getGeometry();if(!t)return null;var n=this._getDrawingStyle(t,e);return o.createElement(s.Z,{geometry:t,drawingStyle:n})},t}(o.PureComponent),f=["rezervation","forest","park","garden","grass"];function v(e){return"toponym"===e.type&&"route"===e.kind}function h(e){switch(e.type){case"toponym":return"vegetation"===e.kind;case"business":return(e.categories||[]).some((function(e){return f.includes(e.class||"")}));default:return!1}}const g=(0,a.ZP)((0,i.ZP)((0,d.ZP)({shouldWait:!0})(m)))},8037:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var r=n(4578),o=n(7363),i=n.n(o),a=n(834),s=n(583),c=n(150),l=n(8926),u=n(6786),d=n(1243),p=n(4025),m=n(3907),f=n(6204),v=n(4467),h=(0,s.Z)({resolved:{},chunkName:function(){return"stories-preview"},isReady:function(e){var t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:function(){return n.e("stories-preview").then(n.bind(n,767))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,Promise.resolve(this.importAsync(e)).then((function(e){return t.resolved[n]=!0,e}))},requireSync:function e(t){var r=this.resolve(t);return n(r)},resolve:function e(){return 767}}),g=(0,a.Z)("search-placemark-view"),y=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this)._onClick=function(){t.props.onClick&&t.props.onClick(t.props.result)},t._getPlacemarkData=function(){var e=t.props;return{icon:e.icon,mode:e.mode,result:e.result}},t._onMouseEnter=function(){var e,n;null===(e=(n=t.props).onMouseEnter)||void 0===e||e.call(n,t._getPlacemarkData())},t._onMouseLeave=function(){var e,n;null===(e=(n=t.props).onMouseLeave)||void 0===e||e.call(n,t._getPlacemarkData())},t._renderEntrances=function(){var e=t.props;return e.active?o.createElement(p.Z,{result:e.result,analyticsName:"entrances",animated:!0}):null},t._renderEntranceStory=function(){var e=t.props,n=e.result;return e.active&&"business"===n.type&&n.lastMileStory?o.createElement(h,{result:n}):null},t}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.result,n=e.icon,r=e.title,i=!e.badgeText&&r&&r.position||"right",a=null;if(r){var s=null;e.badgeText&&(s=o.createElement("div",{className:g("badge")},e.badgeText));var p="bottom"!==i?n.centerY:void 0;a=o.createElement("div",{className:g("title"),style:{marginTop:p}},r.element,s)}var m=l.Ye(t),v="brandingId"in t&&t.brandingId||"advert"in t&&t.advert&&t.advert.pinBranding?"branding":m?"rubric":"default",h={marginTop:-n.baseY,marginLeft:"left"===i?n.baseX:"right"===i?-n.baseX:void 0};return o.createElement(c.ZP,{name:e.analyticsName||"placemark",nodeState:{type:l.Dr(t),gml_id:t.analyticsId,pinPriority:"business"===t.type?t.pinPriority:void 0,logId:t.logId,permalink:"id"in t?t.id:void 0,uri:u.fS(t),reqid:t.requestId,branding:"brandingId"in t?t.brandingId:void 0,active:e.active,lowRelevance:"lowRelevance"in t&&t.lowRelevance,relatedAdvertType:"relatedAdvertType"in t&&t.relatedAdvertType||void 0,mode:e.mode,iconType:v},logClick:!0},o.createElement(d.Z,{coordinates:e.coordinates,zIndex:e.zIndex,onClick:this._onClick,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},o.createElement("div",{className:g({position:i}),"data-object":"search-placemark","data-id":e.result.id,"data-log-id":e.result.logId,"data-mode":e.mode,"data-coordinates":e.coordinates.join(","),"data-icon-type":v,style:(0,f.cq)(e.config,h)},o.createElement("div",{className:g("icon"),style:{width:n.width,height:n.height}},n.element),a)),e.isFlyoverActive?null:this._renderEntrances(),this._renderEntranceStory())},t}(o.PureComponent);const _=(0,m.ZP)((0,v.ZP)(y))},4402:(e,t,n)=>{"use strict";n.d(t,{Z:()=>se});var r=n(7462),o=n(7326),i=n(4578),a=n(7363),s=n(8926),c=n(834),l=n(4467),u=n(348),d=n(8657),p=(0,c.Z)("search-placemark-title-modular-hint-view");const m=function(e){var t=(0,l.ZR)(),n=function(){if("RATING"!==e.hint.type||!e.hint.text)return null;var n=Number.parseFloat(e.hint.text);return Number.isNaN(n)?null:a.createElement("span",{className:p()},a.createElement(u.Z,{name:"star-12",className:p("rating-image"),inline:!0}),a.createElement("span",{className:p("rating")},d.D$(n,t.lang,{min:1,max:1})))}()||function(){var t,n,r,o;if("WORKING_HOURS"!==e.hint.type)return null;var i=(null===(t=e.hint.properties)||void 0===t||null===(n=t.workingHours)||void 0===n?void 0:n.shortText)||e.hint.text;if(!i)return null;var s=!1===(null===(r=e.hint.properties)||void 0===r||null===(o=r.workingHours)||void 0===o?void 0:o.isOpen);return a.createElement("span",{className:p({red:s})},i)}()||(e.hint.text?a.createElement("span",{className:p()},e.hint.text):null);return n?a.createElement(a.Fragment,null,e.children(n)):null};var f=(0,c.Z)("search-placemark-title"),v=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this)._renderTitleRating=function(){var e,n=null===(e=t.props.subtitleHints)||void 0===e?void 0:e.find((function(e){return"RATING"===e.type}));return n?a.createElement(m,{hint:n},(function(e){return a.createElement("div",{className:f("title-rating")},e)})):null},t._renderTitle=function(){return a.createElement("div",{className:f("title")},a.createElement("div",{className:f("title-text")},t.props.title),t._renderTitleRating())},t._renderSubtitleHint=function(e,t){return"RATING"===e.type?null:a.createElement(m,{key:t,hint:e},(function(e){return a.createElement("span",{className:f("subtitle-item")},e)}))},t._renderSubtitle=function(){return t.props.subtitleHints&&t.props.showSubtitle?a.createElement("div",{className:f("subtitle")},t.props.subtitleHints.map(t._renderSubtitleHint)):null},t._renderMultilineSubtitle=function(){return a.createElement(a.Fragment,null,a.createElement("div",{className:f("multiline-subtitle-width")},t._renderSubtitle()),a.createElement("div",{className:f("multiline-subtitle")},t._renderSubtitle()))},t}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this.props;return a.createElement("div",{className:f({background:e.background,"low-relevance":e.isLowRelevance,position:e.position,"no-truncate":e.disableTruncate})},this._renderTitle(),e.multilineSubtitle?this._renderMultilineSubtitle():this._renderSubtitle())},t}(a.PureComponent);const h=(0,l.ZP)(v);var g=(0,c.Z)("search-placemark-title-magic-content");const y=function(e){var t,n,r=(0,l.ZR)(),o=function(e,t){return"RATING"===e.type?null:a.createElement(m,{key:t,hint:e},(function(e){return a.createElement("span",{className:g("subtitle-item")},e)}))};return a.createElement("div",{className:g({position:e.position,branding:Boolean("business"===e.result.type&&(null===(t=e.result.advert)||void 0===t?void 0:t.pinBranding))})},function(){var t,n;if(!e.showIsland)return null;var o="business"===e.result.type?null===(t=e.result.modularPin)||void 0===t||null===(n=t.subtitleHints)||void 0===n?void 0:n.find((function(e){return"RATING"===e.type})):void 0,i=null!=o&&o.text?Number.parseFloat(o.text):void 0;return void 0===i||Number.isNaN(i)?null:a.createElement("div",{className:g("island")},d.D$(i,r.lang,{min:1,max:1}))}(),a.createElement("div",{className:g("content")},e.showTitle?a.createElement("div",{className:g("title")},e.title):null,"business"===e.result.type&&null!==(n=e.result.modularPin)&&void 0!==n&&n.subtitleHints&&e.showSubtitle?a.createElement("div",{className:g("subtitle")},e.result.modularPin.subtitleHints.map(o)):null))};var _=n(9410),b=(0,c.Z)("poi-placemark-title");const E=function(e){var t=(0,_.Z)(e.title,{length:40}),n=e.hover?void 0:{color:e.color,WebkitTextFillColor:e.color};return a.createElement("div",{className:b({hover:e.hover}),style:n},t.split(" ").map((function(e,t){return a.createElement("span",{key:t,className:b("word")},e)})))};var w=n(2447);const S=function(e){function t(t){var n;return(n=e.call(this,t)||this)._fetchIcon=function(){n.props.icon.promise.then((function(e){n.setState({element:e})}))},n.state={},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._fetchIcon()},n.componentDidUpdate=function(e){this.props.icon.promise!==e.icon.promise&&this._fetchIcon()},n.render=function(){var e,t,n=this.state.element;return n?(null===(e=(t=this.props).children)||void 0===e?void 0:e.call(t,n))||n:null},t}(a.Component);var C=(0,c.Z)("search-placemark-icon");function Z(e,t){return!t.experiments.ui.searchPinsNoClosed&&("business"===e.type&&("open"!==e.status||w.lR(e,t).state.closed))}const R=function(e){var t,n="lowRelevance"in e.result,o={mode:e.mode,"group-mode":e.groupMode,state:e.state,"has-advert":s.xi(e.result),"low-relevance":n,closed:Z(e.result,e.config)},i="business"===e.result.type?n?e.result.businessProperties&&e.result.businessProperties.geoproduct_poi_color||"#999":null===(t=e.style)||void 0===t?void 0:t.color:void 0,c=i&&"hover"!==e.state?{color:i}:void 0;return a.createElement("div",{className:C(o),style:(0,r.Z)({},c)},a.createElement(S,{icon:e.icon}))};var P=n(4086),k=n(1109),I=n(6204);var M=(0,c.Z)("search-placemark-icons"),T={dot:{source:'<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="2ccc4e9f8fe2f8acc9e7eab53f797f56__b" d="M7 14A7 7 0 1 0 7 0a7 7 0 0 0 0 14z"/><filter id="2ccc4e9f8fe2f8acc9e7eab53f797f56__a" width="150%" height="150%" x="-25%" y="-17.9%" filterUnits="objectBoundingBox"><feOffset dy="1" in="SourceAlpha" result="shadowOffsetOuter1"/><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0" in="shadowBlurOuter1"/></filter></defs><g fill="none" fill-rule="evenodd" transform="translate(4 4)"><use fill="#000" filter="url(#2ccc4e9f8fe2f8acc9e7eab53f797f56__a)" xlink:href="#2ccc4e9f8fe2f8acc9e7eab53f797f56__b"/><use fill="#FFF" xlink:href="#2ccc4e9f8fe2f8acc9e7eab53f797f56__b"/><path d="M7 12A5 5 0 1 1 7 2a5 5 0 0 1 0 10z" fill="currentColor"/><path fill="#000" class="tint" d="M7 12A5 5 0 1 1 7 2a5 5 0 0 1 0 10z"/></g></svg>\n',width:22,height:22},base:{source:'<svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 34 34" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="cbb016882db5c851af06eebb43c674f7__b" d="M17 31c7.732 0 14-6.268 14-14S24.732 3 17 3 3 9.268 3 17s6.268 14 14 14z"/><filter id="cbb016882db5c851af06eebb43c674f7__a" width="200%" height="200%" x="-50%" y="-50%" filterUnits="objectBoundingBox"><feOffset dy="1" in="SourceAlpha" result="shadowOffsetOuter1"/><feGaussianBlur stdDeviation="1" in="shadowOffsetOuter1" result="shadowBlurOuter1"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.200000003 0" in="shadowBlurOuter1"/></filter></defs><g fill="none" fill-rule="evenodd"><use fill="#000" filter="url(#cbb016882db5c851af06eebb43c674f7__a)" xlink:href="#cbb016882db5c851af06eebb43c674f7__b"/><use fill="#FFF" xlink:href="#cbb016882db5c851af06eebb43c674f7__b"/><path fill="currentColor" d="M17 29c-6.627 0-12-5.373-12-12S10.373 5 17 5s12 5.373 12 12-5.373 12-12 12z"/><path fill="#000" class="tint" d="M17 29c-6.627 0-12-5.373-12-12S10.373 5 17 5s12 5.373 12 12-5.373 12-12 12z"/></g></svg>\n',width:34,height:34},active:{source:'<svg width="60" height="68" viewBox="0 0 60 68" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M23.51 51.523a.5.5 0 0 1-.5.477c-.29 0-.51-.21-.52-.477-.145-3.168-1.756-5.217-4.832-6.147C7.53 42.968 0 33.863 0 23 0 10.297 10.297 0 23 0s23 10.297 23 23c0 10.863-7.53 19.968-17.658 22.376-3.076.93-4.687 2.98-4.83 6.147z" id="ae96eeecd750ec2a83543f00c9bc789d__b"/><filter x="-21.7%" y="-15.4%" width="143.5%" height="138.5%" filterUnits="objectBoundingBox" id="ae96eeecd750ec2a83543f00c9bc789d__a"><feGaussianBlur in="SourceGraphic" stdDeviation="3"/><feOffset dy="2"/><feComponentTransfer><feFuncA type="linear" slope=".3"/></feComponentTransfer></filter></defs><g fill="none" fill-rule="evenodd"><g fill-rule="nonzero" transform="translate(7 5)" fill="currentColor"><use filter="url(#ae96eeecd750ec2a83543f00c9bc789d__a)" xlink:href="#ae96eeecd750ec2a83543f00c9bc789d__b"/><use xlink:href="#ae96eeecd750ec2a83543f00c9bc789d__b"/></g><path d="M30 68c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z" fill="#fff" fill-rule="nonzero"/><path d="M30 66a2 2 0 1 0 .001-3.999A2 2 0 0 0 30 66z" fill="currentColor"/></g></svg>',className:M("active"),width:60,height:68,baseY:64,centerY:28}};function x(e){return T[e]}function L(e){var t=e.iconSource,n=e.contentPromise,o=e.config;return(0,r.Z)({},N(t),{promise:n?n.then((function(e){return D({iconSource:t,content:e,config:o})})):Promise.resolve(D({iconSource:t,config:o}))})}function D(e){var t=e.iconSource,n=e.content,o=e.config,i=N(t),s=i.width,c=i.height,l=i.centerX,u=i.centerY,d={className:t.className,dangerouslySetInnerHTML:{__html:t.source}};return n?a.createElement("div",{style:{position:"relative",width:s,height:c}},a.createElement("div",(0,r.Z)({},d)),a.createElement("div",{style:(0,I.cq)({isRtl:o.isRtl},{position:"absolute",left:l,top:u})},"point"===n?a.createElement("div",{className:M("content")}):n)):a.createElement("div",(0,r.Z)({style:{width:s,height:c}},d))}function N(e){var t=Math.round(e.width/2),n=Math.round(e.height/2);return{width:e.width,height:e.height,baseX:e.baseX||t,baseY:e.baseY||n,centerX:e.centerX||t,centerY:e.centerY||n}}var A=(0,c.Z)("rubric-placemark-icons-provider"),z={geoproduct:{source:'<svg fill="none" height="40" width="34" xmlns="http://www.w3.org/2000/svg"><filter id="24609e80b326bd45d5a64be8fc7ffd36__a" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse" height="38" width="32" x="1" y="2"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="1"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"/></filter><g filter="url(#24609e80b326bd45d5a64be8fc7ffd36__a)"><path fill="#000" d="M3 17C3 9.266 9.267 3 17 3c7.732 0 14 6.268 14 14 0 5.082-2.014 8.247-6.235 11.76-.295.245-1.696 1.382-2.054 1.684-1.852 1.56-2.6 2.572-2.721 3.757l-.012.109a2.995 2.995 0 0 1-5.959-.018l-.01-.106c-.112-1.185-.857-2.196-2.71-3.755-.361-.304-1.77-1.446-2.065-1.691C5.014 25.234 3 22.073 3 17z"/></g><path fill="#fff" d="M3 17C3 9.266 9.267 3 17 3c7.732 0 14 6.268 14 14 0 5.082-2.014 8.247-6.235 11.76-.295.245-1.696 1.382-2.054 1.684-1.852 1.56-2.6 2.572-2.721 3.757l-.012.109a2.995 2.995 0 0 1-5.959-.018l-.01-.106c-.112-1.185-.857-2.196-2.71-3.755-.361-.304-1.77-1.446-2.065-1.691C5.014 25.234 3 22.073 3 17z"/><path fill="currentColor" d="M5 17c0 10 10.436 11.04 11 16.997l.01.104a.993.993 0 0 0 1.979.005l.011-.11C18.609 28.053 29 27 29 17c0-6.627-5.373-12-12-12S5 10.37 5 17z"/><path fill="#000" class="tint" d="M5 17c0 10 10.436 11.04 11 16.997l.01.104a.993.993 0 0 0 1.979.005l.011-.11C18.609 28.053 29 27 29 17c0-6.627-5.373-12-12-12S5 10.37 5 17z"/></svg>',width:34,height:40,centerY:17,baseY:38},"low-relevance":{source:'<svg width="28" height="34" viewBox="0 0 28 34" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.2247 28.9111C12.133 27.9459 11.6447 27.1349 10.8253 26.292C10.2356 25.6855 9.54841 25.1305 8.78321 24.5125C8.44143 24.2365 8.08408 23.9479 7.71292 23.6366C5.37129 21.6722 2.89999 19.1042 2.89999 14.4658C2.89999 8.35203 7.86976 3.39999 14 3.39999C20.1304 3.39999 25.1 8.35434 25.1 14.4658C25.1 19.1025 22.6402 21.6727 20.3021 23.6393C19.9262 23.9555 19.5645 24.2481 19.2186 24.5279C18.46 25.1415 17.7778 25.6935 17.1898 26.2968C16.3675 27.1407 15.8737 27.9527 15.7745 28.9181L15.765 29.0107C15.7161 29.4865 15.4554 29.874 15.1734 30.1276C14.8914 30.3813 14.4782 30.6 13.9988 30.6C13.0882 30.6 12.3249 29.9125 12.2344 29.008L12.2247 28.9111Z" fill="white" fill-opacity="0.6"/><path d="M4.00143 14.5004C4.00143 8.97615 8.47795 4.50179 14 4.50179C19.5221 4.50179 23.9986 8.9783 23.9986 14.5004C23.9986 22.8325 15.3405 23.7089 14.8332 28.6624C14.83 28.694 14.8269 28.7245 14.8239 28.7537C14.785 29.1334 14.3805 29.4982 13.9989 29.4982C13.5738 29.4982 13.218 29.1765 13.1759 28.7535C13.173 28.7243 13.1699 28.694 13.1668 28.6624C12.6965 23.6996 4.00143 22.8325 4.00143 14.5004Z" fill="currentColor"/></svg>\n',width:28,height:34,baseY:32,centerX:14,centerY:15},card:{source:'<svg width="28" height="32" viewBox="0 0 28 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 14c0 5.508 3.18 10.273 7.805 12.558 3.026 1.573 4.847 3.215 5.463 4.928a.778.778 0 0 0 1.464 0c.616-1.713 2.437-3.355 5.463-4.928C24.819 24.273 28 19.508 28 14c0-7.732-6.268-14-14-14S0 6.268 0 14z" fill="currentColor"/></svg>',width:34,height:40,baseY:38,centerX:14,centerY:14}},U={};function O(e){var t=e.mode,n=e.iconsPromise,r=e.pinType,o=e.config;return{default:L({iconSource:"base"===t&&r&&z[r]||x(t),contentPromise:n.then((function(e){return a.createElement("div",{className:A(t+"-content",{"pin-type":r}),dangerouslySetInnerHTML:{__html:e[t]}})})),config:o})}}const F={get:function(e,t,n){var r=function(e,t){if(!U[e]){var n=["small","normal"].map((function(n){return k.Gr({type:"rubrics",name:e,size:n},t)||""})).map((function(e){return e?(0,P.Z)({url:e,parser:"string"}):Promise.resolve("")}));U[e]=Promise.all(n).then((function(e){return{base:e[0],active:e[1]}}))}return U[e]}(e,t);return{base:O({mode:"base",iconsPromise:r,pinType:n,config:t}),active:O({mode:"active",iconsPromise:r,config:t})}}};var B={dot:{width:18,height:18},base:{width:34,height:40,baseY:36},active:{width:60,height:68,baseY:64,centerY:28}},H={get:function(e,t){return Object.entries(e).reduce((function(e,n){var o,i=n[0],a=n[1];return(0,r.Z)({},e,((o={})[i]=Object.entries(a||{}).reduce((function(e,n){var o,a=n[0],s=n[1];return(0,r.Z)({},e,((o={})[a]=L({iconSource:(0,r.Z)({source:q(s,i)},B[i],"base"===i&&t.experiments.ui.searchPinsMagicContent?{centerY:16}:{}),config:t}),o))}),{}),o))}),{})}};function q(e,t){e.startsWith("https://")||(e="https://avatars.mds.yandex.net/get-{id}_%s".replace("{id}",e.replace(/--/g,"/")));var n=Math.max(2,Math.ceil(window.devicePixelRatio||1)),r=e.replace("%s","x"+n);return'<img height="'+B[t].height+'" width="'+B[t].width+'" src="'+r+'" />'}const G=H;var W={width:60,height:68,baseY:64,centerY:28},j={transit:26};function V(e){var t=e.iconUrl,n=e.meta,o=e.config,i='<div class="poi-icon-provider" style="'+("width: "+n.width+"px; height: "+n.height+"px;background: url("+t+") 50% bottom no-repeat; background-size: contain")+'" />';return{default:L({iconSource:(0,r.Z)({source:i},n),config:o})}}const Y={get:function(e){var t=e.iconUrl,n=e.tags,o=e.config,i=(n||[]).find((function(e){return Object.keys(j).includes(e)}));return{active:V({iconUrl:t,meta:(0,r.Z)({},W,{centerY:i&&j[i]||W.centerY}),config:o})}}};var K=n(1881),$=n(6897),X=n(6786);n(8956),n(2824);function Q(e,t){return"children"in t?t.children.map((function(t){return Q(e,t)})).find(Boolean)||null:e(t)?t:null}function J(e,t){return function(e,t){return Q((function(t){return t.uri===e}),t)}(X.fS(e),t)||function(e,t){return Q((function(t){var n=X.BW(t.uri);return X.l4(t.uri)&&null!==n&&(0,$.J)(n,e.coordinates)}),t)}({coordinates:e.displayCoordinates},t)}var ee={};function te(e){var t,n,o,i,c,l,u,d="shortTitle"in e.result&&e.result.shortTitle||e.result.title||"",p="modularPin"in e.result?null===(t=e.result.modularPin)||void 0===t?void 0:t.subtitleHints:void 0,m="hover"===e.state;if(e.hideTitle||!d||["dot","base"].includes(e.mode)&&!m)return Promise.resolve(void 0);e.rootFolder&&s.yD(e.result)&&(l=null===(u=J(e.result,e.rootFolder))||void 0===u?void 0:u.title);var f="lowRelevance"in e.result,v="business"===e.result.type&&!e.config.experiments.ui.disableSearchResultsPreview,g={title:null!==(n=l)&&void 0!==n?n:d,subtitleHints:p,showSubtitle:["active","subtitle"].includes(e.mode)||m&&!v,background:"active"!==e.mode,isLowRelevance:f,disableTruncate:!0,multilineSubtitle:"modularPin"in e.result?null===(o=e.result.modularPin)||void 0===o?void 0:o.allowMultilineSubtitle:void 0},_={title:null!==(i=l)&&void 0!==i?i:d,showSubtitle:["active","subtitle"].includes(e.mode),showIsland:"active"!==e.mode,showTitle:"island"!==e.mode,position:e.titlePosition||"right"},b=f&&"business"===e.result.type&&(null===(c=e.result.businessProperties)||void 0===c?void 0:c.geoproduct_poi_label_color)||void 0,w=e.titlePosition||"right",S=f&&!["dot","active"].includes(e.mode)&&e.config.isVectorEnabled?a.createElement(E,{title:g.title,color:b,hover:"hover"===e.state}):e.config.experiments.ui.searchPinsMagicContent?a.createElement(y,(0,r.Z)({},_,{result:e.result})):a.createElement(h,(0,r.Z)({},g,{position:w})),C=JSON.stringify(g).concat(e.config.experiments.ui.searchPinsMagicContent?JSON.stringify(_):"");return ee[C]=ee[C]||(0,K.Z)((function(){return S}),e.config),ee[C].then((function(e){return(0,r.Z)({},e,{element:S,position:w})}))}function ne(e){var t=e.state||"default",n=["island","title","subtitle"].includes(e.mode)?"base":e.mode,o=function(e){var t,n=e.result,r=s.Ye(n),o="flyover"in n&&(null===(t=n.flyover)||void 0===t?void 0:t.selectedIconUrl);if(o)return Y.get({iconUrl:o,config:e.config});if("lowRelevance"in n)return F.get(r||"",e.config,"low-relevance");if("business"===n.type&&!n.direct&&n.advert&&n.advert.pinBranding&&"neuro-chat"!==e.groupMode)return G.get(n.advert.pinBranding,e.config);if("hotspotProperties"in n&&n.hotspotProperties&&n.hotspotProperties.selectedIconUrl)return Y.get({iconUrl:n.hotspotProperties.selectedIconUrl,tags:n.hotspotProperties.tags,config:e.config});if(r){var i,a=(null!==(i=e.style)&&void 0!==i&&i.forceGeoproduct||s.xi(n))&&"default"===(e.groupMode||"default")?"geoproduct":"default";return F.get(r,e.config,a)}return}(e),i=null==o?void 0:o[n],c=(null==i?void 0:i[t])||(null==i?void 0:i.default)||L({iconSource:x(n),contentPromise:Promise.resolve("dot"!==n?"point":void 0),config:e.config});return(0,r.Z)({},c,{element:a.createElement(R,{result:e.result,state:t,icon:c,groupMode:e.groupMode,mode:n,config:e.config,style:e.style})})}var re=n(8037),oe=n(6667),ie=n(8033),ae=function(e){function t(t){var n;return(n=e.call(this,t)||this)._calcPlacemarkAction=void 0,n._calcPlacemark=function(e){oe.Z.cancel(n._calcPlacemarkAction);var t=n.state.hover?"hover":"default",r=e.result,o=e.mode,i=e.config;n._calcPlacemarkAction=oe.Z.create(function(e){return Promise.all([ne(e),te(e)]).then((function(e){return{icon:e[0],title:e[1]}}))}({result:r,mode:o,state:t,config:i}),{success:function(e){return n.setState({placemark:e})}})},n._onMouseEnter=function(){var e=(0,o.Z)(n).props;n.setState({hover:!0},(function(){return n._calcPlacemark(e)}))},n._onMouseLeave=function(){var e=(0,o.Z)(n).props;n.setState({hover:!1},(function(){return n._calcPlacemark(e)}))},n.state={hover:!1},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._calcPlacemark(this.props)},n.componentDidUpdate=function(e){e!==this.props&&this._calcPlacemark(this.props)},n.componentWillUnmount=function(){oe.Z.cancel(this._calcPlacemarkAction)},n.render=function(){var e=this.state.placemark;if(!e)return null;var t=this.props,n=t.result,o=ie.I.search[t.mode];return a.createElement(re.Z,(0,r.Z)({coordinates:t.coordinates,result:n},e,{analyticsName:t.analyticsName,zIndex:this.state.hover?o+1:o,onClick:t.onClick,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave}))},t}(a.Component);const se=(0,l.ZP)(ae)},8769:(e,t,n)=>{"use strict";n.d(t,{ZU:()=>a,t0:()=>s});var r=7,o=4,i={closed:"Перекрытие движения",drawbridge:"Развод моста",reconstruction:"Дорожные работы",accident:"ДТП",police:"Камера",other:"Прочее",chat:"Прочее",danger:"Опасный участок"};function a(e){return e||0===e?e>=r?"red":e>=o?"yellow":"green":"gray"}function s(e){return e&&i[e]||i.other}},7047:(e,t,n)=>{"use strict";n.d(t,{Qg:()=>r});n(8810);function r(e,t){return e.uatraits.isMobile?"maps-touch-"+("iOS"===e.uatraits.OSFamily?"ios":"android")+"-"+t:"maps-desktop-"+t}},8285:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});var r={tabIndex:-1,"aria-hidden":!0}},30:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n(7462),o=n(3243);const i=(0,n(1851).Z)(Object.getPrototypeOf,Object);var a=n(8533),s=Function.prototype,c=Object.prototype,l=s.toString,u=c.hasOwnProperty,d=l.call(Object);const p=function(e){if(!(0,a.Z)(e)||"[object Object]"!=(0,o.Z)(e))return!1;var t=i(e);if(null===t)return!0;var n=u.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==d};const m=function e(t,n){var o=(0,r.Z)({},t);return Object.entries(n).forEach((function(t){var n=t[0],r=t[1];o.hasOwnProperty(n)&&p(r)?o[n]=e(o[n],r):o[n]=r})),o}},5311:(e,t,n)=>{"use strict";n.d(t,{sb:()=>r,G7:()=>o});var r=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];function o(e,t){return{sunday:"Воскресенье",monday:"Понедельник",tuesday:"Вторник",wednesday:"Среда",thursday:"Четверг",friday:"Пятница",saturday:"Суббота"}[t]}},7937:(e,t,n)=>{"use strict";n.d(t,{Bb:()=>r,Lr:()=>a,jq:()=>o});function r(e){return e>900?{distance:a(e/1e3,2)}.distance+" км":function(e){return e.distance+" м"}({distance:a(e,2)})}function o(e,t){var n="quadratic"===t?1e3:1;return e>900*n?{distance:i(s(e/(1e3*n)))}.distance+" км":function(e){return e.distance+" м"}({distance:i(s(e))})}function i(e){return e.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1 ")}function a(e,t){if(void 0===t&&(t=1/0),t<1)throw new Error("Can't round to significance of "+t+".");var n=Math.round(e).toString(),r=Math.max(0,n.length-t),o=Math.round(e/Math.pow(10,r));return Number(o+new Array(r).fill("0").join(""))}function s(e){if(e>100)return Math.round(e);var t=Math.pow(10,e>10?1:2);return Math.round(e*t)/t}},8657:(e,t,n)=>{"use strict";n.d(t,{D$:()=>c});var r={max:2};function o(e){return function(t,n){return function(e,t,n){void 0===n&&(n=r),"number"==typeof n.max&&(e=Math.round(e*Math.pow(10,n.max))/Math.pow(10,n.max));var o=e.toString().split("."),i=o[0],a=o[1],s=void 0===a?"":a;t.thousands&&(i=i.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+t.thousands)),"number"==typeof n.max&&(s=s.slice(0,n.max)),"number"==typeof n.min&&s.length<n.min&&(s+="0".repeat(n.min-s.length));var c=[i,s].filter(Boolean).join(t.decimal);return!s&&n.forceDecimal?c+n.forceDecimal:c}(t,e,n)}}var i={ru:"ru",en:"en",uk:"ru",tr:"tr",uz:"ru",kk:"ru",az:"ru",ar:"en","sr-Latn":"tr"},a={ru:{decimal:",",thousands:" "},en:{decimal:".",thousands:","},tr:{decimal:",",thousands:"."}};var s=Object.keys(i).reduce((function(e,t){return e[t]=o(function(e){return a[i[e]]}(t)),e}),{});function c(e,t,n){return s[t](e,n)}var l={RUB:!0,EUR:!0,USD:!0,GBP:!0,BYN:!0,UAH:!0,KZT:!0,AED:!0,AMD:!0,AZN:!0,GEL:!0,GHC:!0,GHS:!0,ILS:!0,XOF:!0,KGS:!0,LVL:!0,LTL:!0,MDL:!0,RON:!0,RSD:!0,UZS:!0},u={RUB:"₽",EUR:"€",USD:"$",GBP:"£",UAH:"грн.",ILS:"₪",KZT:"₸"},d=(Object.entries(u).reduce((function(e,t){var n=t[0],r=t[1];return r&&(e[r]=n),e}),{}),{XOF:"CFA"});function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object.keys(l).reduce((function(e,n){var r=t.includes(n)&&u[n];return e[n]={isSymbol:Boolean(r),value:r||d[n]||n},e}),{})}var m=p("RUB","EUR","USD","GBP","UAH","ILS","KZT"),f=p("UAH"),v=p("EUR","USD","GBP","ILS","RSD"),h=p("EUR","USD","GBP","ILS","AED"),g=function(e,t,n){return""+e+n+" "+t.value},y=function(e,t,n){return t.value+(t.isSymbol?"":" ")+n+e};function _(e,t){return function(n,r,o){return e(n,t[r],o)}}_(g,m),_(g,f),_(y,h),_(y,v)},2327:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});var r={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,A:65,D:68,P:80,S:83,W:87}},6204:(e,t,n)=>{"use strict";n.d(t,{cq:()=>a});var r={paddingLeft:"paddingRight",paddingRight:"paddingLeft",marginLeft:"marginRight",marginRight:"marginLeft",left:"right",right:"left",borderLeft:"borderRight",borderRight:"borderLeft"},o={padding:function(e){return i({isRtl:!0},e)},margin:function(e){return i({isRtl:!0},e)}};function i(e,t){return e.isRtl?[t[0],t[3],t[1],t[2]]:t}function a(e,t){return e.isRtl?Object.entries(t).reduce((function(e,t){var n=t[0],i=t[1];return o[n]?e[n]=o[n](i):e[r[n]||n]=i,e}),{}):t}},7439:(e,t,n)=>{"use strict";function r(e){var t;return e.uatraits.isMobile&&(null===(t=e.query.source)||void 0===t?void 0:t.includes("wizbiz_new_map"))}n.d(t,{d:()=>r})},8033:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});var r={screenshotDialog:99999,clipboard:99999,ruler:8030,editing:8030,hover:8020,active:8e3,search:{active:8e3,subtitle:7500,title:7e3,island:6750,base:6500,dot:6e3},advert:5e3,dialog:2e3,usermaps:{placemark:3e3,line:2e3,polygon:1e3},discovery:580,routes:550,routePins:{waypoint:8e3,masstransit:7900},masstransitStop:8001,moving:500,masstransitLineStop:510,home:451,work:450,default:400,tooltip:352,masstransitRegion:350,bookmarks:300,minimum:1}},4123:(e,t,n)=>{e.exports=n.p+"_/fd161c881e6392111418a1036fe1188e.svg"},2606:(e,t,n)=>{e.exports=n.p+"_/ebe60c9063e4a91162d1366e790ea391.svg"},4373:(e,t,n)=>{e.exports=n.p+"_/7f78fe3f36223c298be58eb812e95646.svg"},7022:(e,t,n)=>{e.exports=n.p+"_/5cf17060c6672d32fb90b652cc8d17f0.svg"},5119:(e,t,n)=>{e.exports=n.p+"_/2e1750eb108b5881e5577c7e08041e3f.svg"},8286:(e,t,n)=>{e.exports=n.p+"_/7485047d3440076f2f17ebb52a011c9c.png"},5111:(e,t,n)=>{e.exports=n.p+"_/af158d44913f89ba43eabd0e26e9dda3.png"},9500:(e,t,n)=>{e.exports=n.p+"_/9dae14af44a24ba50a1bf841f2d22144.png"},5551:(e,t,n)=>{e.exports=n.p+"_/af158d44913f89ba43eabd0e26e9dda3.png"},8755:(e,t,n)=>{e.exports=n.p+"_/9c80a04cdee2564f1b348f2c942570e5.png"},6057:(e,t,n)=>{e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},6176:(e,t,n)=>{e.exports=n.p+"_/db96e0b37fb683edb082b6d22cd47375.png"},8776:(e,t,n)=>{e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},2621:(e,t,n)=>{e.exports=n.p+"_/9d7d9192162a766707427f0fdfad6e69.png"},8704:(e,t,n)=>{e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},264:(e,t,n)=>{e.exports=n.p+"_/30566ea95b3b85e11fdf731ad19d0cb6.png"},728:(e,t,n)=>{e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},4609:(e,t,n)=>{e.exports=n.p+"_/00dbdb577dd780ef99cebd89eabff5b0.png"},1512:(e,t,n)=>{e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},211:(e,t,n)=>{e.exports=n.p+"_/6b36feaa685efb371af0a08ebce07269.png"},2501:(e,t,n)=>{e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},5642:(e,t,n)=>{e.exports=n.p+"_/74ca6ea4b76200fd171c44aa5a49f5a8.png"},9627:(e,t,n)=>{e.exports=n.p+"_/d3d3e5e71c45bd5a155c12a2f093120e.png"},7204:(e,t,n)=>{e.exports=n.p+"_/4107b60439ecfb91bb4f01454bb365e2.png"},5055:(e,t,n)=>{e.exports=n.p+"_/dff25d38edaaaed43455e2838501c7d2.png"},561:(e,t,n)=>{e.exports=n.p+"_/d7eede432ce185c2bcdea2a81dd73d60.svg"},3331:(e,t,n)=>{e.exports=n.p+"_/982f21b161efbb26f879ac8dcf5bc613.svg"},251:(e,t,n)=>{e.exports=n.p+"_/88dd6621d29f63b3bcd11823a075bab8.svg"},4050:(e,t,n)=>{e.exports=n.p+"_/6dfdf3e1f699e358e2a45696b5910bfc.svg"},5097:(e,t,n)=>{e.exports=n.p+"_/f869888cf7cada800b61fc42b9a84b32.svg"},1791:(e,t,n)=>{e.exports=n.p+"_/2288e6eacf3c5cc628de46cd146ffc9d.svg"},3988:()=>{},1784:()=>{},8216:(e,t,n)=>{"use strict";n.d(t,{$j:()=>q,I0:()=>Y});var r=n(7363),o=n.n(r),i=o().createContext(null);var a=function(e){e()},s=function(){return a};var c={notify:function(){},get:function(){return[]}};function l(e,t){var n,r=c;function o(){a.onStateChange&&a.onStateChange()}function i(){n||(n=t?t.addNestedSub(o):e.subscribe(o),r=function(){var e=s(),t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,o=n={callback:e,next:null,prev:n};return o.prev?o.prev.next=o:t=o,function(){r&&null!==t&&(r=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:t=o.next)}}}}())}var a={addNestedSub:function(e){return i(),r.subscribe(e)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:o,isSubscribed:function(){return Boolean(n)},trySubscribe:i,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=c)},getListeners:function(){return r}};return a}var u="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect;var d=n(7462),p=n(3366),m=n(8679),f=n.n(m),v=n(2973),h=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],g=["reactReduxForwardedRef"],y=[],_=[null,null];function b(e,t){var n=e[1];return[t.payload,n+1]}function E(e,t,n){u((function(){return e.apply(void 0,t)}),n)}function w(e,t,n,r,o,i,a){e.current=r,t.current=o,n.current=!1,i.current&&(i.current=null,a())}function S(e,t,n,r,o,i,a,s,c,l){if(e){var u=!1,d=null,p=function(){if(!u){var e,n,p=t.getState();try{e=r(p,o.current)}catch(m){n=m,d=m}n||(d=null),e===i.current?a.current||c():(i.current=e,s.current=e,a.current=!0,l({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=p,n.trySubscribe(),p();return function(){if(u=!0,n.tryUnsubscribe(),n.onStateChange=null,d)throw d}}}var C=function(){return[null,0]};function Z(e,t){void 0===t&&(t={});var n=t,a=n.getDisplayName,s=void 0===a?function(e){return"ConnectAdvanced("+e+")"}:a,c=n.methodName,u=void 0===c?"connectAdvanced":c,m=n.renderCountProp,Z=void 0===m?void 0:m,R=n.shouldHandleStateChanges,P=void 0===R||R,k=n.storeKey,I=void 0===k?"store":k,M=(n.withRef,n.forwardRef),T=void 0!==M&&M,x=n.context,L=void 0===x?i:x,D=(0,p.Z)(n,h),N=L;return function(t){var n=t.displayName||t.name||"Component",i=s(n),a=(0,d.Z)({},D,{getDisplayName:s,methodName:u,renderCountProp:Z,shouldHandleStateChanges:P,storeKey:I,displayName:i,wrappedComponentName:n,WrappedComponent:t}),c=D.pure;var m=c?r.useMemo:function(e){return e()};function h(n){var i=(0,r.useMemo)((function(){var e=n.reactReduxForwardedRef,t=(0,p.Z)(n,g);return[n.context,e,t]}),[n]),s=i[0],c=i[1],u=i[2],f=(0,r.useMemo)((function(){return s&&s.Consumer&&(0,v.isContextConsumer)(o().createElement(s.Consumer,null))?s:N}),[s,N]),h=(0,r.useContext)(f),Z=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(h)&&Boolean(h.store);var R=Z?n.store:h.store,k=(0,r.useMemo)((function(){return function(t){return e(t.dispatch,a)}(R)}),[R]),I=(0,r.useMemo)((function(){if(!P)return _;var e=l(R,Z?null:h.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[R,Z,h]),M=I[0],T=I[1],x=(0,r.useMemo)((function(){return Z?h:(0,d.Z)({},h,{subscription:M})}),[Z,h,M]),L=(0,r.useReducer)(b,y,C),D=L[0][0],A=L[1];if(D&&D.error)throw D.error;var z=(0,r.useRef)(),U=(0,r.useRef)(u),O=(0,r.useRef)(),F=(0,r.useRef)(!1),B=m((function(){return O.current&&u===U.current?O.current:k(R.getState(),u)}),[R,D,u]);E(w,[U,z,F,u,B,O,T]),E(S,[P,R,M,k,U,z,F,O,T,A],[R,M,k]);var H=(0,r.useMemo)((function(){return o().createElement(t,(0,d.Z)({},B,{ref:c}))}),[c,t,B]);return(0,r.useMemo)((function(){return P?o().createElement(f.Provider,{value:x},H):H}),[f,H,x])}var R=c?o().memo(h):h;if(R.WrappedComponent=t,R.displayName=h.displayName=i,T){var k=o().forwardRef((function(e,t){return o().createElement(R,(0,d.Z)({},e,{reactReduxForwardedRef:t}))}));return k.displayName=i,k.WrappedComponent=t,f()(k,t)}return f()(R,t)}}function R(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function P(e,t){if(R(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!Object.prototype.hasOwnProperty.call(t,n[o])||!R(e[n[o]],t[n[o]]))return!1;return!0}function k(e){return function(t,n){var r=e(t,n);function o(){return r}return o.dependsOnOwnProps=!1,o}}function I(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function M(e,t){return function(t,n){n.displayName;var r=function(e,t){return r.dependsOnOwnProps?r.mapToProps(e,t):r.mapToProps(e)};return r.dependsOnOwnProps=!0,r.mapToProps=function(t,n){r.mapToProps=e,r.dependsOnOwnProps=I(e);var o=r(t,n);return"function"==typeof o&&(r.mapToProps=o,r.dependsOnOwnProps=I(o),o=r(t,n)),o},r}}const T=[function(e){return"function"==typeof e?M(e):void 0},function(e){return e?void 0:k((function(e){return{dispatch:e}}))},function(e){return e&&"object"==typeof e?k((function(t){return function(e,t){var n={},r=function(r){var o=e[r];"function"==typeof o&&(n[r]=function(){return t(o.apply(void 0,arguments))})};for(var o in e)r(o);return n}(e,t)})):void 0}];const x=[function(e){return"function"==typeof e?M(e):void 0},function(e){return e?void 0:k((function(){return{}}))}];function L(e,t,n){return(0,d.Z)({},n,e,t)}const D=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var r,o=n.pure,i=n.areMergedPropsEqual,a=!1;return function(t,n,s){var c=e(t,n,s);return a?o&&i(c,r)||(r=c):(a=!0,r=c),r}}}(e):void 0},function(e){return e?void 0:function(){return L}}];var N=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function A(e,t,n,r){return function(o,i){return n(e(o,i),t(r,i),i)}}function z(e,t,n,r,o){var i,a,s,c,l,u=o.areStatesEqual,d=o.areOwnPropsEqual,p=o.areStatePropsEqual,m=!1;function f(o,m){var f,v,h=!d(m,a),g=!u(o,i);return i=o,a=m,h&&g?(s=e(i,a),t.dependsOnOwnProps&&(c=t(r,a)),l=n(s,c,a)):h?(e.dependsOnOwnProps&&(s=e(i,a)),t.dependsOnOwnProps&&(c=t(r,a)),l=n(s,c,a)):g?(f=e(i,a),v=!p(f,s),s=f,v&&(l=n(s,c,a)),l):l}return function(o,u){return m?f(o,u):(s=e(i=o,a=u),c=t(r,a),l=n(s,c,a),m=!0,l)}}function U(e,t){var n=t.initMapStateToProps,r=t.initMapDispatchToProps,o=t.initMergeProps,i=(0,p.Z)(t,N),a=n(e,i),s=r(e,i),c=o(e,i);return(i.pure?z:A)(a,s,c,e,i)}var O=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function F(e,t,n){for(var r=t.length-1;r>=0;r--){var o=t[r](e);if(o)return o}return function(t,r){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function B(e,t){return e===t}function H(e){var t=void 0===e?{}:e,n=t.connectHOC,r=void 0===n?Z:n,o=t.mapStateToPropsFactories,i=void 0===o?x:o,a=t.mapDispatchToPropsFactories,s=void 0===a?T:a,c=t.mergePropsFactories,l=void 0===c?D:c,u=t.selectorFactory,m=void 0===u?U:u;return function(e,t,n,o){void 0===o&&(o={});var a=o,c=a.pure,u=void 0===c||c,f=a.areStatesEqual,v=void 0===f?B:f,h=a.areOwnPropsEqual,g=void 0===h?P:h,y=a.areStatePropsEqual,_=void 0===y?P:y,b=a.areMergedPropsEqual,E=void 0===b?P:b,w=(0,p.Z)(a,O),S=F(e,i,"mapStateToProps"),C=F(t,s,"mapDispatchToProps"),Z=F(n,l,"mergeProps");return r(m,(0,d.Z)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:S,initMapDispatchToProps:C,initMergeProps:Z,pure:u,areStatesEqual:v,areOwnPropsEqual:g,areStatePropsEqual:_,areMergedPropsEqual:E},w))}}const q=H();function G(){return(0,r.useContext)(i)}function W(e){void 0===e&&(e=i);var t=e===i?G:function(){return(0,r.useContext)(e)};return function(){return t().store}}var j=W();function V(e){void 0===e&&(e=i);var t=e===i?j:W(e);return function(){return t().dispatch}}var Y=V();var K,$=n(1533);K=$.unstable_batchedUpdates,a=K},8359:(e,t)=>{"use strict";var n=60103,r=60106,o=60107,i=60108,a=60114,s=60109,c=60110,l=60112,u=60113,d=60120,p=60115,m=60116,f=60121,v=60122,h=60117,g=60129,y=60131;if("function"==typeof Symbol&&Symbol.for){var _=Symbol.for;n=_("react.element"),r=_("react.portal"),o=_("react.fragment"),i=_("react.strict_mode"),a=_("react.profiler"),s=_("react.provider"),c=_("react.context"),l=_("react.forward_ref"),u=_("react.suspense"),d=_("react.suspense_list"),p=_("react.memo"),m=_("react.lazy"),f=_("react.block"),v=_("react.server.block"),h=_("react.fundamental"),g=_("react.debug_trace_mode"),y=_("react.legacy_hidden")}function b(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case o:case a:case i:case u:case d:return e;default:switch(e=e&&e.$$typeof){case c:case l:case m:case p:case s:return e;default:return t}}case r:return t}}}t.isContextConsumer=function(e){return b(e)===c}},2973:(e,t,n)=>{"use strict";e.exports=n(8359)},267:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.create;Object.create;var o=n(7363);function i(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={loading:!1});var i,a,s=(0,o.useRef)(0),c=(i=(0,o.useRef)(!1),a=(0,o.useCallback)((function(){return i.current}),[]),(0,o.useEffect)((function(){return i.current=!0,function(){i.current=!1}}),[]),a),l=(0,o.useState)(n),u=l[0],d=l[1],p=(0,o.useCallback)((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=++s.current;return d((function(e){return r(r({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return c()&&o===s.current&&d({value:e,loading:!1}),e}),(function(e){return c()&&o===s.current&&d({error:e,loading:!1}),e}))}),t);return[u,p]}},6955:(e,t,n)=>{"use strict";n.d(t,{SF:()=>o,Sv:()=>i,zw:()=>a,wo:()=>s});var r=n(1372),o=256,i=130,a=32,s=function(e){if("tile"===e.type){var t=(0,r.pi)({},e);return e.raster&&(t.raster=(0,r.pi)({},e.raster)),e.vector&&(t.vector=(0,r.pi)({},e.vector)),t}return(0,r.pi)({},e)}},3740:(e,t,n)=>{"use strict";n.d(t,{c2:()=>i,FA:()=>a,fd:()=>s,il:()=>c});var r=n(3080),o=(0,r.Symbol)("EventEmitter"),i=(0,r.Symbol)("EventEmitter.MixinConstructor"),a=(0,r.Symbol)("EventEmitter.MixinPrototype"),s=function(){function e(){}return e[i]=function(e){e._eventListenersHash={}},e[a]=function(t){t[o]=e.prototype[o],t.group=e.prototype.group,t.on=e.prototype.on,t.offSingle=e.prototype.offSingle,t._emit=e.prototype._emit},e.prototype.on=function(e,t){return this.group().on(e,t)},e.prototype.offSingle=function(e,t){var n=this._eventListenersHash[e];n&&n.delete(t)},e.prototype.group=function(){return new e._eventGroupImpl(this)},e.prototype._emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this._eventListenersHash[e],o=void 0;if(r){var i=[];r.forEach((function(e){return i.push(e)}));for(var a=0,s=i;a<s.length;a++){var c=(0,s[a])(t[0]);void 0!==c&&(o=c)}}return o},e._eventGroupImpl=function(){function e(e){this._listeners=[],this._emitter=e}return e.prototype.on=function(e,t){var n=this._emitter._eventListenersHash[e];return n?n.add(t):(this._emitter._eventListenersHash[e]=new r.Set,this._emitter._eventListenersHash[e].add(t)),this._listeners.push([e,t]),this},e.prototype.offAll=function(){for(var e=0,t=this._listeners;e<t.length;e++){var n=t[e],r=n[0],o=n[1];this._emitter._eventListenersHash[r].delete(o)}this._listeners=[]},e}(),e}();function c(e){return Boolean(e&&e[o])}s.prototype[o]=!0},3537:(e,t,n)=>{"use strict";n.d(t,{GA:()=>a});var r=n(1372),o=n(3740),i=function(){},a=function(e){return void 0===e&&(e=i),{with:function(){if((0,o.il)(e.prototype))return e;var t=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.apply(this,t)||this;return o.fd[o.c2](r),r}return(0,r.ZT)(t,e),t}(e);return o.fd[o.FA](t.prototype),t}}}},284:(e,t,n)=>{"use strict";n.d(t,{Cr:()=>i,ZE:()=>a,$7:()=>s,JO:()=>c});var r=n(1372),o=n(6794);function i(e,t){return(0,r.pi)((0,r.pi)({},e),{geometry:e.geometry&&a(e.geometry,t)})}function a(e,t){switch(e.type){case"Point":return(0,r.pi)((0,r.pi)({},e),{coordinates:t(e.coordinates)});case"LineString":return(0,r.pi)((0,r.pi)({},e),{coordinates:e.coordinates.map(t)});case"MultiLineString":return(0,r.pi)((0,r.pi)({},e),{coordinates:e.coordinates.map((function(e){return e.map(t)}))});case"Polygon":return(0,r.pi)((0,r.pi)({},e),{coordinates:e.coordinates.map((function(e){return e.map(t)}))});case"MultiPolygon":return(0,r.pi)((0,r.pi)({},e),{coordinates:e.coordinates.map((function(e){return e.map((function(e){return e.map(t)}))}))});default:(0,o._y)(new Error("Unexpected geometry type: ".concat(e.type)))}}function s(e){var t;return"FeatureCollection"===e.type?(t=[]).concat.apply(t,e.features.map((function(e){return s(e)}))):[e]}function c(e){"string"!=typeof e.id&&(0,o._y)(new Error("Feature or collection id must be a string"))}},9599:(e,t,n)=>{"use strict";n.d(t,{L:()=>r});var r="hidden"},1480:(e,t,n)=>{"use strict";n.d(t,{XK:()=>l,X_:()=>s,F7:()=>d});var r=n(1372),o=n(6794),i=n(6701),a=n(6585),s="__empty__",c="default";function l(e){var t={id:e.id,grouppedWith:e.grouppedWith,source:e.source?e.source:s,type:e.type?e.type:c,implementation:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(e.implementation){var r=e.implementation.apply(e,t);if(r)return r}return i._.apply(void 0,t)},options:{raster:{},vector:{}}};return function(e,t){var n,r,i,s,c;!t.grouppedWith&&(null===(r=null===(n=e.options)||void 0===n?void 0:n.vector)||void 0===r?void 0:r.parentLayerId)&&(t.grouppedWith=null===(s=null===(i=e.options)||void 0===i?void 0:i.vector)||void 0===s?void 0:s.parentLayerId);var l=null===(c=e.options)||void 0===c?void 0:c.raster;if(!(null==l?void 0:l.implementation))return;e.implementation||(e.implementation=function(){var e=l.implementation;return e.prototype instanceof a.x||(0,o._y)(new Error("Implementation must be derived from CustomDomLayer")),e})}(e,t),e.options&&(e.options.raster&&(t.options.raster=(0,r.pi)({},e.options.raster)),e.options.vector&&(t.options.vector=(0,r.pi)({},e.options.vector))),t}var u=/^(\w+)?(?::(\w+)(?:\((.*)\))?)?$/;function d(e,t){var n=e.match(u);n&&0!==n[0].length||(0,o._y)(new Error("Bad string layer spec '".concat(e,"'")));for(var i=n[1],a=n[2],s=n[3],c=s?s.split(","):[],l=Object.create(null),d=0,p=c;d<p.length;d++){l[p[d]]=!0}return{id:e,source:i,type:a,options:{raster:(0,r.pi)((0,r.pi)({},l),null==t?void 0:t.raster),vector:(0,r.pi)((0,r.pi)({},l),null==t?void 0:t.vector)}}}},6701:(e,t,n)=>{"use strict";n.d(t,{_:()=>r,M:()=>o});var r=function(e){var t;return null===(t=o[e.effectiveMode])||void 0===t?void 0:t.call(o,e)},o={raster:function(){return null},vector:function(){return null}}},4056:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var r=n(3080);function o(e){var t=e.getLayersEx(),n=t.topRasterLayers,o=t.mainLayers,i=new r.Set;n.forEach((function(e){return i.add(e.source)})),o.forEach((function(e){return i.add(e.source)}));var a=[];return i.forEach((function(e){return a.push(e)})),a.map((function(t){return e.getDataSource(t)})).map((function(e){var t;return"tile"===(null==e?void 0:e.type)&&(null===(t=null==e?void 0:e.copyrights)||void 0===t?void 0:t.join(" "))})).filter(Boolean).join(" ")}},3080:(e,t,n)=>{"use strict";n.r(t),n.d(t,{mathSign:()=>i,mathLog2:()=>a,mathLog10:()=>s,arrayFindIndex:()=>f,arrayFind:()=>v,arrayFrom:()=>h,arraySome:()=>_,Symbol:()=>l,Map:()=>d,Set:()=>m,WeakMap:()=>p,MAX_SAFE_INTEGER:()=>c});var r=n(6794),o={},i=Math.sign?Math.sign.bind(Math):function(e){return e<0?-1:0===e?0:1},a=Math.log2?Math.log2.bind(Math):function(e){return Math.log(e)*Math.LOG2E},s=Math.log10?Math.log10.bind(Math):function(e){return Math.log(e)/Math.LN10},c=Number.MAX_SAFE_INTEGER||9007199254740991,l="undefined"==typeof Symbol?function(e){return"__Symbol_".concat(e,"_").concat(Date.now(),"_").concat(Math.random())}:Symbol,u=function(e){return new e([[o,1]]).has(o)?function(t){return new e(t)}:function(t){var n=new e;if(void 0!==t)for(var r=0,o=t;r<o.length;r++){var i=o[r],a=i[0],s=i[1];n.set(a,s)}return n}},d=u(Map),p=u(WeakMap),m=new Set([o]).has(o)?function(e){return new Set(e)}:function(e){var t=new Set;if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var o=r[n];t.add(o)}return t};d.prototype=Map.prototype,p.prototype=WeakMap.prototype,m.prototype=Set.prototype;var f=Boolean(Array.prototype.findIndex)?function(e,t,n){return e.findIndex(t,n)}:function(e,t,n){for(var r=0;r<e.length;r++)if(t.call(n,e[r],r,e))return r;return-1},v=Boolean(Array.prototype.find)?function(e,t,n){return e.find(t,n)}:function(e,t,n){var r=f(e,t,n);return-1===r?void 0:e[r]},h=Array.from?Array.from:function(e){var t=Object(e);null==e&&(0,r._y)(new TypeError("Array.from requires an array-like object - not null or undefined"));var n=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;void 0===n||y(n)||(0,r._y)(new TypeError("Array.from: when provided, the second argument must be a function"));for(var i=function(e){var t=Number(e);if(isNaN(t)||t<=0)return 0;return Math.min(t,c)}(t.length),a=y(this)?Object(new this(i)):new Array(i),s=0;s<i;){var l=t[s];a[s]=n?void 0===o?n(l,s):n.call(o,l,s):l,s+=1}return a.length=i,a},g=Object.prototype.toString;function y(e){return"function"==typeof e||"[object Function]"===g.call(e)}var _=function(e,t,n){return-1!==f(e,t,n)}},6585:(e,t,n)=>{"use strict";n.d(t,{x:()=>a});var r=n(1372),o=n(3537),i=n(6441),a=function(e){function t(){var t=e.call(this)||this;return t.state=i.A,t}return(0,r.ZT)(t,e),t.prototype.setOptions=function(){},t.prototype.findObjectInPosition=function(){return null},t.prototype.findFeatureByElement=function(){return null},t.prototype._requestRender=function(){this._emit("requestRender")},t.prototype.render=function(){},t}((0,o.GA)().with())},6441:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var r={tilesLoaded:0,tilesReady:0,tilesTotal:0,borderLoaded:0,borderReady:0,borderTotal:0,graphicsReady:0,graphicsTotal:0}},8848:(e,t,n)=>{"use strict";n.d(t,{V:()=>c});var r=n(5930),o=n(5900),i=n(283),a=n(7048);var s=n(7806);function c(e,t,n){e=n?[[Math.min(e[0][0],e[1][0])-n,Math.min(e[0][1],e[1][1])-n],[Math.max(e[0][0],e[1][0])+n,Math.max(e[0][1],e[1][1])+n]]:e;var c=(0,r.Z)(s.m6),l=(0,o.f)(t,s.m6);return(0,i.C)((0,a.n)(e,s.m6),c).some((function(e){return function(e,t){return t[0]>=e[0][0]&&t[0]<=e[1][0]&&t[1]>=e[0][1]&&t[1]<=e[1][1]}(e,l)}))}},1421:(e,t,n)=>{"use strict";n.d(t,{b:()=>a});var r=n(8447),o=n(8860);function i(e,t,n,r,a){void 0===r&&(r=e(t)),void 0===a&&(a=e(n));var s,c,l,u=Math.PI/60,d=Math.PI/4,p=[],m=Math.abs((0,o.d)(Math.atan2(r.direction[0],r.direction[1])-Math.atan2(a.direction[0],a.direction[1]),-Math.PI,Math.PI)),f=0;if(Math.abs(m-Math.PI)<1e-10){var v=[r.point[0],90*r.direction[1]],h=[a.point[0],90*r.direction[1]];p.push(v,h,a.point)}else if(m>u)if((c=Math.ceil(m/u))<d/u||n-t==0){s=(n-t)/c;for(var g=1;g<=c;g++)p.push(e(t+s*g).point)}else l=e(f=t+(s=(n-t)/2)),p=(p=p.concat(i(e,t,f,r,l))).concat(i(e,f,n,l,a));else p.push(a.point);return p}function a(e){return function(e){for(var t=[e[0]],n=1;n<e.length;n++){var r=t[n-1],o=e[n];r[0]>0&&o[0]<0&&r[0]>90&&o[0]<0?t.push([o[0]+360,o[1]]):r[0]<0&&o[0]>0&&r[0]<-90&&o[0]>0?t.push([o[0]-360,o[1]]):t.push(o)}return t}(function(e,t,n){for(var o=(0,r.t)(e,t,n),a=o.pathFunction,s=o.startPoint,c=o.startDirection,l=o.endPoint,u=o.endDirection,d=[s],p=0;p<3;p++)d=d.concat(i(a,p/3,(p+1)/3,0===p?{point:s,direction:c}:void 0,2===p?{point:l,direction:u}:void 0));return d}(e[0],e[1]))}},283:(e,t,n)=>{"use strict";function r(e,t,n){for(var r=Math.floor(e/n),o=Math.floor(t/n),i=[],a=r;a<=o;a++)i.push([a===r?e-r*n:0,a===o?t-o*n:n]);return i}function o(e,t){var n=r(e[0][0],e[1][0],t),o=r(e[0][1],e[1][1],t),i=[];return n.forEach((function(e){o.forEach((function(t){i.push([[e[0],t[0]],[e[1],t[1]]])}))})),i}n.d(t,{C:()=>o})},1886:(e,t,n)=>{"use strict";n.d(t,{o:()=>c});var r=n(8860);var o=n(5900),i=n(5930),a=n(309),s=n(7806);function c(e){var t=[[0,0],[0,0]];e.length&&(t=function(e,t,n){var o=[[1/0,1/0],[-1/0,-1/0]],i=e.length;return[0,1].forEach((function(a){if(n[a]){e.sort((function(e,t){return e[a]-t[a]}));var s=0;e.forEach((function(n,c){var l=c+1,u=l===i?e[0]:e[l],d=(0,r.d)(u[a]-n[a],0,t);d>=s&&(s=d,o[0][a]=u[a],o[1][a]=n[a])})),o[0][a]>o[1][a]&&(o[1][a]+=t)}else e.forEach((function(e){o[0][a]=Math.min(o[0][a],e[a]),o[1][a]=Math.max(o[1][a],e[a])}))})),o}(e.map((function(e){return(0,o.f)(e,s.m6)})),(0,i.Z)(s.m6),s.dg).map((function(e){return(0,a.W)(e,s.m6)})));return t}},2690:(e,t,n)=>{"use strict";function r(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}n.d(t,{g:()=>r})},7689:(e,t,n)=>{"use strict";function r(e){return[Math.abs(e[1][0]-e[0][0]),Math.abs(e[1][1]-e[0][1])]}n.d(t,{j:()=>r})},6504:(e,t)=>{"use strict";function n(e){try{return decodeURIComponent(e)}catch(t){return""}}},1372:(e,t,n)=>{"use strict";n.d(t,{ZT:()=>o,pi:()=>i,ev:()=>a});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}},2448:e=>{"use strict";e.exports="/worker/content_provider.worker.js"},1367:e=>{"use strict";e.exports="/worker/gltf_decoder.worker.js"},3144:(e,t,n)=>{"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,{Z:()=>o})},4193:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(e){return function(t){return null==t?void 0:t[e]}}},7855:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}},1976:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var r=n(7685);const o=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o};var i=n(7771),a=n(2714),s=r.Z?r.Z.prototype:void 0,c=s?s.toString:void 0;const l=function e(t){if("string"==typeof t)return t;if((0,i.Z)(t))return o(t,e)+"";if((0,a.Z)(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n}},5042:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(7855);const o=function(e,t,n){var o=e.length;return n=void 0===n?o:n,!t&&n>=o?e:(0,r.Z)(e,t,n)}},9047:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");const o=function(e){return r.test(e)}},5876:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});const r=function(e){return e.split("")};var o=n(9047),i="\\ud800-\\udfff",a="["+i+"]",s="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",c="\\ud83c[\\udffb-\\udfff]",l="[^"+i+"]",u="(?:\\ud83c[\\udde6-\\uddff]){2}",d="[\\ud800-\\udbff][\\udc00-\\udfff]",p="(?:"+s+"|"+c+")"+"?",m="[\\ufe0e\\ufe0f]?",f=m+p+("(?:\\u200d(?:"+[l,u,d].join("|")+")"+m+p+")*"),v="(?:"+[l+s+"?",s,u,d,a].join("|")+")",h=RegExp(c+"(?="+c+")|"+v+f,"g");const g=function(e){return e.match(h)||[]};const y=function(e){return(0,o.Z)(e)?g(e):r(e)}},2967:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(7338),o=n(5042),i=n(9047),a=n(5876);const s=function(e){return function(t){t=(0,r.Z)(t);var n=(0,i.Z)(t)?(0,a.Z)(t):void 0,s=n?n[0]:t.charAt(0),c=n?(0,o.Z)(n,1).join(""):t.slice(1);return s[e]()+c}}("toUpperCase");const c=function(e){return s((0,r.Z)(e).toLowerCase())}},7619:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(8694),o=n(7685),i=n(4732),a=n(7771),s=o.Z?o.Z.isConcatSpreadable:void 0;const c=function(e){return(0,a.Z)(e)||(0,i.Z)(e)||!!(s&&e&&e[s])};const l=function e(t,n,o,i,a){var s=-1,l=t.length;for(o||(o=c),a||(a=[]);++s<l;){var u=t[s];n>0&&o(u)?n>1?e(u,n-1,o,i,a):(0,r.Z)(a,u):i||(a[a.length]=u)}return a};const u=function(e){return(null==e?0:e.length)?l(e,1):[]}},111:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(9111),o=n(7226);const i=function(e,t,n){var i=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,o.Z)(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),(0,r.Z)(e,t,{leading:i,maxWait:t,trailing:a})}},7338:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(1976);const o=function(e){return null==e?"":(0,r.Z)(e)}},9410:(e,t,n)=>{"use strict";n.d(t,{Z:()=>L});var r=n(1976),o=n(5042),i=n(9047),a=n(7226),s=n(3243),c=n(8533);const l=function(e){return(0,c.Z)(e)&&"[object RegExp]"==(0,s.Z)(e)};var u=n(1162),d=n(8351),p=d.Z&&d.Z.isRegExp;const m=p?(0,u.Z)(p):l;const f=(0,n(4193).Z)("length");var v="\\ud800-\\udfff",h="["+v+"]",g="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",y="\\ud83c[\\udffb-\\udfff]",_="[^"+v+"]",b="(?:\\ud83c[\\udde6-\\uddff]){2}",E="[\\ud800-\\udbff][\\udc00-\\udfff]",w="(?:"+g+"|"+y+")"+"?",S="[\\ufe0e\\ufe0f]?",C=S+w+("(?:\\u200d(?:"+[_,b,E].join("|")+")"+S+w+")*"),Z="(?:"+[_+g+"?",g,b,E,h].join("|")+")",R=RegExp(y+"(?="+y+")|"+Z+C,"g");const P=function(e){for(var t=R.lastIndex=0;R.test(e);)++t;return t};const k=function(e){return(0,i.Z)(e)?P(e):f(e)};var I=n(5876),M=n(9651),T=n(7338),x=/\w*$/;const L=function(e,t){var n=30,s="...";if((0,a.Z)(t)){var c="separator"in t?t.separator:c;n="length"in t?(0,M.Z)(t.length):n,s="omission"in t?(0,r.Z)(t.omission):s}var l=(e=(0,T.Z)(e)).length;if((0,i.Z)(e)){var u=(0,I.Z)(e);l=u.length}if(n>=l)return e;var d=n-k(s);if(d<1)return s;var p=u?(0,o.Z)(u,0,d).join(""):e.slice(0,d);if(void 0===c)return p+s;if(u&&(d+=p.length-d),m(c)){if(e.slice(d).search(c)){var f,v=p;for(c.global||(c=RegExp(c.source,(0,T.Z)(x.exec(c))+"g")),c.lastIndex=0;f=c.exec(v);)var h=f.index;p=p.slice(0,void 0===h?d:h)}}else if(e.indexOf((0,r.Z)(c),d)!=d){var g=p.lastIndexOf(c);g>-1&&(p=p.slice(0,g))}return p+s}}}]);